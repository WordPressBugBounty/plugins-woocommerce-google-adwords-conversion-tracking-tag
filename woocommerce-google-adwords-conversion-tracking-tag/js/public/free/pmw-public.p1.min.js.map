{"version":3,"file":"pmw-public.p1.min.js","mappings":"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","sources":["webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/create fake namespace object","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/load script","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/event_listeners.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/functions_loader.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/console.mjs","webpack://Pixel-Manager-for-WooCommerce/../../src/ipv6.ts","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/functions_main.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/hooks.js","webpack://Pixel-Manager-for-WooCommerce/../../src/index.ts","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/event-processor.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/ip_services.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/geo/geo.mjs","webpack://Pixel-Manager-for-WooCommerce/../../src/ipRange.ts","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/event_listeners_on_ready.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/version.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/pixel-registry.js","webpack://Pixel-Manager-for-WooCommerce/../../src/util.ts","webpack://Pixel-Manager-for-WooCommerce/../../src/ipv4.ts","webpack://Pixel-Manager-for-WooCommerce/../node_modules/ipaddr.js/lib/ipaddr.js","webpack://Pixel-Manager-for-WooCommerce/../node_modules/ip6/ip6.js","webpack://Pixel-Manager-for-WooCommerce/../src/range-check.ts","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/functions.js","webpack://Pixel-Manager-for-WooCommerce/webpack/bootstrap","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/define property getters","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/ensure chunk","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/get javascript chunk filename","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/global","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/hasOwnProperty shorthand","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/make namespace object","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/publicPath","webpack://Pixel-Manager-for-WooCommerce/webpack/runtime/jsonp chunk loading","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/main.js"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; (typeof current == 'object' || typeof current == 'function') && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"Pixel Manager for WooCommerce:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// a function that removes all \\n and \\t and html tags from a string\nconst removeHtmlTagsAndWhitespace = string => {\n\n\tstring = string.replace(/<[^>]*>?/gm, \"\").replace(/\\n/gm, \"\").replace(/\\t/gm, \"\");\n\tstring = string.trim();\n\n\treturn string;\n};\n\n/**\n * add_shipping_info event\n */\n\n// trigger when #shipping_method is changed\njQuery(\"form.woocommerce-checkout\").on(\"change\", \"#shipping_method\", (event) => {\n\n\tif (!event.target?.value) return;\n\tif (!event.target?.id) return;\n\n\ttriggerAddShippingInfoEvent({\n\t\tslug: event.target.value,\n\t\ttext: removeHtmlTagsAndWhitespace(jQuery(\"label[for='\" + event.target.id + \"']\").text()),\n\t});\n});\n\n// trigger when a shipping method is already selected on page load\njQuery(() => {\n\tif (jQuery(\"#shipping_method\").length) {\n\n\t\t// get the checked shipping method from #shipping_method\n\t\tlet checkedShippingMethod = jQuery(\"#shipping_method\").find(\":checked\");\n\n\t\t// if there is a checked shipping method\n\t\tif (checkedShippingMethod.length) {\n\n\t\t\tif (!checkedShippingMethod.val()) return;\n\t\t\tif (!checkedShippingMethod.attr(\"id\")) return;\n\n\t\t\ttriggerAddShippingInfoEvent({\n\t\t\t\tslug: checkedShippingMethod.val(),\n\t\t\t\ttext: removeHtmlTagsAndWhitespace(jQuery(\"label[for='\" + checkedShippingMethod.attr(\"id\") + \"']\").text()),\n\t\t\t});\n\t\t}\n\t}\n});\n\n// trigger when a shipping method is selected on page load\nconst triggerAddShippingInfoEvent = shippingTier => {\n\tjQuery(document).trigger(\"pmw:add-shipping-info\", {shippingTier});\n};\n\n/**\n * add_payment_info event\n */\n\n\t  // flag to prevent double logging of payment method change on pageload\nlet paymentMethodChangeLogged = false;\n\n// trigger when a payment method is selected\njQuery(\"form.woocommerce-checkout\").on(\"change\", \"input[name=\\\"payment_method\\\"]\", event => {\n\n\tif (!event.target.value) return;\n\tif (!event.target.id) return;\n\n\ttriggerAddPaymentInfoEvent({\n\t\tslug: event.target.value,\n\t\ttext: removeHtmlTagsAndWhitespace(jQuery(\"label[for='\" + event.target.id + \"']\").text()),\n\t});\n\n\tpaymentMethodChangeLogged = true;\n});\n\n// trigger when a payment method is already selected on page load\njQuery(() => {\n\n\t// prevent double logging of payment method change on pageload\n\tif (paymentMethodChangeLogged) return;\n\n\tlet checkedPaymentMethod = jQuery(\"input[name=\\\"payment_method\\\"]:checked\");\n\n\tif (checkedPaymentMethod.length) {\n\n\t\tif (!checkedPaymentMethod.val()) return;\n\t\tif (!checkedPaymentMethod.attr(\"id\")) return;\n\n\t\ttriggerAddPaymentInfoEvent({\n\t\t\tslug: checkedPaymentMethod.val(),\n\t\t\ttext: removeHtmlTagsAndWhitespace(jQuery(\"label[for='\" + checkedPaymentMethod.attr(\"id\") + \"']\").text()),\n\t\t});\n\t}\n});\n\n// trigger when a payment method is selected on page load\nconst triggerAddPaymentInfoEvent = paymentType => {\n\tjQuery(document).trigger(\"pmw:add-payment-info\", {paymentType});\n};\n\n/**\n * remove_from_cart event\n *\n * Cannot be attached directly because the mini cart doesn't necessarily contain the remove button on page load.\n */\njQuery(document).on(\"click\", \".remove_from_cart_button, .remove\", (event) => {\n\n\t// console.log(\"remove_from_cart event\" + new Date().getTime())\n\n\ttry {\n\n\t\tlet url       = new URL(jQuery(event.currentTarget).attr(\"href\"));\n\t\tlet productId = pmw.getProductIdByCartItemKeyUrl(url);\n\n\t\tpmw.removeProductFromCart(productId);\n\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n\n/**\n * begin_checkout event\n *\n * Cannot be attached directly because the mini cart doesn't necessarily contain the remove button on page load.\n */\nlet checkoutButtonClasses = [\n\t// \".checkout\", // this is too generic. It triggers on the checkout page on some themes fore each interaction with the checkout form.\n\t\".checkout-button\",\n\t\".cart-checkout-button\",\n\t\".button.checkout\",\n\t\".xoo-wsc-ft-btn-checkout\", // https://xootix.com/side-cart-for-woocommerce/\n\t\".elementor-button--checkout\",\n\t\".xt_woofc-checkout\", // https://wordpress.org/plugins/woo-floating-cart-lite/\n\t\".fkcart-checkout--text\", // https://funnelkit.com/\n];\n\nconst checkoutButtonSelectors = pmw.prepareSelectors(checkoutButtonClasses, \"beginCheckout\");\n\n// https://wordpress.stackexchange.com/a/352171/68337\njQuery(document).on(\"click init_checkout\", checkoutButtonSelectors, () => {\n\tjQuery(document).trigger(\"pmw:begin-checkout\");\n});\n\njQuery(document).on(\"updated_cart_totals\", () => {\n\tjQuery(document).trigger(\"pmw:view-cart\");\n});\n\n/**\n * Set up PWM events\n */\n\n// track checkout option event: purchase click\n// https://wordpress.stackexchange.com/a/352171/68337\njQuery(document).on(\"pmwLoad\", (event) => {\n\tjQuery(document).on(\"payment_method_selected\", () => {\n\n\t\tif (false === pmw.paymentMethodSelected) {\n\t\t\tpmw.fireCheckoutProgress(3);\n\t\t}\n\n\t\tpmw.fireCheckoutOption(3, jQuery(\"input[name='payment_method']:checked\").val());\n\t\tpmw.paymentMethodSelected = true;\n\t});\n});\n\n// populate the pmwDataLayer with the cart items\njQuery(document).on(\"pmwLoad\", () => {\n\n\ttry {\n\t\tpmw.initCart();\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n// get all add-to-cart= products from backend\njQuery(document).on(\"pmwLoad\", () => {\n\n\tpmwDataLayer.products = pmwDataLayer.products || {};\n\n\t// scan page for add-to-cart= links\n\tlet productIds = pmw.getAddToCartLinkProductIds();\n\n\tpmw.getProductsFromBackend(productIds);\n});\n\n/**\n * Save the referrer into a cookie\n *\n * @returns {void}\n */\njQuery(document).on(\"pmwLoad\", () => {\n\n\t// If there is no referrer, then return\n\tif (!document.referrer) {\n\t\treturn;\n\t}\n\n\t// If the referrer is already stored, then return\n\tif (pmw.retrieveData(\"referrer\")) {\n\t\treturn;\n\t}\n\n\tlet referrerUrl      = new URL(document.referrer);\n\tlet referrerHostname = referrerUrl.hostname;\n\n\tif (referrerHostname !== window.location.host) {\n\t\tpmw.storeData(\"referrer\", referrerHostname);\n\t}\n});\n\n/**\n * Collect parameters from the URL\n * and save them to the PMW session storage.\n * Parameters:\n * - gclid\n * - wbraid\n * - gbraid\n * - fbclid\n * - ttclid\n * - ScCid\n * - epik\n *\n * @returns {void}\n * */\njQuery(document).on(\"pmwLoad\", () => {\n\n\tlet gclid = pmw.getUrlParameter(\"gclid\");\n\tif (gclid) pmw.storeData(\"gclid\", gclid);\n\n\tlet wbraid = pmw.getUrlParameter(\"wbraid\");\n\tif (wbraid) pmw.storeData(\"wbraid\", wbraid);\n\n\tlet gbraid = pmw.getUrlParameter(\"gbraid\");\n\tif (gbraid) pmw.storeData(\"gbraid\", gbraid);\n\n\t// https://developers.facebook.com/docs/marketing-api/conversions-api/parameters/fbp-and-fbc\n\tlet fbclid = pmw.getUrlParameter(\"fbclid\");\n\tif (fbclid) {\n\t\tfbclid = \"fb.1.\" + Math.floor(Date.now() / 1000) + \".\" + fbclid;\n\t\tpmw.storeData(\"fbclid\", fbclid);\n\t}\n\n\tlet ttclid = pmw.getUrlParameter(\"ttclid\");\n\tif (ttclid) pmw.storeData(\"ttclid\", ttclid);\n\n\tlet scid = pmw.getUrlParameter(\"ScCid\");\n\tif (scid) pmw.storeData(\"scid\", scid);\n\n\tlet epik = pmw.getUrlParameter(\"epik\");\n\tif (epik) pmw.storeData(\"epik\", epik);\n});\n\n/**\n * Create our own load event in order to better handle script flow execution when JS \"optimizers\" shuffle the code.\n */\njQuery(document).on(\"pmwLoad\", () => {\n\t// document.addEventListener(\"pmwLoad\", function () {\n\ttry {\n\t\tif (typeof pmwDataLayer != \"undefined\" && !pmwDataLayer?.pmw_loaded) {\n\n\t\t\tjQuery(document).trigger(\"pmw:load-always\");\n\n\t\t\tif (pmwDataLayer?.shop) {\n\t\t\t\tif (\n\t\t\t\t\t\"product\" === pmwDataLayer.shop.page_type &&\n\t\t\t\t\t\"variable\" !== pmwDataLayer.shop.product_type &&\n\t\t\t\t\tpmw.getMainProductIdFromProductPage()\n\t\t\t\t) {\n\t\t\t\t\tlet product = pmw.getProductDataForViewItemEvent(pmw.getMainProductIdFromProductPage());\n\t\t\t\t\tjQuery(document).trigger(\"pmw:view-item\", product);\n\t\t\t\t} else if (\n\t\t\t\t\t\"product\" === pmwDataLayer.shop.page_type &&\n\t\t\t\t\t\"variable\" === pmwDataLayer.shop.product_type &&\n\t\t\t\t\t!pmwDataLayer?.shop?.variations_output &&\n\t\t\t\t\tpmw.getMainProductIdFromProductPage()\n\t\t\t\t) {\n\t\t\t\t\t// For variable products with variations_output disabled, fire view_item with parent product data\n\t\t\t\t\tlet product = pmw.getProductDataForViewItemEvent(pmw.getMainProductIdFromProductPage());\n\t\t\t\t\tjQuery(document).trigger(\"pmw:view-item\", product);\n\t\t\t\t} else if (\"product_category\" === pmwDataLayer.shop.page_type) {\n\t\t\t\t\tjQuery(document).trigger(\"pmw:view-category\");\n\t\t\t\t} else if (\"search\" === pmwDataLayer.shop.page_type) {\n\t\t\t\t\tjQuery(document).trigger(\"pmw:search\");\n\t\t\t\t} else if (\"cart\" === pmwDataLayer.shop.page_type) {\n\t\t\t\t\tjQuery(document).trigger(\"pmw:view-cart\");\n\t\t\t\t} else if (\"order_received_page\" === pmwDataLayer.shop.page_type) {\n\t\t\t\t\tif (pmwDataLayer?.order && !pmw.isOrderIdStored(pmwDataLayer.order.id)) {\n\t\t\t\t\t\tjQuery(document).trigger(\"pmw:purchase\");\n\t\t\t\t\t\tpmw.writeOrderIdToStorage(pmwDataLayer.order.id, pmwDataLayer.order.key);\n\t\t\t\t\t\tif (typeof pmw.acrRemoveCookie === \"function\") pmw.acrRemoveCookie();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tjQuery(document).trigger(\"pmw:everywhere-else\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjQuery(document).trigger(\"pmw:everywhere-else\");\n\t\t\t}\n\n\t\t\tif (pmwDataLayer?.user?.id && !pmw.hasLoginEventFired()) {\n\t\t\t\tjQuery(document).trigger(\"pmw:login\");\n\t\t\t\tpmw.setLoginEventFired();\n\t\t\t}\n\n\t\t\tpmwDataLayer.pmw_loaded = true;\n\t\t}\n\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n/**\n * Register the show_variation event listener\n * in case lazy loading is enabled\n * because we have to register it immediately\n * and not after the onready event.\n */\nif (pmwDataLayer?.general?.lazy_load_pmw) {\n\tpmw.registerShowVariationEventListener();\n}\n\n/**\n * In case lazy loading is enabled\n * we need to trigger the view-item event on\n * preselected variations.\n *\n * Check if a variation is selected on a variable product page\n * and trigger the view-item event if a variation is selected\n *\n * Fallback for the jQuery(\".single_variation_wrap\").on(\"show_variation\", (event, variation) => {}) event listener\n * in case lazy loading is enabled and the event listener is not triggered.\n *\n * Only fires if variations_output is enabled, as the parent product view_item\n * is already triggered on page load when variations_output is disabled.\n */\njQuery(document).on(\"pmwLoad\", () => {\n\tif (!pmwDataLayer?.general?.lazy_load_pmw) return;\n\tif (!pmwDataLayer?.shop?.variations_output) return;\n\n\ttry {\n\t\tconst $variationForm = jQuery(\".variations_form\");\n\t\tif (!$variationForm.length) return;\n\n\t\tconst selectedValues = {};\n\t\tconst allSelected    = $variationForm.find(\"select\").toArray().every(select => {\n\t\t\tconst value = jQuery(select).val();\n\t\t\tif (value) {\n\t\t\t\tselectedValues[jQuery(select).attr(\"name\")] = value;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tif (!allSelected) return;\n\n\t\tconst productVariations = $variationForm.data(\"product_variations\");\n\t\tif (!productVariations) return;\n\n\t\tconst matchingVariation = productVariations.find(variation =>\n\t\t\tObject.entries(selectedValues).every(([key, value]) =>\n\t\t\t\tvariation.attributes[key] === value,\n\t\t\t),\n\t\t);\n\n\t\tif (matchingVariation) {\n\t\t\tpmw.triggerViewItemEventPrep(matchingVariation.variation_id);\n\t\t}\n\t} catch (e) {\n\t\tpmw.console.error(e);\n\t}\n});\n\n// Check if the REST endpoint is available and log an error if it is not\njQuery(document).on(\"pmwLoad\", async () => {\n\tif (pmw.retrieveData(\"restEndpointAvailable\") === false) pmw.console.error(\"REST endpoint is not available. Using admin-ajax.php instead.\");\n});\n\n/**\n * All s2s events\n */\n\n/**\n * PageView event\n *\n * Uses the unified event processing system with filters.\n * Each pixel's adapter handles the data transformation.\n * S2S transmission is controlled by the supportsPageViewS2S capability.\n */\njQuery(document).on(\"pmw:page-view\", async (event) => {\n\n\tpmw.console.log(\"pmw:page-view event fired\", {event});\n\n\t// Use the unified event processor\n\tconst payload = await pmw.processEvent(\"page_view\", {});\n\n\t// Only send to server if pageview S2S is enabled AND there are pixels with this capability\n\tif (pmwDataLayer?.general?.server_2_server?.pageview_event_s2s?.is_active) {\n\t\tconst pageViewS2SPixels = pmw.pixelRegistry.getPixelsWithCapability(\"supportsPageViewS2S\");\n\n\t\tif (pageViewS2SPixels.length > 0) {\n\t\t\t// Extract S2S data only for pixels that support pageview S2S\n\t\t\tconst s2sData = {event: \"page_view\"};\n\n\t\t\tfor (const pixelName of pageViewS2SPixels) {\n\t\t\t\tif (payload.pixels[pixelName]) {\n\t\t\t\t\ts2sData[pixelName] = payload.pixels[pixelName];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Object.keys(s2sData).length > 1) { // More than just 'event' key\n\t\t\t\tpmw.sendEventPayloadToServer(s2sData);\n\t\t\t}\n\t\t}\n\t}\n});\n\n/**\n * Add to cart event\n *\n * Uses the new unified event processing system with filters\n */\njQuery(document).on(\"pmw:add-to-cart\", async (event, product) => {\n\n\tpmw.console.log(\"pmw:add-to-cart event fired\", {event, product});\n\n\t// Use the new unified event processor\n\tawait pmw.processEvent(\"add_to_cart\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * Remove from cart event\n * Uses the new unified event processing system with filters\n */\njQuery(document).on(\"pmw:remove-from-cart\", async (event, product) => {\n\n\tpmw.console.log(\"pmw:remove-from-cart event fired\", {event, product});\n\n\t// Use the new unified event processor\n\tawait pmw.processEvent(\"remove_from_cart\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * Select item event\n * Uses the new unified event processing system with filters\n */\njQuery(document).on(\"pmw:select-item\", async (event, product) => {\n\n\tpmw.console.log(\"pmw:select-item event fired\", {event, product});\n\n\t// Use the new unified event processor\n\tawait pmw.processEvent(\"select_item\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * View cart event\n */\njQuery(document).on(\"pmw:view-cart\", (event) => {\n\n\tpmw.console.log(\"pmw:view-cart event fired\", {event});\n\n\t/**\n\t * Process the event through the unified event processor\n\t */\n\tpmw.processEvent(\"view_cart\", {});\n});\n\n/**\n * Begin checkout event\n */\njQuery(document).on(\"pmw:begin-checkout\", (event) => {\n\n\tpmw.console.log(\"pmw:begin-checkout event fired\", {event});\n\n\t/**\n\t * Process the event through the unified event processor\n\t */\n\tpmw.processEvent(\"begin_checkout\", {});\n});\n\n/**\n * Add Payment Info\n */\njQuery(document).on(\"pmw:add-payment-info\", (event) => {\n\n\tpmw.console.log(\"pmw:add-payment-info event fired\", {event});\n\n\t/**\n\t * Process the event through the unified event processor\n\t */\n\tpmw.processEvent(\"add_payment_info\", {});\n});\n\n/**\n * Add to wishlist event\n *\n * Uses the unified event processing system with filters.\n * Each pixel's adapter handles the data transformation.\n */\njQuery(document).on(\"pmw:add-to-wishlist\", async (event, product) => {\n\n\tpmw.console.log(\"pmw:add-to-wishlist event fired\", {event, product});\n\n\t// Use the unified event processor\n\tawait pmw.processEvent(\"add_to_wishlist\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * View Item event\n */\njQuery(document).on(\"pmw:view-item\", (event, product = null) => {\n\n\tpmw.console.log(\"pmw:view-item event fired\", {event, product});\n\n\t/**\n\t * Process the event through the unified event processor\n\t */\n\tpmw.processEvent(\"view_item\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * View category event\n *\n * Uses the unified event processing system with filters.\n * Each pixel's adapter handles the data transformation.\n */\njQuery(document).on(\"pmw:view-category\", async (event, product = null) => {\n\n\tpmw.console.log(\"pmw:view-category event fired\", {event, product});\n\n\t// Use the unified event processor\n\tawait pmw.processEvent(\"view_category\", {\n\t\tproduct: product,\n\t});\n});\n\n/**\n * Search event\n */\njQuery(document).on(\"pmw:search\", (event) => {\n\n\tpmw.console.log(\"pmw:search event fired\", {event});\n\n\t/**\n\t * Process the event through the unified event processor\n\t */\n\tpmw.processEvent(\"search\", {});\n});\n\n/**\n * Place order event\n *\n * Uses the unified event processing system with filters.\n * Each pixel's adapter handles the data transformation.\n */\njQuery(document).on(\"pmw:place-order\", async (event) => {\n\n\tpmw.console.log(\"pmw:place-order event fired\", {event});\n\n\t// Use the unified event processor\n\tawait pmw.processEvent(\"place_order\", {});\n});\n\n/**\n * Purchase event\n */\njQuery(document).on(\"pmw:purchase\", async (event) => {\n\n\tpmw.console.log(\"pmw:purchase event fired\", {event});\n\n\t// Use the unified event processor\n\tawait pmw.processEvent(\"purchase\", {\n\t\torder: pmwDataLayer.order,\n\t});\n});\n\n/**\n * Login event\n *\n * Uses the unified event processing system with filters.\n * Each pixel's adapter handles the data transformation.\n */\njQuery(document).on(\"pmw:login\", async () => {\n\n\tpmw.console.log(\"pmw:login event fired\");\n\n\t// Use the unified event processor\n\tawait pmw.processEvent(\"login\", {});\n});\n\n/**\n * Run WooCommerce specific functions\n */\njQuery(document).on(\"pmw:ready\", async () => {\n\n\t// Only run if WooCommerce is active\n\tif (!pmw.isWooCommerceActive()) {\n\t\treturn;\n\t}\n\n\t/**\n\t * Run as soon as wpm namespace is loaded\n\t */\n\n\t// Watch for products visible in viewport\n\tpmw.startIntersectionObserverToWatch();\n\n\t// Watch for lazy loaded products\n\tpmw.startProductsMutationObserverToWatch();\n});\n\njQuery(document).on(\"pmw:load-pixels\", () => {\n\tpmw.waitForPixelsAndTriggerPageView();\n});\n","/**\n * Load all PMW functions\n *\n * Ignore event listeners. They need to be loaded after\n * we made sure that jQuery has been loaded.\n */\n\nrequire(\"./functions\")\n\n/**\n * Load consent management module as a chunk\n * @returns {Promise<void>}\n */\nwindow.pmw.loadConsentModule = async () => {\n\tconst consentModule = await import(/* webpackChunkName: \"consent-management\" */ \"./consent/consent.mjs\")\n\twindow.pmw.consent = consentModule\n\t\n\tconst apiModule = await import(/* webpackChunkName: \"consent-api\" */ \"./consent/api.mjs\")\n\twindow.pmw = window.pmw || {}\n\twindow.pmw.consent = window.pmw.consent || {}\n\twindow.pmw.consent.api = apiModule\n\t\n\treturn consentModule\n}\n\nwindow.pmw = window.pmw || {}\nwindow.pmw.console = require(\"./console.mjs\")\n\nrequire(\"./ip_services\")\n\n// #if process.env.TIER === 'premium'\n// if (pmw.canLoadPremiumFeatures()) {\n// \trequire(\"./functions_premium\")\n// }\n// #endif\n","/**\n * Logs a message to the console if the logger is enabled.\n *\n * @module console\n * @param message\n * @param objects\n * @public\n * @returns {void}\n */\nexport const log = (message, ...objects) => {\n\n\tif (!isLoggerEnabled()) return\n\n\tif (typeof message === \"object\") {\n\t\tconsole.log(\"Pixel Manager: \", message, ...objects)\n\t} else if (objects.length) {\n\t\tconsole.log(\"Pixel Manager: \" + message, ...objects)\n\t} else {\n\t\tconsole.log(\"Pixel Manager: \" + message)\n\t}\n}\n\n/**\n * Logs an error message to the console.\n *\n * @module console\n * @param message\n * @param objects\n * @public\n * @returns {void}\n */\nexport const error = (message, ...objects) => {\n\n\t// if (!isLoggerEnabled()) return\n\n\t// if message is an object, log the keys\n\tif (typeof message === \"object\") {\n\t\tconsole.error(\"Pixel Manager: \", message, ...objects)\n\t} else if (objects.length) {\n\t\tconsole.error(\"Pixel Manager: \" + message, ...objects)\n\t} else {\n\t\tconsole.error(\"Pixel Manager: \" + message)\n\t}\n}\n\n/**\n * Checks if the logger is enabled.\n *\n * @return {boolean}\n */\nconst isLoggerEnabled = () => {\n\n\tif (urlLoggerOff()) return false\n\n\tif (sessionLoggerEnabled()) return true\n\n\tif (urlLoggerOn()) return true\n\n\treturn !!pmwDataLayer?.general?.logger?.is_active\n}\n\n/**\n * Turn off the logger if the URL parameter is set.\n *\n * @return {boolean}\n */\nconst urlLoggerOff = () => {\n\n\tif (pmw.urlHasParameter(\"pmwloggeroff\")) {\n\t\tpmw.storeData(\"loggerEnabled\", false)\n\t}\n\n\treturn pmw.urlHasParameter(\"pmwloggeroff\")\n}\n\n/**\n * Check if the logger is enabled for the session.\n *\n * @return {boolean}\n */\nconst sessionLoggerEnabled = () => {\n\treturn pmw.retrieveData(\"loggerEnabled\")\n}\n\n/**\n * Turn on the logger if the URL parameter is set.\n *\n * @return {boolean}\n */\nconst urlLoggerOn = () => {\n\n\tif (pmw.urlHasParameter(\"pmwloggeron\")) {\n\t\tpmw.storeData(\"loggerEnabled\", true)\n\t}\n\n\treturn pmw.urlHasParameter(\"pmwloggeron\")\n}\n",null,"(function (pmw, $, undefined) {\n\n\tpmw.jQueryExists = async () => new Promise(resolve => {\n\n\t\t(function waitForjQuery() {\n\t\t\tif (typeof jQuery !== \"undefined\") return resolve()\n\t\t\tsetTimeout(waitForjQuery, 100)\n\t\t})()\n\t})\n\n\tpmw.waitForLibrary = (library, timeout = 5000, interval = 100) => {\n\n\t\tconst startTime = Date.now()\n\t\twhile (typeof window[library] === \"undefined\") {\n\t\t\t// Check if timeout in milliseconds has passed\n\t\t\tif (Date.now() - startTime > timeout) {\n\t\t\t\tbreak // Maximum wait time reached, exit the loop\n\t\t\t}\n\t\t\t// Wait for the interval in milliseconds before checking again\n\t\t\tsetTimeout(() => {\n\t\t\t}, interval)\n\t\t}\n\t}\n\n\tpmw.dataLayerFullyLoaded = async () => {\n\n\t\t// Promise that checks if the nested object pmwDataLayer.version is defined.\n\t\t// If so, resolve.\n\t\t// We must check for the nested object pmwDataLayer.version,\n\t\t// because the pmwDataLayer object can be defined early by adding products to the data layer through\n\t\t// template inline scripts. So we need to wait until the pmwDataLayer configuration objects\n\t\t// are defined.\n\t\tlet checkVar = new Promise((resolve) => {\n\t\t\t(function waitForVar() {\n\t\t\t\tif (\n\t\t\t\t\ttypeof pmwDataLayer !== \"undefined\"\n\t\t\t\t\t&& typeof pmwDataLayer.version !== \"undefined\"\n\t\t\t\t) {\n\t\t\t\t\treturn resolve()\n\t\t\t\t}\n\t\t\t\tsetTimeout(waitForVar, 100)\n\t\t\t})()\n\t\t})\n\n\t\t// Set a timeout to log a message after 6 seconds\n\t\tlet logTimeoutId = setTimeout(() => {\n\t\t\tconsole.error(\"Pixel Manager error: The pmwDataLayer is not defined. Please make sure that the pmwDataLayer script snippet is inserted and not modified by any third-party plugin, such as a consent management platform or a JavaScript optimizer.\")\n\n\t\t}, 6000)\n\n\t\tcheckVar.then(() => {\n\t\t\tclearTimeout(logTimeoutId)\n\t\t})\n\n\t\treturn checkVar\n\t}\n\n\tpmw.wpHooksExists = async () => new Promise(resolve => {\n\t\t(function waitForVar() {\n\n\t\t\t// Resolve if wp.hooks is defined\n\t\t\tif (typeof wp !== \"undefined\" && typeof wp.hooks !== \"undefined\") return resolve()\n\t\t\tsetTimeout(waitForVar, 50)\n\t\t})()\n\t})\n\n\t/**\n\t * Load all WooCommerce hooks functions\n\t *\n\t * Includes safeguard in case the user changed the default load order for wp-hooks, or removed it completely.\n\t *\n\t * @returns {Promise<void>}\n\t */\n\tpmw.loadWcHooksFunctions = async () => {\n\t\t// Load all WooCommerce Blocks hooks\n\t\tawait pmw.wpHooksExists()\n\t\tawait import(/* webpackChunkName: \"wc-hooks\" */ \"./wc_hooks\")\n\t}\n\n}(window.pmw = window.pmw || {}, jQuery))\n","/**\n * WordPress-style hooks system for Pixel Manager\n *\n * Provides a filter API that allows developers to modify event data\n * at various points in the event processing pipeline.\n *\n * Available Filters:\n *\n * 1. pmw_event_payload_pre (payload, eventName)\n *    - Runs before pixel adaptation\n *    - Use case: Add global tracking params, modify core data\n *\n * 2. pmw_pixel_data_{pixelName} (pixelData, eventName, eventData, context)\n *    - Runs after each pixel's adapter\n *    - Use case: Modify pixel-specific data (e.g., pmw_pixel_data_facebook)\n *\n * 3. pmw_event_payload_{eventName} (payload, eventData)\n *    - Runs for specific event types\n *    - Use case: Modify all pixels for a specific event (e.g., pmw_event_payload_add_to_cart)\n *\n * 4. pmw_event_payload_post (payload, eventName)\n *    - Runs after all processing, before dispatch\n *    - Use case: Final validation, logging, debugging\n *\n * 5. pmw_pixel_firing_decision (decision, pixelName, eventName, mode)\n *    - Runs when determining whether to fire browser/server\n *    - decision: { fire_browser: boolean, fire_server: boolean }\n *    - Use case: Force server-only for specific pixels, disable certain pixels per-event\n *\n * @since 1.51.0\n */\n\n(function (pmw, $, undefined) {\n\n\t// Initialize pmw namespace if it doesn't exist\n\twindow.pmw = window.pmw || {};\n\n\t/**\n\t * Hook system for filtering event data\n\t */\n\tpmw.hooks = {\n\t\tfilters: {},\n\n\t\t/**\n\t\t * Add a filter callback\n\t\t *\n\t\t * @param {string} hookName - The filter hook name (e.g., 'pmw_event_payload')\n\t\t * @param {string} namespace - Unique identifier for your filter (e.g., 'my-plugin')\n\t\t * @param {function} callback - The filter function that modifies the value\n\t\t * @param {number} priority - Execution order, lower numbers run first (default: 10)\n\t\t *\n\t\t * @example\n\t\t * // Modify Facebook pixel data\n\t\t * pmw.hooks.addFilter('pmw_pixel_data_facebook', 'my-plugin', (data) => {\n\t\t *   data.custom_param = 'my_value';\n\t\t *   return data;\n\t\t * }, 10);\n\t\t *\n\t\t * @example\n\t\t * // Force server-only firing for Facebook\n\t\t * pmw.hooks.addFilter('pmw_pixel_firing_decision', 'my-plugin', (decision, pixelName) => {\n\t\t *   if (pixelName === 'facebook') {\n\t\t *     return { fire_browser: false, fire_server: true };\n\t\t *   }\n\t\t *   return decision;\n\t\t * });\n\t\t */\n\t\taddFilter: function (hookName, namespace, callback, priority = 10) {\n\t\t\tif (!hookName || typeof hookName !== \"string\") {\n\t\t\t\tpmw.console.error(\"Invalid hook name provided to addFilter\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!namespace || typeof namespace !== \"string\") {\n\t\t\t\tpmw.console.error(\"Invalid namespace provided to addFilter\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof callback !== \"function\") {\n\t\t\t\tpmw.console.error(\"Invalid callback provided to addFilter\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.filters[hookName]) {\n\t\t\t\tthis.filters[hookName] = [];\n\t\t\t}\n\n\t\t\tthis.filters[hookName].push({\n\t\t\t\tnamespace: namespace,\n\t\t\t\tcallback : callback,\n\t\t\t\tpriority : priority,\n\t\t\t});\n\n\t\t\t// Sort by priority (ascending order)\n\t\t\tthis.filters[hookName].sort((a, b) => a.priority - b.priority);\n\n\t\t\tpmw.console.log(`Filter added: ${hookName} (${namespace}) with priority ${priority}`);\n\t\t},\n\n\t\t/**\n\t\t * Apply all registered filters to a value\n\t\t *\n\t\t * @param {string} hookName - The filter hook name\n\t\t * @param {*} value - The value to filter\n\t\t * @param {...*} args - Additional arguments passed to filter callbacks\n\t\t * @returns {*} The filtered value\n\t\t *\n\t\t * @example\n\t\t * let payload = pmw.hooks.applyFilters('pmw_event_payload_pre', payload, eventName);\n\t\t */\n\t\tapplyFilters: function (hookName, value, ...args) {\n\t\t\tif (!this.filters[hookName] || this.filters[hookName].length === 0) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tlet filteredValue = value;\n\n\t\t\tfor (const filter of this.filters[hookName]) {\n\t\t\t\ttry {\n\t\t\t\t\tconst result = filter.callback(filteredValue, ...args);\n\n\t\t\t\t\t// Ensure callback returns a value\n\t\t\t\t\tif (result !== undefined) {\n\t\t\t\t\t\tfilteredValue = result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpmw.console.warn(`Filter ${filter.namespace} on ${hookName} returned undefined, keeping previous value`);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tpmw.console.error(`Filter error in ${filter.namespace} on ${hookName}:`, e);\n\t\t\t\t\t// Continue with the previous value if this filter fails\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn filteredValue;\n\t\t},\n\n\t\t/**\n\t\t * Remove a specific filter\n\t\t *\n\t\t * @param {string} hookName - The filter hook name\n\t\t * @param {string} namespace - The namespace of the filter to remove\n\t\t *\n\t\t * @example\n\t\t * pmw.hooks.removeFilter('pmw_pixel_data_facebook', 'my-plugin');\n\t\t */\n\t\tremoveFilter: function (hookName, namespace) {\n\t\t\tif (!this.filters[hookName]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst initialLength    = this.filters[hookName].length;\n\t\t\tthis.filters[hookName] = this.filters[hookName].filter(f => f.namespace !== namespace);\n\n\t\t\tif (this.filters[hookName].length < initialLength) {\n\t\t\t\tpmw.console.log(`Filter removed: ${hookName} (${namespace})`);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Remove all filters for a specific hook\n\t\t *\n\t\t * @param {string} hookName - The filter hook name\n\t\t */\n\t\tremoveAllFilters: function (hookName) {\n\t\t\tif (this.filters[hookName]) {\n\t\t\t\tdelete this.filters[hookName];\n\t\t\t\tpmw.console.log(`All filters removed for: ${hookName}`);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Check if a specific hook has any filters\n\t\t *\n\t\t * @param {string} hookName - The filter hook name\n\t\t * @param {string} namespace - Optional: check for a specific namespace\n\t\t * @returns {boolean}\n\t\t */\n\t\thasFilter: function (hookName, namespace = null) {\n\t\t\tif (!this.filters[hookName] || this.filters[hookName].length === 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (namespace) {\n\t\t\t\treturn this.filters[hookName].some(f => f.namespace === namespace);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Get all registered filters for a hook\n\t\t *\n\t\t * @param {string} hookName - The filter hook name\n\t\t * @returns {Array} Array of filter objects\n\t\t */\n\t\tgetFilters: function (hookName) {\n\t\t\treturn this.filters[hookName] || [];\n\t\t},\n\t};\n\n\t// Backward compatibility: create pmw.hooks as an alias to pmw.hooks\n\tpmw.hooks = pmw.hooks;\n\n}(window.pmw = window.pmw || {}, jQuery));\n",null,"/**\n * Event Processor\n *\n * Unified event processing system that orchestrates:\n * - Building standardized event payloads\n * - Applying filters at multiple stages\n * - Adapting data for each active pixel\n * - Dispatching to browser pixels and S2S endpoints\n *\n * @since 1.51.0\n */\n\n(function (pmw, $, undefined) {\n\n\t/**\n\t * Get the current consent context\n\t *\n\t * Provides consent status in a structured format for event payloads.\n\t * This allows third-party integrations to make decisions based on\n\t * the current consent state.\n\t *\n\t * @returns {object} Consent context object\n\t */\n\tpmw.getConsentContext = function () {\n\t\tconst categories = pmw.consent?.categories?.get() || {\n\t\t\tstatistics : true,\n\t\t\tmarketing  : true,\n\t\t\tpreferences: true,\n\t\t\tnecessary  : true,\n\t\t};\n\n\t\treturn {\n\t\t\t// Category-level consent status\n\t\t\tcategories: {\n\t\t\t\tstatistics : categories.statistics,\n\t\t\t\tmarketing  : categories.marketing,\n\t\t\t\tpreferences: categories.preferences,\n\t\t\t\tnecessary  : categories.necessary,\n\t\t\t},\n\n\t\t\t// Whether the visitor has actively made a consent choice\n\t\t\tvisitor_has_chosen: pmw.consent?.settings?.get()?.visitorHasChosen ?? false,\n\n\t\t\t// Whether explicit consent mode is active\n\t\t\texplicit_mode: pmw.consent?.explicitConsentModeActive?.() ?? false,\n\t\t};\n\t};\n\n\t/**\n\t * Global event context that's added to all events\n\t *\n\t * @returns {object} Context object with user, session, page, and consent data\n\t */\n\tpmw.getEventContext = function () {\n\t\treturn {\n\t\t\ttimestamp : Math.floor(Date.now() / 1000),\n\t\t\turl       : window.location.href,\n\t\t\treferrer  : pmw.retrieveData(\"referrer\") ? pmw.makeFullUrl(pmw.retrieveData(\"referrer\")) : document.referrer,\n\t\t\tuser_agent: navigator.userAgent,\n\t\t\tpage_type : pmwDataLayer?.shop?.page_type,\n\t\t\tuser_id   : pmwDataLayer?.user?.id?.raw || null,\n\n\t\t\t// Consent status - for third-party integrations and internal use\n\t\t\tconsent: pmw.getConsentContext(),\n\t\t};\n\t};\n\n\t/**\n\t * Process an event through the unified pipeline\n\t *\n\t * This is the main entry point for processing events with the new filter system.\n\t *\n\t * @param {string} eventName - Standardized event name (e.g., 'add_to_cart', 'view_item')\n\t * @param {object} eventData - Core event data (product, cart, order, etc.)\n\t * @returns {Promise<object>} The processed payload\n\t */\n\tpmw.processEvent = async function (eventName, eventData) {\n\n\t\tpmw.console.log(`Processing event: ${eventName}`, eventData);\n\n\t\ttry {\n\t\t\t// 1. Create base payload with standardized structure\n\t\t\tlet payload = {\n\t\t\t\tevent     : eventName,\n\t\t\t\tevent_data: eventData,\n\t\t\t\tpixels    : {},\n\t\t\t\tcontext   : pmw.getEventContext(),\n\t\t\t};\n\n\t\t\t// 2. Apply pre-processing filter\n\t\t\t// Use case: Add global tracking params, modify core data before pixel adaptations\n\t\t\tpayload = pmw.hooks.applyFilters(\"pmw_event_payload_pre\", payload, eventName);\n\n\t\t\t// 3. Transform for each active pixel\n\t\t\tconst activePixels = pmw.pixelRegistry.getActivePixels();\n\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\tconst adapter = pmw.pixelRegistry.getAdapter(pixelName);\n\n\t\t\t\tif (!adapter || typeof adapter.adapt !== \"function\") {\n\t\t\t\t\tpmw.console.log(`No adapter found for pixel: ${pixelName}`);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t// Adapt event data to pixel-specific format (supports async adapters)\n\t\t\t\tlet pixelData = await adapter.adapt(payload.event_data, eventName, payload.context);\n\n\t\t\t\t// Adapters return null for events they don't support\n\t\t\t\t// This allows pixels to opt-out of specific events gracefully\n\t\t\t\t// (e.g., TikTok doesn't support page_view, Pinterest doesn't support add_to_wishlist)\n\t\t\t\tif (pixelData === null) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Apply pixel-specific filter\n\t\t\t\t// Use case: Modify Facebook-specific data, add custom parameters per pixel\n\t\t\t\tpixelData = pmw.hooks.applyFilters(\n\t\t\t\t\t`pmw_pixel_data_${pixelName}`,\n\t\t\t\t\tpixelData,\n\t\t\t\t\teventName,\n\t\t\t\t\tpayload.event_data,\n\t\t\t\t\tpayload.context,\n\t\t\t\t);\n\n\t\t\t\tpayload.pixels[pixelName] = pixelData;\n\t\t\t} catch (e) {\n\t\t\t\tpmw.console.error(`Error adapting data for ${pixelName}:`, e);\n\t\t\t}\n\t\t\t}\n\n\t\t\t// 4. Apply event-specific filter\n\t\t\t// Use case: Modify all pixels for a specific event type (e.g., all add_to_cart events)\n\t\t\tpayload = pmw.hooks.applyFilters(\n\t\t\t\t`pmw_event_payload_${eventName}`,\n\t\t\t\tpayload,\n\t\t\t\tpayload.event_data,\n\t\t\t);\n\n\t\t\t// 5. Apply post-processing filter\n\t\t\t// Use case: Final validation, logging, debugging, cross-pixel modifications\n\t\t\tpayload = pmw.hooks.applyFilters(\"pmw_event_payload_post\", payload, eventName);\n\n\t\t\t// 6. Add firing decisions to payload for each pixel\n\t\t\tpayload.firing = {};\n\t\t\tfor (const pixelName of Object.keys(payload.pixels)) {\n\t\t\t\tpayload.firing[pixelName] = pmw.pixelRegistry.getFiringDecision(pixelName, eventName);\n\t\t\t}\n\n\t\t\t// 7. Dispatch to pixels\n\t\t\tawait pmw.dispatchToPixels(payload);\n\n\t\t\treturn payload;\n\n\t\t} catch (e) {\n\t\t\tpmw.console.error(`Error processing event ${eventName}:`, e);\n\t\t\tthrow e;\n\t\t}\n\t};\n\n\t/**\n\t * Dispatch the processed payload to pixels\n\t *\n\t * Unified dispatch system that:\n\t * 1. Dispatches a single pmw:{event} event with firing decisions per pixel\n\t * 2. Sends to server for pixels that need S2S\n\t *\n\t * @param {object} payload - The fully processed event payload with firing decisions\n\t * @returns {Promise<void>}\n\t */\n\tpmw.dispatchToPixels = async function (payload) {\n\n\t\tconst eventName = payload.event;\n\n\t\t// Dispatch unified event (replaces separate browser/s2s events)\n\t\t// Pixels check payload.firing[pixelName].fire_browser to decide if they should fire\n\t\tpmw.dispatchUnifiedEvent(payload);\n\n\t\t// Dispatch PUBLIC event for third-party integrations\n\t\t// This is the official public API - pmw:event:* events\n\t\t// Third parties should listen to these events, not the internal pmw:* events\n\t\tpmw.dispatchPublicEvent(payload);\n\n\t\t// Purchase events are handled entirely server-side and should never be sent from browser to server\n\t\t// to prevent duplicates and race conditions. However, browser-side pixels still need to fire.\n\t\tif (eventName === \"purchase\") {\n\t\t\tpmw.console.log(\"Purchase event - skipping browser-to-server transmission (handled server-side only)\");\n\t\t\treturn; // Return early, but browser pixels have already been dispatched above\n\t\t}\n\n\t\t// Only send to server if S2S is globally enabled\n\t\tif (pmwDataLayer?.general?.server_2_server?.active) {\n\t\t\t// Extract S2S data for server transmission\n\t\t\tconst s2sData = pmw.extractS2SData(payload);\n\n\t\t\t// Send to server if there's S2S data to send\n\t\t\tif (Object.keys(s2sData).length > 0) {\n\t\t\t\tconst serverPixels = pmw.pixelRegistry.getPixelsForServerFiring(eventName);\n\t\t\t\tpmw.console.log(`S2S enabled pixels for ${eventName}:`, serverPixels);\n\t\t\t\tawait pmw.sendEventPayloadToServer(s2sData);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Dispatch unified event to all pixels\n\t *\n\t * This is the new unified event system that replaces the separate pmw:browser:* and pmw:s2s:* events.\n\t * All pixels now listen to pmw:pixel:{event-name} and check payload.firing[pixelName].fire_browser\n\t * to determine if they should fire their browser pixel.\n\t *\n\t * NOTE: This is an INTERNAL event. Third parties should use pmw:event:* events instead.\n\t *\n\t * Event namespace:\n\t * - pmw:{event}        - Entry point events (triggers processEvent)\n\t * - pmw:pixel:{event}  - Pixel dispatch events (pixels listen to these)\n\t * - pmw:event:{event}  - Public API events (third-party integrations)\n\t *\n\t * @param {object} payload - The fully processed event payload with firing decisions\n\t */\n\tpmw.dispatchUnifiedEvent = function (payload) {\n\n\t\tconst activePixels = pmw.pixelRegistry.getActivePixels();\n\n\t\tif (activePixels.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Convert underscores to hyphens for event name\n\t\tconst eventName = payload.event.replace(/_/g, \"-\");\n\n\t\tpmw.console.log(`Dispatching unified event pmw:pixel:${eventName}`, {\n\t\t\tactivePixels : activePixels,\n\t\t\tfiringStatus : payload.firing,\n\t\t});\n\n\t\t// Dispatch single unified event to pixel namespace\n\t\t// Pixels check payload.firing[pixelName].fire_browser to decide whether to fire\n\t\tjQuery(document).trigger(`pmw:pixel:${eventName}`, payload);\n\t};\n\n\t/**\n\t * @deprecated Use pmw.dispatchUnifiedEvent() instead\n\t * Dispatch to browser-only pixels (internal) - LEGACY SUPPORT\n\t *\n\t * NOTE: This function is deprecated. Migrate to listening to pmw:* events\n\t * and checking payload.firing[pixelName].fire_browser\n\t *\n\t * @param {object} payload - The fully processed event payload\n\t */\n\tpmw.dispatchToBrowserPixels = function (payload) {\n\n\t\tconst browserPixels = pmw.pixelRegistry.getActiveBrowserOnlyPixels();\n\n\t\tif (browserPixels.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tpmw.console.log(`[DEPRECATED] Dispatching to browser-only pixels for ${payload.event}:`, browserPixels);\n\n\t\t// Trigger browser-specific event that browser-only pixels can listen to (internal)\n\t\t// This allows them to access the filtered, adapted data\n\t\t// Convert underscores to hyphens for event name\n\t\tconst browserEventName = payload.event.replace(/_/g, \"-\");\n\t\tjQuery(document).trigger(`pmw:browser:${browserEventName}`, payload);\n\t};\n\n\t/**\n\t * @deprecated Use pmw.dispatchUnifiedEvent() instead\n\t * Dispatch to S2S-capable pixels (internal) - LEGACY SUPPORT\n\t *\n\t * NOTE: This function is deprecated. Migrate to listening to pmw:* events\n\t * and checking payload.firing[pixelName].fire_browser\n\t *\n\t * @param {object} payload - The fully processed event payload\n\t */\n\tpmw.dispatchToS2SPixels = function (payload) {\n\n\t\tconst s2sPixels = pmw.pixelRegistry.getActiveS2SPixels();\n\n\t\tif (s2sPixels.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tpmw.console.log(`[DEPRECATED] Dispatching to S2S-capable pixels for ${payload.event}:`, s2sPixels);\n\n\t\t// Trigger S2S event that S2S-capable pixels listen to (internal)\n\t\t// This provides adapted data with event_id for deduplication between browser and server\n\t\t// Convert underscores to hyphens for event name\n\t\tconst s2sEventName = payload.event.replace(/_/g, \"-\");\n\t\tjQuery(document).trigger(`pmw:s2s:${s2sEventName}`, payload);\n\t};\n\n\t/**\n\t * Dispatch public event for third-party integrations\n\t *\n\t * This is the official PUBLIC API for third-party integrations.\n\t * Third parties should listen to pmw:event:* events to receive\n\t * fully processed payloads with all data including consent status.\n\t *\n\t * Available events:\n\t * - pmw:event:add-to-cart\n\t * - pmw:event:remove-from-cart\n\t * - pmw:event:view-item\n\t * - pmw:event:view-item-list\n\t * - pmw:event:select-item\n\t * - pmw:event:begin-checkout\n\t * - pmw:event:add-payment-info\n\t * - pmw:event:add-to-wishlist\n\t * - pmw:event:purchase\n\t * - pmw:event:search\n\t * - pmw:event:page-view\n\t *\n\t * @param {object} payload - The fully processed event payload\n\t */\n\tpmw.dispatchPublicEvent = function (payload) {\n\n\t\t// Convert underscores to hyphens for event name (e.g., add_to_cart -> add-to-cart)\n\t\tconst publicEventName = payload.event.replace(/_/g, \"-\");\n\n\t\t// Dispatch the public event that third parties can listen to\n\t\t// This includes all processed data: event_data, pixels, firing, and context (with consent)\n\t\tjQuery(document).trigger(`pmw:event:${publicEventName}`, payload);\n\n\t\tpmw.console.log(`Public event dispatched: pmw:event:${publicEventName}`, payload);\n\t};\n\t/**\n\t * Extract server-to-server data from the payload\n\t *\n\t * Only pixels with fire_server=true in their firing decision should be included.\n\t * This creates a single payload with data for all server-firing pixels.\n\t *\n\t * @param {object} payload - The full event payload with firing decisions\n\t * @returns {object} S2S-only data for server transmission\n\t */\n\tpmw.extractS2SData = function (payload) {\n\n\t\tconst s2sData = {\n\t\t\tevent: payload.event,\n\t\t};\n\n\t\t// Use the new firing decision system\n\t\tconst serverPixels = pmw.pixelRegistry.getPixelsForServerFiring(payload.event);\n\n\t\tfor (const pixelName of serverPixels) {\n\t\t\tif (payload.pixels[pixelName]) {\n\t\t\t\ts2sData[pixelName] = payload.pixels[pixelName];\n\t\t\t}\n\t\t}\n\n\t\t// Add product data if present (for server-side processing)\n\t\tif (payload.event_data?.product) {\n\t\t\ts2sData.product = payload.event_data.product;\n\t\t}\n\n\t\treturn s2sData;\n\t};\n\n\t/**\n\t * Check if a pixel should fire its browser pixel for a given payload\n\t *\n\t * This is a convenience method for pixels to use in their event listeners.\n\t * It checks the payload.firing[pixelName].fire_browser flag.\n\t *\n\t * @param {object} payload - The event payload with firing decisions\n\t * @param {string} pixelName - The pixel name to check\n\t * @returns {boolean} True if the browser pixel should fire\n\t *\n\t * @example\n\t * jQuery(document).on(\"pmw:add-to-cart\", (event, payload) => {\n\t *   if (!pmw.shouldFireBrowserPixel(payload, 'facebook')) return;\n\t *   // Fire the pixel...\n\t * });\n\t */\n\tpmw.shouldFireBrowserPixel = function (payload, pixelName) {\n\t\treturn payload.firing?.[pixelName]?.fire_browser === true;\n\t};\n\n\t/**\n\t * Check if a pixel should fire server-side for a given payload\n\t *\n\t * @param {object} payload - The event payload with firing decisions\n\t * @param {string} pixelName - The pixel name to check\n\t * @returns {boolean} True if the server-side event should fire\n\t */\n\tpmw.shouldFireServerPixel = function (payload, pixelName) {\n\t\treturn payload.firing?.[pixelName]?.fire_server === true;\n\t};\n\n\t/**\n\t * Initialize adapters namespace\n\t */\n\tif (!pmw.adapters) {\n\t\tpmw.adapters = {};\n\t}\n\n\t/**\n\t * Helper function to register an adapter with optional capabilities\n\t *\n\t * Firing Modes:\n\t * - browser_only: Fire only in browser, no server-side (default for pixels without S2S)\n\t * - server_only: Fire only server-side, suppress browser pixel completely\n\t * - both: Fire browser AND server with event_id deduplication (Facebook, TikTok default)\n\t * - browser_or_server: Fire one OR the other, never both (GA4 purchase)\n\t *\n\t * @param {string} pixelName - The pixel name\n\t * @param {object} adapter - The adapter object with an adapt() method\n\t * @param {object} [options] - Optional capabilities configuration\n\t * @param {string} [options.mode='browser_only'] - Firing mode: browser_only, server_only, both, browser_or_server\n\t * @param {boolean} [options.supportsS2S=false] - Whether pixel supports server-to-server tracking\n\t * @param {boolean} [options.supportsEventDeduplication=false] - Whether pixel supports event deduplication\n\t * @param {function} [options.isActive] - Function that returns true if pixel is active/loaded\n\t *\n\t * @example\n\t * // Browser-only pixel (Microsoft Ads)\n\t * pmw.registerAdapter('bing', BingAdapter, {\n\t *   mode: 'browser_only',\n\t *   isActive: () => !!pmwDataLayer?.pixels?.bing?.loaded\n\t * });\n\t *\n\t * @example\n\t * // S2S pixel with deduplication (Facebook)\n\t * pmw.registerAdapter('facebook', FacebookAdapter, {\n\t *   mode: 'both',\n\t *   supportsS2S: true,\n\t *   supportsEventDeduplication: true,\n\t *   isActive: () => !!pmwDataLayer?.pixels?.facebook?.pixel_id\n\t * });\n\t */\n\tpmw.registerAdapter = function (pixelName, adapter, options = {}) {\n\t\tif (!adapter || typeof adapter.adapt !== \"function\") {\n\t\t\tpmw.console.error(`Invalid adapter for ${pixelName}: must have an adapt() method`);\n\t\t\treturn;\n\t\t}\n\n\t\t// Store the adapter\n\t\tpmw.adapters[pixelName] = adapter;\n\n\t\t// Store pixel capabilities\n\t\tif (!pmw.pixelCapabilities) {\n\t\t\tpmw.pixelCapabilities = {};\n\t\t}\n\n\t\t// Determine default mode based on S2S support\n\t\tlet defaultMode = \"browser_only\";\n\t\tif (options.supportsS2S) {\n\t\t\tdefaultMode = \"both\";\n\t\t}\n\n\t\tpmw.pixelCapabilities[pixelName] = {\n\t\t\tmode                      : options.mode || defaultMode,\n\t\t\tsupportsS2S               : options.supportsS2S || false,\n\t\t\tsupportsEventDeduplication: options.supportsEventDeduplication || false,\n\t\t\tisActive                  : options.isActive || null,\n\t\t};\n\n\t\t// pmw.console.log(`Adapter registered for: ${pixelName}`, pmw.pixelCapabilities[pixelName]);\n\t};\n\n}(window.pmw = window.pmw || {}, jQuery));","/**\n * IP functions\n */\n\n(function (pmw, $, undefined) {\n\n\tconst {isRange, isIP, isV4, isV6, version: getIpVersion} = require(\"range_check\")\n\n\t// Promise-based IP detection to prevent race conditions\n\t// Stores the ongoing detection promise so multiple callers can await the same result\n\tlet ipDetectionPromise = null\n\t let ipDetectionResolved = false\n\n\tconst ipServices = {\n\t\t\"cloudflare\": {\n\t\t\t\"any\": \"https://www.cloudflare.com/cdn-cgi/trace\",\n\t\t},\n\t\t// icanhazip seems to regularly be added to malware databases, despite being a legitimate service run by Cloudflare\n\t\t// https://blog.apnic.net/2021/06/17/how-a-small-free-ip-tool-survived/\n\t\t// https://major.io/p/a-new-future-for-icanhazip/\n\t\t// https://major.io/p/extra-icanhaz-services-going-offline/\n\t\t\"icanhazip\"   : {\n\t\t\t\"4\"  : \"https://ipv4.icanhazip.com\",\n\t\t\t\"6\"  : \"https://ipv6.icanhazip.com\",\n\t\t\t\"any\": \"https://icanhazip.com\",\n\t\t},\n\t\t\"ipinfo\"      : {\n\t\t\t\"any\": \"https://ipinfo.io/ip\",\n\t\t},\n\t\t\"myexternalip\": {\n\t\t\t\"any\": \"https://myexternalip.com/raw\",\n\t\t\t// \"6\": \"https://api-ipv6.myexternalip.com/raw\", // This can return an IPv4 address, so we can't use it\n\t\t},\n\t\t\"ipify\"       : {\n\t\t\t\"4\"  : \"https://api4.ipify.org\",\n\t\t\t\"6\"  : \"https://api6.ipify.org\",\n\t\t\t\"any\": \"https://api64.ipify.org\", // If IPv6 is available, AND the client is configured to prefer IPv6, this will return an IPv6 address\n\t\t},\n\t\t// ident.me - Reliable service with dedicated IPv4 and IPv6 endpoints\n\t\t// https://api.ident.me/\n\t\t\"identme\"     : {\n\t\t\t\"4\"  : \"https://4.ident.me/\",\n\t\t\t\"6\"  : \"https://6.ident.me/\",\n\t\t\t\"any\": \"https://ident.me/\",\n\t\t},\n\t\t// Can't use amazon because its CORS policy blocks requests from the browser\n\t\t// \"amazon\"    : {\n\t\t// \t\"any\": \"https://checkip.amazonaws.com/\",\n\t\t// },\n\t\t// Can't use ip.sb because its CORS policy blocks requests from the browser\n\t\t// \"ip.sb\"     : {\n\t\t// \t\"any\": \"https://api.ip.sb/ip\",\n\t\t// },\n\t\t// Can't use seeip because its CORS policy blocks requests from the browser\n\t\t// \"seeip\"       : {\n\t\t// \t\"any\": \"https://api.seeip.org\",\n\t\t// \t\"4\": \"https://ipv4.seeip.org\",\n\t\t// \t\"6\": \"https://ipv6.seeip.org\",\n\t\t// },\n\t}\n\n\t/**\n\t * Default timeout for IP service requests in milliseconds.\n\t * If a service doesn't respond within this time, the request is aborted.\n\t */\n\tconst IP_SERVICE_TIMEOUT_MS = 3000\n\n\t/**\n\t * Timeout for IPv6 detection in milliseconds.\n\t * IPv6 detection gets a shorter timeout since we fall back to any IP if it fails.\n\t * This prevents long waits for users without IPv6 connectivity.\n\t */\n\tconst IPV6_DETECTION_TIMEOUT_MS = 2000\n\n\t/**\n\t * Fetch with timeout using AbortController.\n\t * Aborts the request if it takes longer than the specified timeout.\n\t *\n\t * @param {string} url - The URL to fetch\n\t * @param {number} timeoutMs - Timeout in milliseconds (default: IP_SERVICE_TIMEOUT_MS)\n\t * @returns {Promise<Response>} The fetch response\n\t * @throws {Error} Throws 'AbortError' if the request times out\n\t */\n\tconst fetchWithTimeout = (url, timeoutMs = IP_SERVICE_TIMEOUT_MS) => {\n\t\tconst controller = new AbortController()\n\t\tconst timeoutId = setTimeout(() => controller.abort(), timeoutMs)\n\n\t\treturn fetch(url, { signal: controller.signal })\n\t\t\t.finally(() => clearTimeout(timeoutId))\n\t}\n\n\tpmw.getGeoInfo = {\n\n\t\tcloudflare: async () => {\n\n\t\t\tconst response = await fetchWithTimeout(\"https://www.cloudflare.com/cdn-cgi/trace\")\n\n\t\t\tif (!response.ok) throw new Error(`The response from Cloudflare was not OK. Status: ${response.status}`)\n\n\t\t\tlet data = await response.text()\n\n\t\t\tif (!data) throw new Error(\"No data was returned from Cloudflare\")\n\n\t\t\t// Convert key-value pairs to JSON\n\t\t\t// https://stackoverflow.com/a/39284735/452587\n\t\t\tdata = data\n\t\t\t\t.trim()\n\t\t\t\t.split(\"\\n\")\n\t\t\t\t.reduce((obj, pair) => {\n\t\t\t\t\tpair = pair.split(\"=\")\n\t\t\t\t\treturn obj[pair[0]] = pair[1], obj\n\t\t\t\t}, {})\n\n\t\t\tif (!data.ip || !data.loc) throw new Error(\"The JSON data is missing the ip or loc key from Cloudflare\")\n\n\t\t\t/**\n\t\t\t * Cloudflare doesn't return the region.\n\t\t\t * If the website manager has set a region such as California in the restricted_regions array,\n\t\t\t * we have to validate the region. This is not possible with the data from Cloudflare.\n\t\t\t * So we have to abort the process and give the other services a chance to return the region.\n\t\t\t */\n\t\t\tif (processRegion(data.loc)) throw new Error(\"We have to validate the region, and this service is not returning the region.\")\n\n\t\t\treturn {\n\t\t\t\tip         : data.ip,\n\t\t\t\tcountryCode: data.loc,\n\t\t\t\tservice    : \"cloudflare\",\n\t\t\t}\n\t\t},\n\n\t\tgeojs: async () => {\n\n\t\t\tconst response = await fetchWithTimeout(\"https://get.geojs.io/v1/ip/geo.json\")\n\n\t\t\tif (!response.ok) throw new Error(`The response from geojs was not OK. Status: ${response.status}`)\n\n\t\t\tlet data = await response.json()\n\n\t\t\tif (!data) throw new Error(\"No JSON data was returned from geojs\")\n\t\t\tif (!data.ip || !data.country_code || !data.region) throw new Error(\"The JSON data is missing the ip, country_code, or region key from geojs\")\n\n\t\t\treturn {\n\t\t\t\tip         : data.ip,\n\t\t\t\tcountryCode: data.country_code,\n\t\t\t\tregion     : data.region,\n\t\t\t\tservice    : \"geojs\",\n\t\t\t}\n\t\t},\n\n\t\tipinfo: async () => {\n\n\t\t\tconst response = await fetchWithTimeout(\"https://ipinfo.io/json\")\n\n\t\t\tif (!response.ok) throw new Error(`The response from ipinfo was not OK from ipinfo. Status: ${response.status}`)\n\n\t\t\tlet data = await response.json()\n\n\t\t\tif (!data) throw new Error(\"No JSON data was returned from ipinfo\")\n\t\t\tif (!data.ip || !data.country || !data.region) throw new Error(\"The JSON data is missing the ip, country, or region key from ipinfo\")\n\n\t\t\treturn {\n\t\t\t\tip         : data.ip,\n\t\t\t\tcountryCode: data.country,\n\t\t\t\tregion     : data.region,\n\t\t\t\tservice    : \"ipinfo\",\n\t\t\t}\n\t\t},\n\n\t\tipapi: async () => {\n\n\t\t\tconst response = await fetchWithTimeout(\"https://ipapi.co/json\")\n\n\t\t\tif (!response.ok) throw new Error(`The response from ipapi was not OK. Status: ${response.status}`)\n\n\t\t\tlet data = await response.json()\n\n\t\t\tif (!data) throw new Error(\"No JSON data was returned from ipapi\")\n\t\t\tif (!data.ip || !data.country || !data.region) throw new Error(\"The JSON data is missing the ip, country, or region key from ipapi\")\n\n\t\t\treturn {\n\t\t\t\tip         : data.ip,\n\t\t\t\tcountryCode: data.country,\n\t\t\t\tregion     : data.region,\n\t\t\t\tservice    : \"ipapi\",\n\t\t\t}\n\t\t},\n\t}\n\n\t/**\n\t * /**\n\t * Cloudflare doesn't return the region.\n\t * If the website manager has set a region such as California in the restricted_regions array,\n\t * we have to validate the region. This is not possible with the data from Cloudflare.\n\t * So we have to abort the process and give the other services a chance to return the region.\n\t *\n\t * If the country code is US,\n\t * and the restricted_regions array contains \"US-CA\" or \"US-VA\",\n\t * we must process the region.\n\t *\n\t * @param countryCode\n\t * @returns {boolean}\n\t */\n\tconst processRegion = (countryCode) => {\n\n\t\tif (countryCode !== \"US \") return false\n\n\t\tconst regionsToCheck = [\"US-CA\", \"US-VA\"]\n\n\t\treturn regionsToCheck.some(region =>\n\t\t\tpmwDataLayer?.general?.consent_management.restricted_regions.includes(region),\n\t\t)\n\t}\n\n\t/**\n\t * Check if the visitor is allowed to trigger server-to-server events\n\t * This checks both bot user-agent patterns and custom IP exclusion list\n\t *\n\t * @returns {Promise<boolean>} True if the visitor is allowed\n\t */\n\tpmw.isVisitorAllowed = async () => {\n\n\t\t// Check the cache if visitor is allowed\n\t\tif (pmw.retrieveData(\"visitorAllowed\") !== null && pmw.retrieveData(\"visitorAllowed\") !== undefined) {\n\t\t\treturn !!JSON.parse(pmw.retrieveData(\"visitorAllowed\"))\n\t\t}\n\n\t\t// Check if user agent is a bot\n\t\tif (pmw.isBotUserAgent()) {\n\t\t\tpmw.storeData(\"visitorAllowed\", false)\n\t\t\treturn false\n\t\t}\n\n\t\t// Check if IP is on the exclusion list (if custom exclusions are defined)\n\t\tif (Array.isArray(pmwDataLayer?.general?.server_2_server?.ip_exclude_list) \n\t\t\t&& pmwDataLayer.general.server_2_server.ip_exclude_list.length > 0) {\n\t\t\t\n\t\t\tconst ip = await pmw.getIp()\n\t\t\t\n\t\t\tif (isOnIpExclusionList(ip)) {\n\t\t\t\tpmw.storeData(\"visitorAllowed\", false)\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\t// If not a bot and not on IP exclusion list, visitor is allowed\n\t\tpmw.storeData(\"visitorAllowed\", true)\n\t\treturn true\n\t}\n\n\t/**\n\t * Validates an IP address (IPv4 or IPv6)\n\t *\n\t * @param {string} ip - The IP address to validate\n\t * @returns {boolean} True if the IP is valid\n\t */\n\tpmw.isValidIpAddress = (ip) => {\n\t\tif (!ip || typeof ip !== \"string\") return false\n\n\t\t// Use the range_check library's isIP function for accurate validation\n\t\tif (!isIP(ip)) return false\n\n\t\t// Additional validation: ensure it's not a private/reserved IP\n\t\t// This is important for CAPI which needs public IPs\n\t\treturn !pmw.isPrivateOrReservedIp(ip)\n\t}\n\n\t/**\n\t * Check if an IP is private or reserved (not suitable for CAPI)\n\t *\n\t * @param {string} ip - The IP address to check\n\t * @returns {boolean} True if the IP is private or reserved\n\t */\n\tpmw.isPrivateOrReservedIp = (ip) => {\n\t\tif (!ip) return true\n\n\t\t// IPv4 private ranges\n\t\tconst ipv4PrivateRanges = [\n\t\t\t\"10.0.0.0/8\",\n\t\t\t\"172.16.0.0/12\",\n\t\t\t\"192.168.0.0/16\",\n\t\t\t\"127.0.0.0/8\",\n\t\t\t\"169.254.0.0/16\", // Link-local\n\t\t\t\"0.0.0.0/8\",\n\t\t]\n\n\t\t// IPv6 private/reserved ranges\n\t\tconst ipv6PrivateRanges = [\n\t\t\t\"::1/128\",         // Loopback\n\t\t\t\"fc00::/7\",        // Unique local\n\t\t\t\"fe80::/10\",       // Link-local\n\t\t\t\"::/128\",          // Unspecified\n\t\t]\n\n\t\tconst privateRanges = isV4(ip) ? ipv4PrivateRanges : ipv6PrivateRanges\n\n\t\t// Use is-in-subnet for accurate range checking\n\t\ttry {\n\t\t\tconst isInSubnet = require(\"is-in-subnet\")\n\t\t\tfor (const range of privateRanges) {\n\t\t\t\tif (isInSubnet.isInSubnet(ip, range)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// If is-in-subnet check fails, fall back to basic checks\n\t\t\t// These cover the most common private ranges\n\t\t\tif (isV4(ip)) {\n\t\t\t\tif (ip.startsWith(\"10.\") || \n\t\t\t\t\tip.startsWith(\"192.168.\") || \n\t\t\t\t\tip.startsWith(\"127.\") ||\n\t\t\t\t\tip.startsWith(\"169.254.\") ||\n\t\t\t\t\tip.startsWith(\"0.\")) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\t// Check 172.16.0.0/12 range (172.16.x.x - 172.31.x.x)\n\t\t\t\tconst parts = ip.split(\".\")\n\t\t\t\tif (parts[0] === \"172\") {\n\t\t\t\t\tconst second = parseInt(parts[1], 10)\n\t\t\t\t\tif (second >= 16 && second <= 31) {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// IPv6 basic checks\n\t\t\t\tif (ip === \"::1\" || ip.startsWith(\"fc\") || ip.startsWith(\"fd\") || ip.startsWith(\"fe80:\")) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\t/**\n\t * Get the client IP address, with race condition prevention.\n\t * Detects IPv6 and any IP in parallel, preferring IPv6 when available.\n\t * IPv6 gets a shorter timeout (2s) to avoid long waits for IPv4-only users.\n\t *\n\t * @returns {Promise<string|null>} The client IP address or null\n\t */\n\tpmw.getClientIp = async () => {\n\t\t// If we already have a resolved IP, return it immediately\n\t\tconst cachedIp = pmw.retrieveData(\"client_ip\")\n\t\tif (cachedIp && pmw.isValidIpAddress(cachedIp)) {\n\t\t\treturn cachedIp\n\t\t}\n\n\t\t// If detection is already in progress, wait for it\n\t\tif (ipDetectionPromise && !ipDetectionResolved) {\n\t\t\treturn ipDetectionPromise\n\t\t}\n\n\t\t// Start a new detection process\n\t\tipDetectionResolved = false\n\t\tipDetectionPromise = (async () => {\n\t\t\ttry {\n\t\t\t\t// Start both IPv6 and \"any\" detection in parallel\n\t\t\t\t// IPv6 is preferred by Meta and other CAPIs\n\t\t\t\tconst ipv6Promise = pmw.getIpWithTimeout(\"6\", IPV6_DETECTION_TIMEOUT_MS)\n\t\t\t\tconst anyPromise = pmw.getIp(\"any\")\n\n\t\t\t\t// Wait for both to settle (resolve or reject)\n\t\t\t\tconst [ipv6Result, anyResult] = await Promise.allSettled([ipv6Promise, anyPromise])\n\n\t\t\t\t// Determine which IP to use (prefer IPv6, fall back to any IP)\n\t\t\t\tlet ip = null\n\n\t\t\t\t// Check IPv6 result first (preferred)\n\t\t\t\tif (ipv6Result.status === \"fulfilled\" && ipv6Result.value) {\n\t\t\t\t\tip = ipv6Result.value\n\t\t\t\t\tpmw.console.log(`Using IPv6 address: ${ip}`)\n\t\t\t\t}\n\t\t\t\t// Fall back to any IP if IPv6 failed or wasn't available\n\t\t\t\telse if (anyResult.status === \"fulfilled\" && anyResult.value) {\n\t\t\t\t\tip = anyResult.value\n\t\t\t\t\tpmw.console.log(`IPv6 not available, using IP: ${ip}`)\n\t\t\t\t}\n\n\t\t\t\t// Validate before storing\n\t\t\t\tif (ip && pmw.isValidIpAddress(ip)) {\n\t\t\t\t\tpmw.storeData(\"client_ip\", ip)\n\t\t\t\t\tipDetectionResolved = true\n\t\t\t\t\treturn ip\n\t\t\t\t}\n\n\t\t\t\tipDetectionResolved = true\n\t\t\t\treturn null\n\t\t\t} catch (error) {\n\t\t\t\tpmw.console.error(\"Error detecting client IP:\", error)\n\t\t\t\tipDetectionResolved = true\n\t\t\t\treturn null\n\t\t\t}\n\t\t})()\n\n\t\treturn ipDetectionPromise\n\t}\n\n\t/**\n\t * Get IP with a custom timeout.\n\t * Wraps getIp with a timeout that rejects if the detection takes too long.\n\t *\n\t * @param {string} ipVersion - The IP version to detect (\"4\", \"6\", or \"any\")\n\t * @param {number} timeoutMs - Maximum time to wait in milliseconds\n\t * @returns {Promise<string|null>} The detected IP or null\n\t */\n\tpmw.getIpWithTimeout = async (ipVersion, timeoutMs) => {\n\t\treturn Promise.race([\n\t\t\tpmw.getIp(ipVersion),\n\t\t\tnew Promise((_, reject) => \n\t\t\t\tsetTimeout(() => reject(new Error(`IPv${ipVersion} detection timed out after ${timeoutMs}ms`)), timeoutMs)\n\t\t\t)\n\t\t]).catch(error => {\n\t\t\tpmw.console.log(error.message)\n\t\t\treturn null\n\t\t})\n\t}\n\n\tpmw.getIp = async (ipVersion = \"any\", maxServicesToCheck = 3) => {\n\n\t\tconst validVersions = [\"any\", \"4\", \"6\"]\n\n\t\t// return null if the version is not valid and console log an error\n\t\tif (!validVersions.includes(ipVersion)) {\n\t\t\tconsole.error(\"The version argument must be one of the following: \" + validVersions.join(\", \"))\n\t\t\treturn null\n\t\t}\n\n\t\tif (ipVersion === \"any\" && pmw.retrieveData(\"ip\")) {\n\t\t\treturn pmw.retrieveData(\"ip\")\n\t\t}\n\n\t\t// Get the ipv data from the cache\n\t\tconst ipv = pmw.retrieveData(`ipv${ipVersion}`)\n\n\t\t// Return it if it is not undefined\n\t\t// The value can be an IP\n\t\t// or null if we ran the test but no IP could be retrieved\n\t\t// It is undefined if the ipVersion was not tested yet\n\t\tif (ipv !== undefined) return ipv\n\n\t\tpmw.console.log(\"Testing the IP address of the browser because one ore more server-to-server APIs are enabled and require the browser IP. It may trigger connection request errors in the console while testing the IP address. This is normal and expected behavior.\")\n\n\t\ttry {// Check the cache if the IP is already stored\n\n\t\t\tconst ip = await pmw.getIpFromAnyService(ipVersion, maxServicesToCheck)\n\n\t\t\t// Validate the IP before storing\n\t\t\tif (ip && !isIP(ip)) {\n\t\t\t\tpmw.console.warn(`Invalid IP address received: ${ip}`)\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\t// Store the IP in the cache\n\t\t\tif (ipVersion === \"any\" && ip) {\n\t\t\t\tpmw.storeData(\"ip\", ip)\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tgetIpVersion(ip) === 4\n\t\t\t\t|| (ipVersion === \"4\" && ip === null)\n\t\t\t) {\n\t\t\t\tpmw.storeData(\"ipv4\", ip)\n\t\t\t}\n\n\t\t\tif (getIpVersion(ip) === 6\n\t\t\t\t|| (ipVersion === \"6\" && ip === null)\n\t\t\t) {\n\t\t\t\tpmw.storeData(\"ipv6\", ip)\n\t\t\t}\n\n\t\t\treturn ip\n\t\t} catch (error) {\n\t\t\t// console.error(error)\n\t\t\treturn null\n\t\t}\n\t}\n\n\tpmw.getBrowserGeoFromExternalService = async () => {\n\n\t\tconst startTime = performance.now()\n\n\t\tlet promises = []\n\n\t\tObject.keys(pmw.getGeoInfo).forEach(service => {\n\t\t\tpromises.push(pmw.getGeoInfo[service]())\n\t\t})\n\n\t\ttry {\n\t\t\tconst data = await Promise.any(promises)\n\n\t\t\tdata.countryCode = data.countryCode.toUpperCase()\n\n\t\t\tif (data.region && data.region === \"California\") {\n\t\t\t\tdata.regionCode = \"US-CA\"\n\t\t\t}\n\n\t\t\tif (data.region && data.region === \"Virginia\") {\n\t\t\t\tdata.regionCode = \"US-VA\"\n\t\t\t}\n\n\t\t\tpmw.console.log(\n\t\t\t\t\"Retrieved the browser geo info from an external service: \",\n\t\t\t\tdata,\n\t\t\t\t\" which took \",\n\t\t\t\t(performance.now() - startTime).toFixed(2) + \" ms\",\n\t\t\t)\n\n\t\t\t// pmw.storeData(\"countryCode\", data.countryCode)\n\t\t\t// pmw.storeData(\"ip\", data.ip)\n\t\t\treturn data\n\t\t} catch (error) {\n\t\t\tpmw.console.error(\"error: \", error)\n\t\t\treturn null\n\t\t}\n\t}\n\n\tconst getBrowserLocationByTimeZone = () => {\n\n\t\tconst geo         = require(\"./geo/geo.mjs\")\n\t\tconst geoLocation = geo.getLocationByTimeZone()\n\n\t\tif (geoLocation.countryCode) {\n\t\t\treturn geoLocation\n\t\t}\n\n\t\treturn null\n\t}\n\n\tpmw.getBrowserGeo = async () => {\n\n\t\tlet geoFromStorage = {}\n\n\t\tif (pmw.retrieveData(\"geoCountryCode\")) geoFromStorage.countryCode = pmw.retrieveData(\"geoCountryCode\")\n\t\tif (pmw.retrieveData(\"geoRegionCode\")) geoFromStorage.regionCode = pmw.retrieveData(\"geoRegionCode\")\n\t\tif (pmw.retrieveData(\"geoRegion\")) geoFromStorage.region = pmw.retrieveData(\"geoRegion\")\n\n\t\tif (geoFromStorage.countryCode) {\n\t\t\tpmw.console.log(\"Retrieved the browser geo location from the cache: \", geoFromStorage)\n\t\t\treturn geoFromStorage\n\t\t}\n\n\t\tlet geoInfo = await pmw.getBrowserGeoFromExternalService()\n\n\t\t// If the external services fail, try to use the timezone fallback to get the country\n\t\tif (!geoInfo) {\n\n\t\t\tconst gepLocationByTimeZone = getBrowserLocationByTimeZone()\n\n\t\t\tgeoInfo = {}\n\n\t\t\tif (gepLocationByTimeZone) pmw.console.log(\"Retrieved the browser geo location from the timezone: \", gepLocationByTimeZone)\n\t\t\tif (gepLocationByTimeZone.countryCode) geoInfo.countryCode = gepLocationByTimeZone.countryCode\n\t\t\tif (gepLocationByTimeZone.regionCode) geoInfo.regionCode = gepLocationByTimeZone.regionCode\n\t\t}\n\n\t\tif (geoInfo?.ip) pmw.storeData(\"ip\", geoInfo.ip)\n\t\tif (geoInfo?.countryCode) pmw.storeData(\"geoCountryCode\", geoInfo.countryCode)\n\t\tif (geoInfo?.regionCode) pmw.storeData(\"geoRegionCode\", geoInfo.regionCode)\n\t\tif (geoInfo?.region) pmw.storeData(\"geoRegion\", geoInfo.region)\n\n\t\tif (geoInfo?.countryCode) {\n\t\t\treturn geoInfo\n\t\t}\n\n\t\treturn null\n\t}\n\n\t/**\n\t * Get the IP from the visitor using different services.\n\t * Return the first valid IP address that can be retrieved the fastest.\n\t *\n\t * @returns {Promise<IP>}\n\t */\n\tpmw.getIpFromAnyService = async (ipVersion = \"any\", maxServicesToCheck = 3) => {\n\n\t\t// start tracking time\n\t\tconst startTime = performance.now()\n\n\t\t// take the ipServices object and filter it to only contain objects with an ipVersion key that matches the ipVersion argument\n\t\t// keep the original order of the ipServices object\n\t\t// also keep only the first maxServicesToCheck objects\n\n\t\tconst ipServicesFiltered = Object.keys(ipServices)\n\t\t\t.filter(service => ipServices[service][ipVersion])\n\t\t\t.slice(0, maxServicesToCheck)\n\t\t\t.reduce((obj, key) => {\n\t\t\t\t\tobj[key] = ipServices[key]\n\t\t\t\t\treturn obj\n\t\t\t\t}\n\t\t\t\t, {})\n\n\t\tlet promises = []\n\n\t\tObject.keys(ipServicesFiltered).forEach(service => {\n\t\t\t// only push if the ipVersion is available for the service\n\t\t\tif (ipServicesFiltered[service][ipVersion]) {\n\t\t\t\t// console.log(`pushing ${service} to promises array with ipVersion ${ipVersion}`)\n\t\t\t\tpromises.push(pmw.getIpFromService(service, ipVersion))\n\t\t\t}\n\t\t})\n\n\t\t// If the promises array is not empty, return the first promise that resolves the fastest\n\t\t// Ignore the promises that reject\n\t\tif (promises.length > 0) {\n\n\t\t\ttry {\n\t\t\t\tconst data = await Promise.any(promises)\n\t\t\t\t// console.log(`The Pixel Manager retrieved the IP address ${data.ip} from ${data.service} using IP version ${data.ipVersion}`)\n\n\t\t\t\t// stop tracking time\n\t\t\t\tconst endTime   = performance.now()\n\t\t\t\tconst timeTaken = (endTime - startTime).toFixed(2)\n\n\t\t\t\tpmw.console.log(`Retrieved the IP address ${data.ip} from ${data.service} which took ${timeTaken} ms`)\n\t\t\t\treturn data.ip\n\t\t\t} catch (error) {\n\t\t\t\t// console.error(error)\n\t\t\t\tpmw.console.log(`Could not retrieve an IP with version ${ipVersion} from any of the services.`)\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t} else {\n\t\t\tpmw.console.log(\"No promises to resolve\")\n\t\t\treturn null\n\t\t}\n\t}\n\n\t/**\n\t * Fetches the IP address from a specified service.\n\t *\n\t * @async\n\t * @param {string} service - The name of the service to fetch the IP from.\n\t * @param {string} [ipVersion=\"any\"] - The version of the IP (e.g., \"any\" for global).\n\t * @returns {Promise<Object>} A promise that resolves to an object containing the IP address, service name, and IP version.\n\t * @throws {Error} Will reject the promise with an error if the IP version is not available for the service, the response from the service is not OK, the returned value from the service is not an IP address, or any other error occurs.\n\t */\n\tpmw.getIpFromService = async (service, ipVersion = \"any\") => {\n\t\ttry {\n\n\t\t\tlet data = {\n\t\t\t\tip       : null,\n\t\t\t\tservice  : service,\n\t\t\t\tipVersion: ipVersion,\n\t\t\t}\n\n\t\t\t// Return reject if the ipVersion is not available for the service\n\t\t\tif (!ipServices[service][ipVersion]) return Promise.reject(new Error(`The IP version ${ipVersion} is not available for the service ${service}`))\n\n\t\t\tpmw.console.log(`Fetching IP from ${service} using IP version ${ipVersion}`)\n\n\t\t\tconst response = await fetchWithTimeout(ipServices[service][ipVersion])\n\n\t\t\tif (!response.ok) {\n\t\t\t\treturn Promise.reject(new Error(`The response from ${service} was not OK. Status: ${response.status}`))\n\t\t\t}\n\n\t\t\tlet serviceResponseData = await response.text()\n\n\t\t\tif (service === \"cloudflare\") {\n\t\t\t\t// Convert key-value pairs to JSON\n\t\t\t\tserviceResponseData = serviceResponseData\n\t\t\t\t\t.trim()\n\t\t\t\t\t.split(\"\\n\")\n\t\t\t\t\t.reduce((obj, pair) => {\n\t\t\t\t\t\tpair = pair.split(\"=\")\n\t\t\t\t\t\treturn (obj[pair[0]] = pair[1]), obj\n\t\t\t\t\t}, {})\n\n\t\t\t\tdata.ip = serviceResponseData.ip\n\t\t\t} else {\n\t\t\t\tdata.ip = serviceResponseData.trim()\n\t\t\t}\n\n\t\t\tif (!isIP(data.ip)) {\n\t\t\t\treturn Promise.reject(new Error(`The returned value from ${service} is not an IP address`))\n\t\t\t}\n\n\t\t\treturn data\n\t\t} catch (error) {\n\t\t\treturn Promise.reject(error)\n\t\t}\n\t}\n\n\t/**\n\t * Cloudflare\n\t *\n\t * Response time: approx. 70ms\n\t * IPv: Returns IPv4 or IPv6 depending on the client\n\t * Dual stack: Doesn't offer dual stack detection\n\t *\n\t * @returns {Promise<*>}\n\t */\n\tconst getIpFromCloudflare = async () => {\n\n\t\tconst response = await fetchWithTimeout(\"https://www.cloudflare.com/cdn-cgi/trace\")\n\t\tlet data       = await response.text()\n\n\t\t// Convert key-value pairs to JSON\n\t\t// https://stackoverflow.com/a/39284735/452587\n\t\tdata = data\n\t\t\t.trim()\n\t\t\t.split(\"\\n\")\n\t\t\t.reduce((obj, pair) => {\n\t\t\t\tpair = pair.split(\"=\")\n\t\t\t\treturn obj[pair[0]] = pair[1], obj\n\t\t\t}, {})\n\n\t\t// return the data.ip not a promise\n\t\treturn data.ip\n\t}\n\n\t/**\n\t * Check if the visitor is NOT allowed to trigger server-to-server events\n\t * This checks both bot user-agent patterns and custom IP exclusion list\n\t *\n\t * @returns {Promise<boolean>} True if the visitor should be blocked\n\t */\n\tpmw.isVisitorNotAllowed = async () => {\n\t\treturn await pmw.isVisitorAllowed() === false\n\t}\n\n\t/**\n\t * Check if the current user agent matches known bot patterns\n\t *\n\t * @returns {boolean} True if the user agent is a bot\n\t */\n\tpmw.isBotUserAgent = () => {\n\t\tconst userAgent = navigator.userAgent || ''\n\t\t\n\t\t// If no user agent, assume it might be a bot\n\t\tif (!userAgent) {\n\t\t\treturn true\n\t\t}\n\n\t\tconst botPatterns = getBotPatterns()\n\n\t\t// Check if user agent matches any bot pattern (case-insensitive)\n\t\tfor (const pattern of botPatterns) {\n\t\t\tif (userAgent.toLowerCase().includes(pattern.toLowerCase())) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\t/**\n\t * Get list of known bot user-agent patterns\n\t *\n\t * @returns {string[]} Array of bot patterns\n\t */\n\tconst getBotPatterns = () => {\n\t\t// Get custom patterns from pmwDataLayer if available\n\t\tlet customPatterns = []\n\t\tif (Array.isArray(pmwDataLayer?.general?.server_2_server?.user_agent_exclude_patterns)) {\n\t\t\tcustomPatterns = pmwDataLayer.general.server_2_server.user_agent_exclude_patterns\n\t\t}\n\n\t\t// Default bot patterns - focusing on legitimate crawlers that identify themselves\n\t\tconst defaultPatterns = [\n\t\t\t// Search engine crawlers\n\t\t\t'Googlebot',\n\t\t\t'Google-InspectionTool',\n\t\t\t'Google-Extended',\n\t\t\t'Storebot-Google',\n\t\t\t'bingbot',\n\t\t\t'BingPreview',\n\t\t\t'msnbot',\n\t\t\t'Slurp',\n\t\t\t'DuckDuckBot',\n\t\t\t'Baiduspider',\n\t\t\t'YandexBot',\n\t\t\t'Sogou',\n\t\t\t\n\t\t\t// Social media crawlers\n\t\t\t'facebookexternalhit',\n\t\t\t'FacebookBot',\n\t\t\t'LinkedInBot',\n\t\t\t'Twitterbot',\n\t\t\t'PinterestBot',\n\t\t\t'TikTokBot',\n\t\t\t'SnapchatAds',\n\t\t\t'DiscordBot',\n\t\t\t'InstagramBot',\n\t\t\t'WhatsApp',\n\t\t\t\n\t\t\t// SEO & Analytics\n\t\t\t'AhrefsBot',\n\t\t\t'SemrushBot',\n\t\t\t'MJ12bot',\n\t\t\t'DotBot',\n\t\t\t'rogerbot',\n\t\t\t\n\t\t\t// Monitoring services\n\t\t\t'UptimeRobot',\n\t\t\t'Pingdom',\n\t\t\t'StatusCake',\n\t\t\t'GTmetrix',\n\t\t\t\n\t\t\t// AI & Research\n\t\t\t'ClaudeBot',\n\t\t\t'GPTBot',\n\t\t\t'ChatGPT',\n\t\t\t'anthropic-ai',\n\t\t\t'CCBot',\n\t\t\t'PerplexityBot',\n\t\t\t\n\t\t\t// Generic patterns\n\t\t\t'crawler',\n\t\t\t'spider',\n\t\t\t'scraper',\n\t\t\t'bot/',\n\t\t\t'/bot',\n\t\t\t'bot-',\n\t\t]\n\n\t\treturn defaultPatterns.concat(customPatterns)\n\t}\n\n\t/**\n\t * Check if an IP address is in CIDR notation\n\t *\n\t * @param {string} ipName - The IP or CIDR notation to check\n\t * @returns {boolean} True if the string contains CIDR notation\n\t */\n\tconst isCidr = (ipName) => {\n\t\treturn ipName.includes('/')\n\t}\n\n\t/**\n\t * Check if an IP address is on the custom exclusion list\n\t *\n\t * @param {string} ip - The IP address to check\n\t * @returns {boolean} True if the IP is on the exclusion list\n\t */\n\tconst isOnIpExclusionList = (ip) => {\n\t\tconst ipExcludeList = pmwDataLayer?.general?.server_2_server?.ip_exclude_list || []\n\n\t\tfor (const ipName of ipExcludeList) {\n\t\t\tif (isCidr(ipName)) {\n\t\t\t\t// Check CIDR range\n\t\t\t\tif (isInSubnet.isInSubnet(ip, ipName)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t} else if (ip === ipName) {\n\t\t\t\t// Exact IP match\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n}(window.pmw = window.pmw || {}, jQuery))\n","// https://stackoverflow.com/a/70870895/4688612\nexport const getLocationByTimeZone = () => {\n\n\tconst timezones = {\n\t\t\"Africa/Abidjan\"                : [\"CI\", \"BF\", \"GH\", \"GM\", \"GN\", \"ML\", \"MR\", \"SH\", \"SL\", \"SN\", \"TG\"],\n\t\t\"Africa/Accra\"                  : [\"GH\"],\n\t\t\"Africa/Addis_Ababa\"            : [\"ET\"],\n\t\t\"Africa/Algiers\"                : [\"DZ\"],\n\t\t\"Africa/Asmara\"                 : [\"ER\"],\n\t\t\"Africa/Asmera\"                 : [\"ER\"],\n\t\t\"Africa/Bamako\"                 : [\"ML\"],\n\t\t\"Africa/Bangui\"                 : [\"CF\"],\n\t\t\"Africa/Banjul\"                 : [\"GM\"],\n\t\t\"Africa/Bissau\"                 : [\"GW\"],\n\t\t\"Africa/Blantyre\"               : [\"MW\"],\n\t\t\"Africa/Brazzaville\"            : [\"CG\"],\n\t\t\"Africa/Bujumbura\"              : [\"BI\"],\n\t\t\"Africa/Cairo\"                  : [\"EG\"],\n\t\t\"Africa/Casablanca\"             : [\"MA\"],\n\t\t\"Africa/Ceuta\"                  : [\"ES\"],\n\t\t\"Africa/Conakry\"                : [\"GN\"],\n\t\t\"Africa/Dakar\"                  : [\"SN\"],\n\t\t\"Africa/Dar_es_Salaam\"          : [\"TZ\"],\n\t\t\"Africa/Djibouti\"               : [\"DJ\"],\n\t\t\"Africa/Douala\"                 : [\"CM\"],\n\t\t\"Africa/El_Aaiun\"               : [\"EH\"],\n\t\t\"Africa/Freetown\"               : [\"SL\"],\n\t\t\"Africa/Gaborone\"               : [\"BW\"],\n\t\t\"Africa/Harare\"                 : [\"ZW\"],\n\t\t\"Africa/Johannesburg\"           : [\"ZA\", \"LS\", \"SZ\"],\n\t\t\"Africa/Juba\"                   : [\"SS\"],\n\t\t\"Africa/Kampala\"                : [\"UG\"],\n\t\t\"Africa/Khartoum\"               : [\"SD\"],\n\t\t\"Africa/Kigali\"                 : [\"RW\"],\n\t\t\"Africa/Kinshasa\"               : [\"CD\"],\n\t\t\"Africa/Lagos\"                  : [\"NG\", \"AO\", \"BJ\", \"CD\", \"CF\", \"CG\", \"CM\", \"GA\", \"GQ\", \"NE\"],\n\t\t\"Africa/Libreville\"             : [\"GA\"],\n\t\t\"Africa/Lome\"                   : [\"TG\"],\n\t\t\"Africa/Luanda\"                 : [\"AO\"],\n\t\t\"Africa/Lubumbashi\"             : [\"CD\"],\n\t\t\"Africa/Lusaka\"                 : [\"ZM\"],\n\t\t\"Africa/Malabo\"                 : [\"GQ\"],\n\t\t\"Africa/Maputo\"                 : [\"MZ\", \"BI\", \"BW\", \"CD\", \"MW\", \"RW\", \"ZM\", \"ZW\"],\n\t\t\"Africa/Maseru\"                 : [\"LS\"],\n\t\t\"Africa/Mbabane\"                : [\"SZ\"],\n\t\t\"Africa/Mogadishu\"              : [\"SO\"],\n\t\t\"Africa/Monrovia\"               : [\"LR\"],\n\t\t\"Africa/Nairobi\"                : [\"KE\", \"DJ\", \"ER\", \"ET\", \"KM\", \"MG\", \"SO\", \"TZ\", \"UG\", \"YT\"],\n\t\t\"Africa/Ndjamena\"               : [\"TD\"],\n\t\t\"Africa/Niamey\"                 : [\"NE\"],\n\t\t\"Africa/Nouakchott\"             : [\"MR\"],\n\t\t\"Africa/Ouagadougou\"            : [\"BF\"],\n\t\t\"Africa/Porto-Novo\"             : [\"BJ\"],\n\t\t\"Africa/Sao_Tome\"               : [\"ST\"],\n\t\t\"Africa/Timbuktu\"               : [\"ML\"],\n\t\t\"Africa/Tripoli\"                : [\"LY\"],\n\t\t\"Africa/Tunis\"                  : [\"TN\"],\n\t\t\"Africa/Windhoek\"               : [\"NA\"],\n\t\t\"America/Adak\"                  : [\"US\"],\n\t\t\"America/Anchorage\"             : [\"US\"],\n\t\t\"America/Anguilla\"              : [\"AI\"],\n\t\t\"America/Antigua\"               : [\"AG\"],\n\t\t\"America/Araguaina\"             : [\"BR\"],\n\t\t\"America/Argentina/Buenos_Aires\": [\"AR\"],\n\t\t\"America/Argentina/Catamarca\"   : [\"AR\"],\n\t\t\"America/Argentina/Cordoba\"     : [\"AR\"],\n\t\t\"America/Argentina/Jujuy\"       : [\"AR\"],\n\t\t\"America/Argentina/La_Rioja\"    : [\"AR\"],\n\t\t\"America/Argentina/Mendoza\"     : [\"AR\"],\n\t\t\"America/Argentina/Rio_Gallegos\": [\"AR\"],\n\t\t\"America/Argentina/Salta\"       : [\"AR\"],\n\t\t\"America/Argentina/San_Juan\"    : [\"AR\"],\n\t\t\"America/Argentina/San_Luis\"    : [\"AR\"],\n\t\t\"America/Argentina/Tucuman\"     : [\"AR\"],\n\t\t\"America/Argentina/Ushuaia\"     : [\"AR\"],\n\t\t\"America/Aruba\"                 : [\"AW\"],\n\t\t\"America/Asuncion\"              : [\"PY\"],\n\t\t\"America/Atikokan\"              : [\"CA\"],\n\t\t\"America/Bahia\"                 : [\"BR\"],\n\t\t\"America/Bahia_Banderas\"        : [\"MX\"],\n\t\t\"America/Barbados\"              : [\"BB\"],\n\t\t\"America/Belem\"                 : [\"BR\"],\n\t\t\"America/Belize\"                : [\"BZ\"],\n\t\t\"America/Blanc-Sablon\"          : [\"CA\"],\n\t\t\"America/Boa_Vista\"             : [\"BR\"],\n\t\t\"America/Bogota\"                : [\"CO\"],\n\t\t\"America/Boise\"                 : [\"US\"],\n\t\t\"America/Cambridge_Bay\"         : [\"CA\"],\n\t\t\"America/Campo_Grande\"          : [\"BR\"],\n\t\t\"America/Cancun\"                : [\"MX\"],\n\t\t\"America/Caracas\"               : [\"VE\"],\n\t\t\"America/Cayenne\"               : [\"GF\"],\n\t\t\"America/Cayman\"                : [\"KY\"],\n\t\t\"America/Chicago\"               : [\"US\"],\n\t\t\"America/Chihuahua\"             : [\"MX\"],\n\t\t\"America/Coral_Harbour\"         : [\"CA\"],\n\t\t\"America/Costa_Rica\"            : [\"CR\"],\n\t\t\"America/Creston\"               : [\"CA\"],\n\t\t\"America/Cuiaba\"                : [\"BR\"],\n\t\t\"America/Curacao\"               : [\"CW\"],\n\t\t\"America/Danmarkshavn\"          : [\"GL\"],\n\t\t\"America/Dawson\"                : [\"CA\"],\n\t\t\"America/Dawson_Creek\"          : [\"CA\"],\n\t\t\"America/Denver\"                : [\"US\"],\n\t\t\"America/Detroit\"               : [\"US\"],\n\t\t\"America/Dominica\"              : [\"DM\"],\n\t\t\"America/Edmonton\"              : [\"CA\"],\n\t\t\"America/Eirunepe\"              : [\"BR\"],\n\t\t\"America/El_Salvador\"           : [\"SV\"],\n\t\t\"America/Fort_Nelson\"           : [\"CA\"],\n\t\t\"America/Fortaleza\"             : [\"BR\"],\n\t\t\"America/Glace_Bay\"             : [\"CA\"],\n\t\t\"America/Goose_Bay\"             : [\"CA\"],\n\t\t\"America/Grand_Turk\"            : [\"TC\"],\n\t\t\"America/Grenada\"               : [\"GD\"],\n\t\t\"America/Guadeloupe\"            : [\"GP\"],\n\t\t\"America/Guatemala\"             : [\"GT\"],\n\t\t\"America/Guayaquil\"             : [\"EC\"],\n\t\t\"America/Guyana\"                : [\"GY\"],\n\t\t\"America/Halifax\"               : [\"CA\"],\n\t\t\"America/Havana\"                : [\"CU\"],\n\t\t\"America/Hermosillo\"            : [\"MX\"],\n\t\t\"America/Indiana/Indianapolis\"  : [\"US\"],\n\t\t\"America/Indiana/Knox\"          : [\"US\"],\n\t\t\"America/Indiana/Marengo\"       : [\"US\"],\n\t\t\"America/Indiana/Petersburg\"    : [\"US\"],\n\t\t\"America/Indiana/Tell_City\"     : [\"US\"],\n\t\t\"America/Indiana/Vevay\"         : [\"US\"],\n\t\t\"America/Indiana/Vincennes\"     : [\"US\"],\n\t\t\"America/Indiana/Winamac\"       : [\"US\"],\n\t\t\"America/Inuvik\"                : [\"CA\"],\n\t\t\"America/Iqaluit\"               : [\"CA\"],\n\t\t\"America/Jamaica\"               : [\"JM\"],\n\t\t\"America/Juneau\"                : [\"US\"],\n\t\t\"America/Kentucky/Louisville\"   : [\"US\"],\n\t\t\"America/Kentucky/Monticello\"   : [\"US\"],\n\t\t\"America/Kralendijk\"            : [\"BQ\"],\n\t\t\"America/La_Paz\"                : [\"BO\"],\n\t\t\"America/Lima\"                  : [\"PE\"],\n\t\t\"America/Los_Angeles\"           : [\"US\"],\n\t\t\"America/Lower_Princes\"         : [\"SX\"],\n\t\t\"America/Maceio\"                : [\"BR\"],\n\t\t\"America/Managua\"               : [\"NI\"],\n\t\t\"America/Manaus\"                : [\"BR\"],\n\t\t\"America/Marigot\"               : [\"MF\"],\n\t\t\"America/Martinique\"            : [\"MQ\"],\n\t\t\"America/Matamoros\"             : [\"MX\"],\n\t\t\"America/Mazatlan\"              : [\"MX\"],\n\t\t\"America/Menominee\"             : [\"US\"],\n\t\t\"America/Merida\"                : [\"MX\"],\n\t\t\"America/Metlakatla\"            : [\"US\"],\n\t\t\"America/Mexico_City\"           : [\"MX\"],\n\t\t\"America/Miquelon\"              : [\"PM\"],\n\t\t\"America/Moncton\"               : [\"CA\"],\n\t\t\"America/Monterrey\"             : [\"MX\"],\n\t\t\"America/Montevideo\"            : [\"UY\"],\n\t\t\"America/Montreal\"              : [\"CA\"],\n\t\t\"America/Montserrat\"            : [\"MS\"],\n\t\t\"America/Nassau\"                : [\"BS\"],\n\t\t\"America/New_York\"              : [\"US\"],\n\t\t\"America/Nipigon\"               : [\"CA\"],\n\t\t\"America/Nome\"                  : [\"US\"],\n\t\t\"America/Noronha\"               : [\"BR\"],\n\t\t\"America/North_Dakota/Beulah\"   : [\"US\"],\n\t\t\"America/North_Dakota/Center\"   : [\"US\"],\n\t\t\"America/North_Dakota/New_Salem\": [\"US\"],\n\t\t\"America/Nuuk\"                  : [\"GL\"],\n\t\t\"America/Ojinaga\"               : [\"MX\"],\n\t\t\"America/Panama\"                : [\"PA\", \"CA\", \"KY\"],\n\t\t\"America/Pangnirtung\"           : [\"CA\"],\n\t\t\"America/Paramaribo\"            : [\"SR\"],\n\t\t\"America/Phoenix\"               : [\"US\", \"CA\"],\n\t\t\"America/Port-au-Prince\"        : [\"HT\"],\n\t\t\"America/Port_of_Spain\"         : [\"TT\"],\n\t\t\"America/Porto_Velho\"           : [\"BR\"],\n\t\t\"America/Puerto_Rico\"           : [\"PR\", \"AG\", \"CA\", \"AI\", \"AW\", \"BL\", \"BQ\", \"CW\", \"DM\", \"GD\", \"GP\", \"KN\", \"LC\", \"MF\", \"MS\", \"SX\", \"TT\", \"VC\", \"VG\", \"VI\"],\n\t\t\"America/Punta_Arenas\"          : [\"CL\"],\n\t\t\"America/Rainy_River\"           : [\"CA\"],\n\t\t\"America/Rankin_Inlet\"          : [\"CA\"],\n\t\t\"America/Recife\"                : [\"BR\"],\n\t\t\"America/Regina\"                : [\"CA\"],\n\t\t\"America/Resolute\"              : [\"CA\"],\n\t\t\"America/Rio_Branco\"            : [\"BR\"],\n\t\t\"America/Santarem\"              : [\"BR\"],\n\t\t\"America/Santiago\"              : [\"CL\"],\n\t\t\"America/Santo_Domingo\"         : [\"DO\"],\n\t\t\"America/Sao_Paulo\"             : [\"BR\"],\n\t\t\"America/Scoresbysund\"          : [\"GL\"],\n\t\t\"America/Sitka\"                 : [\"US\"],\n\t\t\"America/St_Barthelemy\"         : [\"BL\"],\n\t\t\"America/St_Johns\"              : [\"CA\"],\n\t\t\"America/St_Kitts\"              : [\"KN\"],\n\t\t\"America/St_Lucia\"              : [\"LC\"],\n\t\t\"America/St_Thomas\"             : [\"VI\"],\n\t\t\"America/St_Vincent\"            : [\"VC\"],\n\t\t\"America/Swift_Current\"         : [\"CA\"],\n\t\t\"America/Tegucigalpa\"           : [\"HN\"],\n\t\t\"America/Thule\"                 : [\"GL\"],\n\t\t\"America/Thunder_Bay\"           : [\"CA\"],\n\t\t\"America/Tijuana\"               : [\"MX\"],\n\t\t\"America/Toronto\"               : [\"CA\", \"BS\"],\n\t\t\"America/Tortola\"               : [\"VG\"],\n\t\t\"America/Vancouver\"             : [\"CA\"],\n\t\t\"America/Virgin\"                : [\"VI\"],\n\t\t\"America/Whitehorse\"            : [\"CA\"],\n\t\t\"America/Winnipeg\"              : [\"CA\"],\n\t\t\"America/Yakutat\"               : [\"US\"],\n\t\t\"America/Yellowknife\"           : [\"CA\"],\n\t\t\"Antarctica/Casey\"              : [\"AQ\"],\n\t\t\"Antarctica/Davis\"              : [\"AQ\"],\n\t\t\"Antarctica/DumontDUrville\"     : [\"AQ\"],\n\t\t\"Antarctica/Macquarie\"          : [\"AU\"],\n\t\t\"Antarctica/Mawson\"             : [\"AQ\"],\n\t\t\"Antarctica/McMurdo\"            : [\"AQ\"],\n\t\t\"Antarctica/Palmer\"             : [\"AQ\"],\n\t\t\"Antarctica/Rothera\"            : [\"AQ\"],\n\t\t\"Antarctica/South_Pole\"         : [\"AQ\"],\n\t\t\"Antarctica/Syowa\"              : [\"AQ\"],\n\t\t\"Antarctica/Troll\"              : [\"AQ\"],\n\t\t\"Antarctica/Vostok\"             : [\"AQ\"],\n\t\t\"Arctic/Longyearbyen\"           : [\"SJ\"],\n\t\t\"Asia/Aden\"                     : [\"YE\"],\n\t\t\"Asia/Almaty\"                   : [\"KZ\"],\n\t\t\"Asia/Amman\"                    : [\"JO\"],\n\t\t\"Asia/Anadyr\"                   : [\"RU\"],\n\t\t\"Asia/Aqtau\"                    : [\"KZ\"],\n\t\t\"Asia/Aqtobe\"                   : [\"KZ\"],\n\t\t\"Asia/Ashgabat\"                 : [\"TM\"],\n\t\t\"Asia/Atyrau\"                   : [\"KZ\"],\n\t\t\"Asia/Baghdad\"                  : [\"IQ\"],\n\t\t\"Asia/Bahrain\"                  : [\"BH\"],\n\t\t\"Asia/Baku\"                     : [\"AZ\"],\n\t\t\"Asia/Bangkok\"                  : [\"TH\", \"KH\", \"LA\", \"VN\"],\n\t\t\"Asia/Barnaul\"                  : [\"RU\"],\n\t\t\"Asia/Beirut\"                   : [\"LB\"],\n\t\t\"Asia/Bishkek\"                  : [\"KG\"],\n\t\t\"Asia/Brunei\"                   : [\"BN\"],\n\t\t\"Asia/Chita\"                    : [\"RU\"],\n\t\t\"Asia/Choibalsan\"               : [\"MN\"],\n\t\t\"Asia/Colombo\"                  : [\"LK\"],\n\t\t\"Asia/Damascus\"                 : [\"SY\"],\n\t\t\"Asia/Dhaka\"                    : [\"BD\"],\n\t\t\"Asia/Dili\"                     : [\"TL\"],\n\t\t\"Asia/Dubai\"                    : [\"AE\", \"OM\"],\n\t\t\"Asia/Dushanbe\"                 : [\"TJ\"],\n\t\t\"Asia/Famagusta\"                : [\"CY\"],\n\t\t\"Asia/Gaza\"                     : [\"PS\"],\n\t\t\"Asia/Hebron\"                   : [\"PS\"],\n\t\t\"Asia/Ho_Chi_Minh\"              : [\"VN\"],\n\t\t\"Asia/Hong_Kong\"                : [\"HK\"],\n\t\t\"Asia/Hovd\"                     : [\"MN\"],\n\t\t\"Asia/Irkutsk\"                  : [\"RU\"],\n\t\t\"Asia/Jakarta\"                  : [\"ID\"],\n\t\t\"Asia/Jayapura\"                 : [\"ID\"],\n\t\t\"Asia/Jerusalem\"                : [\"IL\"],\n\t\t\"Asia/Kabul\"                    : [\"AF\"],\n\t\t\"Asia/Kamchatka\"                : [\"RU\"],\n\t\t\"Asia/Karachi\"                  : [\"PK\"],\n\t\t\"Asia/Kathmandu\"                : [\"NP\"],\n\t\t\"Asia/Khandyga\"                 : [\"RU\"],\n\t\t\"Asia/Kolkata\"                  : [\"IN\"],\n\t\t\"Asia/Krasnoyarsk\"              : [\"RU\"],\n\t\t\"Asia/Kuala_Lumpur\"             : [\"MY\"],\n\t\t\"Asia/Kuching\"                  : [\"MY\"],\n\t\t\"Asia/Kuwait\"                   : [\"KW\"],\n\t\t\"Asia/Macau\"                    : [\"MO\"],\n\t\t\"Asia/Magadan\"                  : [\"RU\"],\n\t\t\"Asia/Makassar\"                 : [\"ID\"],\n\t\t\"Asia/Manila\"                   : [\"PH\"],\n\t\t\"Asia/Muscat\"                   : [\"OM\"],\n\t\t\"Asia/Nicosia\"                  : [\"CY\"],\n\t\t\"Asia/Novokuznetsk\"             : [\"RU\"],\n\t\t\"Asia/Novosibirsk\"              : [\"RU\"],\n\t\t\"Asia/Omsk\"                     : [\"RU\"],\n\t\t\"Asia/Oral\"                     : [\"KZ\"],\n\t\t\"Asia/Phnom_Penh\"               : [\"KH\"],\n\t\t\"Asia/Pontianak\"                : [\"ID\"],\n\t\t\"Asia/Pyongyang\"                : [\"KP\"],\n\t\t\"Asia/Qatar\"                    : [\"QA\", \"BH\"],\n\t\t\"Asia/Qostanay\"                 : [\"KZ\"],\n\t\t\"Asia/Qyzylorda\"                : [\"KZ\"],\n\t\t\"Asia/Riyadh\"                   : [\"SA\", \"AQ\", \"KW\", \"YE\"],\n\t\t\"Asia/Sakhalin\"                 : [\"RU\"],\n\t\t\"Asia/Samarkand\"                : [\"UZ\"],\n\t\t\"Asia/Seoul\"                    : [\"KR\"],\n\t\t\"Asia/Shanghai\"                 : [\"CN\"],\n\t\t\"Asia/Singapore\"                : [\"SG\", \"MY\"],\n\t\t\"Asia/Srednekolymsk\"            : [\"RU\"],\n\t\t\"Asia/Taipei\"                   : [\"TW\"],\n\t\t\"Asia/Tashkent\"                 : [\"UZ\"],\n\t\t\"Asia/Tbilisi\"                  : [\"GE\"],\n\t\t\"Asia/Tehran\"                   : [\"IR\"],\n\t\t\"Asia/Thimphu\"                  : [\"BT\"],\n\t\t\"Asia/Tokyo\"                    : [\"JP\"],\n\t\t\"Asia/Tomsk\"                    : [\"RU\"],\n\t\t\"Asia/Ulaanbaatar\"              : [\"MN\"],\n\t\t\"Asia/Urumqi\"                   : [\"CN\"],\n\t\t\"Asia/Ust-Nera\"                 : [\"RU\"],\n\t\t\"Asia/Vientiane\"                : [\"LA\"],\n\t\t\"Asia/Vladivostok\"              : [\"RU\"],\n\t\t\"Asia/Yakutsk\"                  : [\"RU\"],\n\t\t\"Asia/Yangon\"                   : [\"MM\"],\n\t\t\"Asia/Yekaterinburg\"            : [\"RU\"],\n\t\t\"Asia/Yerevan\"                  : [\"AM\"],\n\t\t\"Atlantic/Azores\"               : [\"PT\"],\n\t\t\"Atlantic/Bermuda\"              : [\"BM\"],\n\t\t\"Atlantic/Canary\"               : [\"ES\"],\n\t\t\"Atlantic/Cape_Verde\"           : [\"CV\"],\n\t\t\"Atlantic/Faroe\"                : [\"FO\"],\n\t\t\"Atlantic/Jan_Mayen\"            : [\"SJ\"],\n\t\t\"Atlantic/Madeira\"              : [\"PT\"],\n\t\t\"Atlantic/Reykjavik\"            : [\"IS\"],\n\t\t\"Atlantic/South_Georgia\"        : [\"GS\"],\n\t\t\"Atlantic/St_Helena\"            : [\"SH\"],\n\t\t\"Atlantic/Stanley\"              : [\"FK\"],\n\t\t\"Australia/Adelaide\"            : [\"AU\"],\n\t\t\"Australia/Brisbane\"            : [\"AU\"],\n\t\t\"Australia/Broken_Hill\"         : [\"AU\"],\n\t\t\"Australia/Darwin\"              : [\"AU\"],\n\t\t\"Australia/Eucla\"               : [\"AU\"],\n\t\t\"Australia/Hobart\"              : [\"AU\"],\n\t\t\"Australia/Lindeman\"            : [\"AU\"],\n\t\t\"Australia/Lord_Howe\"           : [\"AU\"],\n\t\t\"Australia/Melbourne\"           : [\"AU\"],\n\t\t\"Australia/Perth\"               : [\"AU\"],\n\t\t\"Australia/Sydney\"              : [\"AU\"],\n\t\t\"Canada/Eastern\"                : [\"CA\"],\n\t\t\"Europe/Amsterdam\"              : [\"NL\"],\n\t\t\"Europe/Andorra\"                : [\"AD\"],\n\t\t\"Europe/Astrakhan\"              : [\"RU\"],\n\t\t\"Europe/Athens\"                 : [\"GR\"],\n\t\t\"Europe/Belfast\"                : [\"GB\"],\n\t\t\"Europe/Belgrade\"               : [\"RS\", \"BA\", \"HR\", \"ME\", \"MK\", \"SI\"],\n\t\t\"Europe/Berlin\"                 : [\"DE\"],\n\t\t\"Europe/Bratislava\"             : [\"SK\"],\n\t\t\"Europe/Brussels\"               : [\"BE\"],\n\t\t\"Europe/Bucharest\"              : [\"RO\"],\n\t\t\"Europe/Budapest\"               : [\"HU\"],\n\t\t\"Europe/Busingen\"               : [\"DE\"],\n\t\t\"Europe/Chisinau\"               : [\"MD\"],\n\t\t\"Europe/Copenhagen\"             : [\"DK\"],\n\t\t\"Europe/Dublin\"                 : [\"IE\"],\n\t\t\"Europe/Gibraltar\"              : [\"GI\"],\n\t\t\"Europe/Guernsey\"               : [\"GG\"],\n\t\t\"Europe/Helsinki\"               : [\"FI\", \"AX\"],\n\t\t\"Europe/Isle_of_Man\"            : [\"IM\"],\n\t\t\"Europe/Istanbul\"               : [\"TR\"],\n\t\t\"Europe/Jersey\"                 : [\"JE\"],\n\t\t\"Europe/Kaliningrad\"            : [\"RU\"],\n\t\t\"Europe/Kiev\"                   : [\"UA\"],\n\t\t\"Europe/Kirov\"                  : [\"RU\"],\n\t\t\"Europe/Lisbon\"                 : [\"PT\"],\n\t\t\"Europe/Ljubljana\"              : [\"SI\"],\n\t\t\"Europe/London\"                 : [\"GB\", \"GG\", \"IM\", \"JE\"],\n\t\t\"Europe/Luxembourg\"             : [\"LU\"],\n\t\t\"Europe/Madrid\"                 : [\"ES\"],\n\t\t\"Europe/Malta\"                  : [\"MT\"],\n\t\t\"Europe/Mariehamn\"              : [\"AX\"],\n\t\t\"Europe/Minsk\"                  : [\"BY\"],\n\t\t\"Europe/Monaco\"                 : [\"MC\"],\n\t\t\"Europe/Moscow\"                 : [\"RU\"],\n\t\t\"Europe/Oslo\"                   : [\"NO\", \"SJ\", \"BV\"],\n\t\t\"Europe/Paris\"                  : [\"FR\"],\n\t\t\"Europe/Podgorica\"              : [\"ME\"],\n\t\t\"Europe/Prague\"                 : [\"CZ\", \"SK\"],\n\t\t\"Europe/Riga\"                   : [\"LV\"],\n\t\t\"Europe/Rome\"                   : [\"IT\", \"SM\", \"VA\"],\n\t\t\"Europe/Samara\"                 : [\"RU\"],\n\t\t\"Europe/San_Marino\"             : [\"SM\"],\n\t\t\"Europe/Sarajevo\"               : [\"BA\"],\n\t\t\"Europe/Saratov\"                : [\"RU\"],\n\t\t\"Europe/Simferopol\"             : [\"RU\", \"UA\"],\n\t\t\"Europe/Skopje\"                 : [\"MK\"],\n\t\t\"Europe/Sofia\"                  : [\"BG\"],\n\t\t\"Europe/Stockholm\"              : [\"SE\"],\n\t\t\"Europe/Tallinn\"                : [\"EE\"],\n\t\t\"Europe/Tirane\"                 : [\"AL\"],\n\t\t\"Europe/Ulyanovsk\"              : [\"RU\"],\n\t\t\"Europe/Uzhgorod\"               : [\"UA\"],\n\t\t\"Europe/Vaduz\"                  : [\"LI\"],\n\t\t\"Europe/Vatican\"                : [\"VA\"],\n\t\t\"Europe/Vienna\"                 : [\"AT\"],\n\t\t\"Europe/Vilnius\"                : [\"LT\"],\n\t\t\"Europe/Volgograd\"              : [\"RU\"],\n\t\t\"Europe/Warsaw\"                 : [\"PL\"],\n\t\t\"Europe/Zagreb\"                 : [\"HR\"],\n\t\t\"Europe/Zaporozhye\"             : [\"UA\"],\n\t\t\"Europe/Zurich\"                 : [\"CH\", \"DE\", \"LI\"],\n\t\t\"GB\"                            : [\"GB\"],\n\t\t\"GB-Eire\"                       : [\"GB\"],\n\t\t\"Indian/Antananarivo\"           : [\"MG\"],\n\t\t\"Indian/Chagos\"                 : [\"IO\"],\n\t\t\"Indian/Christmas\"              : [\"CX\"],\n\t\t\"Indian/Cocos\"                  : [\"CC\"],\n\t\t\"Indian/Comoro\"                 : [\"KM\"],\n\t\t\"Indian/Kerguelen\"              : [\"TF\", \"HM\"],\n\t\t\"Indian/Mahe\"                   : [\"SC\"],\n\t\t\"Indian/Maldives\"               : [\"MV\"],\n\t\t\"Indian/Mauritius\"              : [\"MU\"],\n\t\t\"Indian/Mayotte\"                : [\"YT\"],\n\t\t\"Indian/Reunion\"                : [\"RE\", \"TF\"],\n\t\t\"NZ\"                            : [\"NZ\"],\n\t\t\"Pacific/Apia\"                  : [\"WS\"],\n\t\t\"Pacific/Auckland\"              : [\"NZ\", \"AQ\"],\n\t\t\"Pacific/Bougainville\"          : [\"PG\"],\n\t\t\"Pacific/Chatham\"               : [\"NZ\"],\n\t\t\"Pacific/Chuuk\"                 : [\"FM\"],\n\t\t\"Pacific/Easter\"                : [\"CL\"],\n\t\t\"Pacific/Efate\"                 : [\"VU\"],\n\t\t\"Pacific/Fakaofo\"               : [\"TK\"],\n\t\t\"Pacific/Fiji\"                  : [\"FJ\"],\n\t\t\"Pacific/Funafuti\"              : [\"TV\"],\n\t\t\"Pacific/Galapagos\"             : [\"EC\"],\n\t\t\"Pacific/Gambier\"               : [\"PF\"],\n\t\t\"Pacific/Guadalcanal\"           : [\"SB\"],\n\t\t\"Pacific/Guam\"                  : [\"GU\", \"MP\"],\n\t\t\"Pacific/Honolulu\"              : [\"US\", \"UM\"],\n\t\t\"Pacific/Johnston\"              : [\"UM\"],\n\t\t\"Pacific/Kanton\"                : [\"KI\"],\n\t\t\"Pacific/Kiritimati\"            : [\"KI\"],\n\t\t\"Pacific/Kosrae\"                : [\"FM\"],\n\t\t\"Pacific/Kwajalein\"             : [\"MH\"],\n\t\t\"Pacific/Majuro\"                : [\"MH\"],\n\t\t\"Pacific/Marquesas\"             : [\"PF\"],\n\t\t\"Pacific/Midway\"                : [\"UM\"],\n\t\t\"Pacific/Nauru\"                 : [\"NR\"],\n\t\t\"Pacific/Niue\"                  : [\"NU\"],\n\t\t\"Pacific/Norfolk\"               : [\"NF\"],\n\t\t\"Pacific/Noumea\"                : [\"NC\"],\n\t\t\"Pacific/Pago_Pago\"             : [\"AS\", \"UM\"],\n\t\t\"Pacific/Palau\"                 : [\"PW\"],\n\t\t\"Pacific/Pitcairn\"              : [\"PN\"],\n\t\t\"Pacific/Pohnpei\"               : [\"FM\"],\n\t\t\"Pacific/Port_Moresby\"          : [\"PG\", \"AQ\"],\n\t\t\"Pacific/Rarotonga\"             : [\"CK\"],\n\t\t\"Pacific/Saipan\"                : [\"MP\"],\n\t\t\"Pacific/Samoa\"                 : [\"WS\"],\n\t\t\"Pacific/Tahiti\"                : [\"PF\"],\n\t\t\"Pacific/Tarawa\"                : [\"KI\"],\n\t\t\"Pacific/Tongatapu\"             : [\"TO\"],\n\t\t\"Pacific/Wake\"                  : [\"UM\"],\n\t\t\"Pacific/Wallis\"                : [\"WF\"],\n\t\t\"Singapore\"                     : [\"SG\"],\n\t\t\"US/Arizona\"                    : [\"US\"],\n\t\t\"US/Hawaii\"                     : [\"US\"],\n\t\t\"US/Samoa\"                      : [\"WS\"],\n\t}\n\n\tconst timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\n\tif (timezone === \"\" || !timezone) {\n\t\treturn null\n\t}\n\n\tlet geoLocation = {\n\t\tcountryCode: timezones[timezone][0].toUpperCase(),\n\t}\n\n\t// if the timezone is equals \"America/Los_Angeles\" then add the regionCode \"US-CA\"\n\tif (timezone === \"America/Los_Angeles\") {\n\t\tgeoLocation.regionCode = \"US-CA\"\n\t}\n\n\tif (timezone === \"Europe/Zurich\") {\n\t\tgeoLocation.regionCode = \"CH-ZH\"\n\t}\n\n\treturn geoLocation\n}\n\n\n\n\n",null,"/**\n * Register event listeners\n */\n\n\n/**\n * add_to_cart event\n *\n * WC is inconsistent with events that emit add-to-cart events.\n * adding_to_cart and added_to_are legacy events. Also, they only work\n * on Ajax buttons on shop pages.\n *\n * Never add document or body selectors.\n * The document selector doesn't work.\n * The body selector will cause the events to fire twice and other erratic behavior if used along with other selectors.\n */\nconst addToCartSelectorsArray = [\n\t// \"document\",\n\t// \"body\",\n\t\".add_to_cart_button:not(.product_type_variable)\",\n\t\".ajax_add_to_cart\",\n\t\".single_add_to_cart_button\",\n];\n\nconst addToCartSelectors = pmw.prepareSelectors(addToCartSelectorsArray, \"addToCart\");\n\njQuery(addToCartSelectors).on(\"click adding_to_cart\", (event, data) => {\n\n\t// console.log(\"add_to_cart event fired at: \" + new Date().getTime())\n\t// console.log('add to cart data', data)\n\t// console.log('add to cart event', event)\n\t// console.log('add to cart jQuery(event.target.dataset)', jQuery(event.target.dataset))\n\t// console.log(\"add to cart event.target.dataset\", event.target.dataset)\n\t// console.log(\"add to cart event.target.dataset.quantity\", event.target.dataset.quantity)\n\t// console.log(\"add to cart event.target.dataset.product_id\", event.target.dataset.product_id)\n\n\ttry {\n\n\t\t// console.log(\"add_to_cart event detected\")\n\n\t\tlet quantity  = event?.target?.dataset?.quantity ? event.target.dataset.quantity : null;\n\t\tlet productId = event?.target?.dataset?.product_id ? event.target.dataset.product_id : event?.target?.value ? event.target.value : null;\n\n\t\t// let quantity  = event.target.dataset.quantity ? event.target.dataset.quantity : 1\n\t\t// let productId = event.target.dataset.product_id ? event.target.dataset.product_id : null\n\n\t\t// Only process on product pages\n\t\tif (pmwDataLayer.shop.page_type === \"product\") {\n\n\t\t\t// First process related and upsell products\n\t\t\tif (\n\t\t\t\ttypeof jQuery(event.currentTarget).attr(\"href\") !== \"undefined\"\n\t\t\t\t&& jQuery(event.currentTarget).attr(\"href\").includes(\"add-to-cart\")\n\t\t\t) {\n\n\t\t\t\tif (!productId) {\n\t\t\t\t\tproductId = jQuery(event.currentTarget).data(\"product_id\");\n\t\t\t\t}\n\n\t\t\t\tpmw.addProductToCart(productId, 1);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If is simple product\n\t\t\tif (pmwDataLayer.shop.product_type === \"simple\") {\n\n\t\t\t\tif (quantity === null) {\n\t\t\t\t\tquantity = Number(jQuery(\".input-text.qty\").val()) ? Number(jQuery(\".input-text.qty\").val()) : 1;\n\t\t\t\t}\n\n\t\t\t\tif (!productId) {\n\t\t\t\t\tproductId = jQuery(event.currentTarget).val();\n\t\t\t\t}\n\n\t\t\t\t// Fallback if the body selector is used\n\t\t\t\tif (!productId) {\n\t\t\t\t\t// get the product ID from the element that has the class .product\n\t\t\t\t\t// that element will also have an ID that start with product- and ends with the product ID\n\t\t\t\t\t// example: product-123\n\t\t\t\t\t// save the product ID in the variable productId\n\t\t\t\t\tproductId = jQuery(\".product\").attr(\"id\").replace(\"product-\", \"\");\n\t\t\t\t}\n\n\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If is variable product or variable-subscription\n\t\t\tif ([\"variable\", \"variable-subscription\"].indexOf(pmwDataLayer.shop.product_type) >= 0) {\n\n\t\t\t\tif (quantity === null) {\n\t\t\t\t\tquantity = Number(jQuery(\".input-text.qty\").val()) ? Number(jQuery(\".input-text.qty\").val()) : 1;\n\t\t\t\t}\n\n\t\t\t\tif (!productId) {\n\t\t\t\t\tproductId = jQuery(\"[name='variation_id']\").val();\n\t\t\t\t}\n\n\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If is grouped product\n\t\t\tif (pmwDataLayer.shop.product_type === \"grouped\") {\n\n\t\t\t\tjQuery(\".woocommerce-grouped-product-list-item\").each((index, element) => {\n\n\t\t\t\t\t// Can't rely on  event.target.dataset as it always is sent with the parent product ID and the quantity 1\n\n\t\t\t\t\tquantity = Number(jQuery(element).find(\".input-text.qty\").val()) ? Number(jQuery(element).find(\".input-text.qty\").val()) : 1;\n\n\t\t\t\t\tlet classes = jQuery(element).attr(\"class\");\n\t\t\t\t\tproductId   = pmw.getPostIdFromString(classes);\n\n\t\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If is bundle product\n\t\t\tif (pmwDataLayer.shop.product_type === \"bundle\") {\n\n\t\t\t\tif (quantity === null) {\n\t\t\t\t\tquantity = Number(jQuery(\".input-text.qty\").val()) ? Number(jQuery(\".input-text.qty\").val()) : 1;\n\t\t\t\t}\n\n\t\t\t\tif (!productId) {\n\t\t\t\t\tproductId = jQuery(\"input[name=add-to-cart]\").val();\n\t\t\t\t}\n\n\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// everything else\n\t\t\tif (quantity === null) {\n\t\t\t\tquantity = Number(jQuery(\".input-text.qty\").val()) ? Number(jQuery(\".input-text.qty\").val()) : 1;\n\t\t\t}\n\n\t\t\tpmw.addProductToCart(productId, quantity);\n\n\t\t} else {\n\n\t\t\tif (quantity === null) {\n\t\t\t\tquantity = 1;\n\t\t\t}\n\n\t\t\tif (!productId) {\n\t\t\t\t// console.log(\"add to cart event.currentTarget\", event.currentTarget)\n\t\t\t\tproductId = jQuery(event.currentTarget).data(\"product_id\") ? jQuery(event.currentTarget).data(\"product_id\") : null;\n\t\t\t}\n\n\t\t\t// Another fallback to retrieve the product ID in case the ID is saved in the value attribute\n\t\t\tif (!productId) {\n\t\t\t\tproductId = jQuery(event.currentTarget).val() ? jQuery(event.currentTarget).val() : null;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tproductId\n\t\t\t\t&& quantity\n\t\t\t) {\n\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t}\n\t\t}\n\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n\n/**\n * If someone clicks anywhere on a custom /?add-to-cart=123 link\n * trigger the add to cart event\n */\n\n// jQuery(document).one(\"click\", \"a:not(.add_to_cart_button, .ajax_add_to_cart, .single_add_to_cart_button)\", (event) => {\njQuery(\"a:not(.add_to_cart_button, .ajax_add_to_cart, .single_add_to_cart_button)\").one(\"click\", (event) => {\n\n\ttry {\n\t\tif (jQuery(event.target).closest(\"a\").attr(\"href\")) {\n\n\t\t\tlet url = new URL(jQuery(event.currentTarget).attr(\"href\"), window.location.origin);\n\n\t\t\tif (url.searchParams.has(\"add-to-cart\")) {\n\n\t\t\t\tlet productId = url.searchParams.get(\"add-to-cart\");\n\t\t\t\tlet quantity  = url.searchParams.has(\"quantity\") ? parseInt(url.searchParams.get(\"quantity\"), 10) : 1;\n\t\t\t\tpmw.addProductToCart(productId, quantity);\n\t\t\t}\n\t\t}\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n// select item event\n// jQuery(document).on(\"click\", \".woocommerce-LoopProduct-link, .wc-block-grid__product, .product, .product-small, .type-product\", (event) => {\njQuery(\".woocommerce-LoopProduct-link, .wc-block-grid__product, .product, .product-small, .type-product\").on(\"click\", (event) => {\n\n\ttry {\n\n\t\t/**\n\t\t * On some pages the event fires multiple times, and on product pages\n\t\t * even on page load. Using e.stopPropagation helps to prevent this,\n\t\t * but I don't know why. We don't even have to use this, since only a real\n\t\t * product click yields a valid productId. So we filter the invalid click\n\t\t * events out later down in the code. I'll keep it that way because this is\n\t\t * the most compatible way across shops.\n\t\t *\n\t\t * e.stopPropagation();\n\t\t * */\n\n\t\tlet productId = jQuery(event.currentTarget).nextAll(\".pmwProductId:first\").data(\"id\");\n\n\t\t/**\n\t\t * On product pages, for some reason, the click event is triggered on the main product on page load.\n\t\t * In that case no ID is found. But we can discard it, since we only want to trigger the event on\n\t\t * related products, which are found below.\n\t\t */\n\n\t\tif (productId) {\n\n\t\t\tproductId = pmw.getIdBasedOndVariationsOutputSetting(productId);\n\n\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\tif (pmwDataLayer.products && pmwDataLayer.products[productId]) {\n\n\t\t\t\tlet product = pmw.getProductDetailsFormattedForEvent(productId);\n\n\t\t\t\tjQuery(document).trigger(\"pmw:select-item\", product);\n\t\t\t}\n\t\t}\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n\n// checkout_progress event\n// track checkout option event: entered valid billing email\n// jQuery(document).on(\"input\", \"#billing_email\", (event) => {\njQuery(\"#billing_email\").on(\"input\", (event) => {\n\n\tif (pmw.isEmail(jQuery(event.currentTarget).val())) {\n\t\t// pmw.fireCheckoutOption(2);\n\t\tpmw.fireCheckoutProgress(2);\n\t\tpmw.emailSelected = true;\n\t}\n});\n\n\n/**\n * Place order button\n *\n * Track checkout option event: purchase click\n * https://stackoverflow.com/a/34112407/4688612\n * jQuery(document).one(\"click\", \"#place_order\", () => {\n *\n * Has to be hooked after document ready !\n */\njQuery(\"form.checkout\").on(\"checkout_place_order_success\", () => {\n\n\t// console log current time\n\t// console.log(\"checkout_place_order_success event fired at: \" + new Date().getTime())\n\n\tif (false === pmw.emailSelected) {\n\t\tpmw.fireCheckoutProgress(2);\n\t}\n\n\tif (false === pmw.paymentMethodSelected) {\n\t\tpmw.fireCheckoutProgress(3);\n\t\tpmw.fireCheckoutOption(3, jQuery(\"input[name='payment_method']:checked\").val());\n\t}\n\n\tpmw.fireCheckoutProgress(4);\n\n\tjQuery(document).trigger(\"pmw:place-order\", {});\n});\n\n/**\n * Update cart event\n *\n * Has to be hooked after document ready !\n */\njQuery(document).on(\"click\", \"[name='update_cart']\", () => {\n\n\ttry {\n\t\tjQuery(\".cart_item\").each((index, element) => {\n\n\t\t\tconst productId = pmw.getProductIdByCartItemElement(element);\n\n\t\t\tif (!productId) {\n\t\t\t\tconsole.error(\"Pixel Manager: Wasn't able to retrieve a productId\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst quantity = pmw.getProductQuantityByCartItemElement(element);\n\n\t\t\tif (!quantity) {\n\t\t\t\tconsole.error(\"Pixel Manager: Wasn't able to retrieve a quantity\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// console.log(\"productId\", productId)\n\t\t\t// console.log(\"quantity\", quantity)\n\n\t\t\tif (quantity === 0) {\n\t\t\t\tpmw.removeProductFromCart(productId);\n\t\t\t} else if (quantity < pmwDataLayer.cart[productId].quantity) {\n\t\t\t\tpmw.removeProductFromCart(productId, pmwDataLayer.cart[productId].quantity - quantity);\n\t\t\t} else if (quantity > pmwDataLayer.cart[productId].quantity) {\n\t\t\t\tpmw.addProductToCart(productId, quantity - pmwDataLayer.cart[productId].quantity);\n\t\t\t}\n\t\t});\n\t} catch (e) {\n\t\tconsole.error(e);\n\t\tpmw.getCartItemsFromBackend();\n\t}\n});\n\n// Supports the following plugins:\n// WooCommerce Wishlist: https://woo.com/products/woocommerce-wishlists/\n// YITH WooCommerce Wishlist: https://wordpress.org/plugins/yith-woocommerce-wishlist/\n// add_to_wishlist\njQuery(\".add_to_wishlist,.wl-add-to\").on(\"click\", event => {\n\n\ttry {\n\n\t\tlet productId;\n\n\t\tif (jQuery(event.currentTarget).data(\"productid\")) { // for the WooCommerce wishlist plugin\n\n\t\t\tproductId = jQuery(event.currentTarget).data(\"productid\");\n\t\t} else if (jQuery(event.currentTarget).data(\"product-id\")) {  // for the YITH wishlist plugin\n\n\t\t\tproductId = jQuery(event.currentTarget).data(\"product-id\");\n\t\t}\n\n\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\tlet product = pmw.getProductDetailsFormattedForEvent(productId);\n\n\n\t\tjQuery(document).trigger(\"pmw:add-to-wishlist\", product);\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n});\n\n\n/**\n * Called when the user selects all the required dropdowns / attributes\n *\n * Replaced by code in the event_listeners.js file in case of lazy loading\n *\n * Has to be hooked after document ready !\n *\n * https://stackoverflow.com/a/27849208/4688612\n * https://stackoverflow.com/a/65065335/4688612\n *\n */\n\nif (!pmwDataLayer?.general?.lazy_load_pmw) {\n\tpmw.registerShowVariationEventListener();\n}\n\n\n/**\n * Called on variable products when no selection has been done yet\n * or when the visitor deselects his choice.\n *\n * Has to be hooked after document ready !\n */\n\n// jQuery(function () {\n//\n// \tjQuery(\".single_variation_wrap\").on(\"hide_variation\", function () {\n//\n// \t\ttry {\n// \t\t\tlet classes   = jQuery(\"body\").attr(\"class\")\n// \t\t\tlet productId = classes.match(/(postid-)(\\d+)/)[2]\n//\n// \t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\")\n//\n// \t\t\t/**\n// \t\t\t * If we have a variable product with no preset,\n// \t\t\t * and variations output is enabled,\n// \t\t\t * then we send a viewItem event with the first\n// \t\t\t * variation we find for the parent.\n// \t\t\t * If variations output is disabled,\n// \t\t\t * we just send the parent ID.\n// \t\t\t *\n// \t\t\t * And if Facebook microdata is active, use the\n// \t\t\t * microdata product ID.\n// \t\t\t */\n//\n// \t\t\tif (\n// \t\t\t\t\"variable\" === pmwDataLayer.shop.product_type &&\n// \t\t\t\tpmwDataLayer?.shop?.variations_output\n// \t\t\t) {\n// \t\t\t\tfor (const [key, product] of Object.entries(pmwDataLayer.products)) {\n// \t\t\t\t\tif (\"parent_id\" in product) {\n//\n// \t\t\t\t\t\tproductId = product.id\n// \t\t\t\t\t\tbreak\n// \t\t\t\t\t}\n// \t\t\t\t}\n//\n// \t\t\t\tif (pmwDataLayer?.pixels?.facebook?.microdata_product_id) {\n// \t\t\t\t\tproductId = pmwDataLayer.pixels.facebook.microdata_product_id\n// \t\t\t\t}\n// \t\t\t}\n//\n// \t\t\t// console.log(\"hmm\")\n// \t\t\tpmw.triggerViewItemEventPrep(productId)\n//\n// \t\t} catch (e) {\n// \t\t\tconsole.error(e)\n// \t\t}\n// \t})\n// })\n\n// jQuery(function () {\n//\n// \tjQuery(\".single_variation_wrap\").on(\"hide_variation\", function () {\n// \t\tjQuery(document).trigger(\"pmw:view-item\")\n// \t})\n// })\n","(function (pmw, $, undefined) {\n\n\tconst PMW_LIBRARY_VERSION = \"1.56.0\"\n\n\tpmw.getLibraryVersion = () => {\n\t\treturn PMW_LIBRARY_VERSION\n\t}\n\n\tpmw.checkLibraryVersion = () => {\n\n\t\tif (pmw.getLibraryVersion() !== pmwDataLayer?.version?.number) {\n\t\t\tconsole.error(`Pixel Manager: The library version ${pmw.getLibraryVersion()} and pmwDataLayer.version.number ${pmwDataLayer.version.number} do not match. Delete the server-side cache and try again.`)\n\t\t}\n\t}\n\n}(window.pmw = window.pmw || {}, jQuery))\n\n","/**\n * Pixel Registry\n *\n * Central registry for managing pixel configurations and adapters.\n * Provides methods to query which pixels are active and retrieve their adapters.\n *\n * Firing Modes:\n * - browser_only: Fire only in browser (Microsoft Ads, Taboola)\n * - server_only: Fire only server-side, suppress browser pixel (admin choice)\n * - both: Fire both browser and server with event_id for deduplication (Facebook, TikTok)\n * - browser_or_server: Fire one or the other, never both (GA4 purchase)\n *\n * @since 1.51.0\n */\n\n(function (pmw, $, undefined) {\n\n\t/**\n\t * Valid firing modes\n\t * @type {string[]}\n\t */\n\tconst VALID_FIRING_MODES = [\"browser_only\", \"server_only\", \"both\", \"browser_or_server\"];\n\n\t/**\n\t * Default firing mode for pixels that don't specify one\n\t * @type {string}\n\t */\n\tconst DEFAULT_FIRING_MODE = \"browser_only\";\n\n\t/**\n\t * Pixel Registry namespace\n\t */\n\tpmw.pixelRegistry = {\n\n\t\t/**\n\t\t * Get all active pixels (both browser-only and S2S-capable)\n\t\t *\n\t\t * Queries each registered adapter's isActive function to determine\n\t\t * if the pixel should be loaded based on pmwDataLayer configuration.\n\t\t *\n\t\t * @returns {string[]} Array of active pixel names\n\t\t */\n\t\tgetActivePixels() {\n\t\t\tconst activePixels = [];\n\n\t\t\tif (!pmw.pixelCapabilities) {\n\t\t\t\treturn activePixels;\n\t\t\t}\n\n\t\t\t// Check each registered pixel's isActive function\n\t\t\tfor (const [pixelName, capabilities] of Object.entries(pmw.pixelCapabilities)) {\n\t\t\t\tif (typeof capabilities.isActive === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (capabilities.isActive()) {\n\t\t\t\t\t\t\tactivePixels.push(pixelName);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tpmw.console.error(`Error checking if ${pixelName} is active:`, e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn activePixels;\n\t\t},\n\n\t\t/**\n\t\t * Get browser-only pixels (pixels that don't support S2S)\n\t\t *\n\t\t * @returns {string[]} Array of browser-only pixel names\n\t\t */\n\t\tgetActiveBrowserOnlyPixels() {\n\t\t\tconst browserPixels = [];\n\t\t\tconst activePixels  = this.getActivePixels();\n\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\t// If pixel doesn't support S2S, it's browser-only\n\t\t\t\tif (pmw.pixelCapabilities?.[pixelName]?.supportsS2S !== true) {\n\t\t\t\t\tbrowserPixels.push(pixelName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn browserPixels;\n\t\t},\n\n\t\t/**\n\t\t * Get S2S-capable pixels\n\t\t *\n\t\t * Returns pixels that declared supportsS2S capability when registering.\n\t\t * These pixels ALWAYS receive the pmw:s2s:* events to fire their browser pixels (fbq, ttq, etc.),\n\t\t * regardless of whether S2S is actually enabled. They handle their own S2S logic internally.\n\t\t *\n\t\t * @returns {string[]} Array of S2S pixel names\n\t\t */\n\t\tgetActiveS2SPixels() {\n\t\t\tconst s2sPixels    = [];\n\t\t\tconst activePixels = this.getActivePixels();\n\n\t\t\t// Check each active pixel's capabilities\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\t// Check if this pixel declared supportsS2S capability when registering\n\t\t\t\tif (pmw.pixelCapabilities?.[pixelName]?.supportsS2S === true) {\n\t\t\t\t\ts2sPixels.push(pixelName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn s2sPixels;\n\t\t},\n\n\t\t/**\n\t\t * Get adapter for a specific pixel\n\t\t *\n\t\t * @param {string} pixelName - The pixel name (e.g., 'facebook', 'google_ads')\n\t\t * @returns {object|null} The adapter object or null if not found\n\t\t */\n\t\tgetAdapter(pixelName) {\n\t\t\tif (!pmw.adapters) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn pmw.adapters[pixelName] || null;\n\t\t},\n\n\t\t/**\n\t\t * Get active pixels with a specific capability\n\t\t *\n\t\t * Returns pixels that have the specified capability flag set to true.\n\t\t * This is a generic method that allows querying any capability\n\t\t * without needing dedicated methods for each one.\n\t\t *\n\t\t * @param {string} capabilityName - The capability to check (e.g., 'supportsS2S', 'supportsPageViewS2S')\n\t\t * @returns {string[]} Array of pixel names with the specified capability\n\t\t *\n\t\t * @example\n\t\t * // Get all pixels that support page view S2S\n\t\t * pmw.pixelRegistry.getPixelsWithCapability('supportsPageViewS2S')\n\t\t * // Returns: ['facebook', 'snapchat', 'reddit']\n\t\t */\n\t\tgetPixelsWithCapability(capabilityName) {\n\t\t\tconst pixelsWithCapability = [];\n\t\t\tconst activePixels         = this.getActivePixels();\n\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\tif (pmw.pixelCapabilities?.[pixelName]?.[capabilityName] === true) {\n\t\t\t\t\tpixelsWithCapability.push(pixelName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn pixelsWithCapability;\n\t\t},\n\n\t\t/**\n\t\t * Get the firing mode for a specific pixel\n\t\t *\n\t\t * Returns the registered firing mode for the pixel. The mode determines\n\t\t * whether events fire in browser, server, or both.\n\t\t *\n\t\t * @param {string} pixelName - The pixel name\n\t\t * @returns {string} The firing mode (browser_only, server_only, both, browser_or_server)\n\t\t */\n\t\tgetFiringMode(pixelName) {\n\t\t\tconst mode = pmw.pixelCapabilities?.[pixelName]?.mode;\n\n\t\t\t// Validate mode is one of the allowed values\n\t\t\tif (mode && VALID_FIRING_MODES.includes(mode)) {\n\t\t\t\treturn mode;\n\t\t\t}\n\n\t\t\t// Legacy support: if supportsS2S is true but no mode specified, default to 'both'\n\t\t\tif (pmw.pixelCapabilities?.[pixelName]?.supportsS2S === true) {\n\t\t\t\treturn \"both\";\n\t\t\t}\n\n\t\t\treturn DEFAULT_FIRING_MODE;\n\t\t},\n\n\t\t/**\n\t\t * Determine whether browser and/or server should fire for a pixel/event combination\n\t\t *\n\t\t * This is the core method for the unified firing mode system. It considers:\n\t\t * - The pixel's registered firing mode\n\t\t * - Whether S2S is globally enabled\n\t\t * - Any filters that modify firing behavior\n\t\t *\n\t\t * @param {string} pixelName - The pixel name\n\t\t * @param {string} eventName - The event name (e.g., 'add_to_cart', 'purchase')\n\t\t * @returns {object} { fire_browser: boolean, fire_server: boolean }\n\t\t */\n\t\tgetFiringDecision(pixelName, eventName) {\n\t\t\tconst mode        = this.getFiringMode(pixelName);\n\t\t\tconst s2sEnabled  = pmwDataLayer?.general?.server_2_server?.active === true;\n\t\t\tconst supportsS2S = pmw.pixelCapabilities?.[pixelName]?.supportsS2S === true;\n\n\t\t\tlet decision = {\n\t\t\t\tfire_browser: true,\n\t\t\t\tfire_server : false,\n\t\t\t};\n\n\t\t\tswitch (mode) {\n\t\t\t\tcase \"browser_only\":\n\t\t\t\t\tdecision = {fire_browser: true, fire_server: false};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"server_only\":\n\t\t\t\t\t// Server only fires if S2S is enabled AND pixel supports it\n\t\t\t\t\tdecision = {\n\t\t\t\t\t\tfire_browser: false,\n\t\t\t\t\t\tfire_server : s2sEnabled && supportsS2S,\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"both\":\n\t\t\t\t\t// Browser always fires, server fires if enabled\n\t\t\t\t\tdecision = {\n\t\t\t\t\t\tfire_browser: true,\n\t\t\t\t\t\tfire_server : s2sEnabled && supportsS2S,\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"browser_or_server\":\n\t\t\t\t\t// If S2S enabled and supported, use server; otherwise browser\n\t\t\t\t\tif (s2sEnabled && supportsS2S) {\n\t\t\t\t\t\tdecision = {fire_browser: false, fire_server: true};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdecision = {fire_browser: true, fire_server: false};\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Apply filter to allow external modification of firing behavior\n\t\t\t// Use case: Force server-only for specific pixels, disable certain pixels per-event\n\t\t\tdecision = pmw.hooks.applyFilters(\n\t\t\t\t\"pmw_pixel_firing_decision\",\n\t\t\t\tdecision,\n\t\t\t\tpixelName,\n\t\t\t\teventName,\n\t\t\t\tmode,\n\t\t\t);\n\n\t\t\treturn decision;\n\t\t},\n\n\t\t/**\n\t\t * Get all pixels that should fire in browser for a specific event\n\t\t *\n\t\t * @param {string} eventName - The event name\n\t\t * @returns {string[]} Array of pixel names that should fire in browser\n\t\t */\n\t\tgetPixelsForBrowserFiring(eventName) {\n\t\t\tconst pixels       = [];\n\t\t\tconst activePixels = this.getActivePixels();\n\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\tconst decision = this.getFiringDecision(pixelName, eventName);\n\t\t\t\tif (decision.fire_browser) {\n\t\t\t\t\tpixels.push(pixelName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn pixels;\n\t\t},\n\n\t\t/**\n\t\t * Get all pixels that should fire server-side for a specific event\n\t\t *\n\t\t * @param {string} eventName - The event name\n\t\t * @returns {string[]} Array of pixel names that should fire server-side\n\t\t */\n\t\tgetPixelsForServerFiring(eventName) {\n\t\t\tconst pixels       = [];\n\t\t\tconst activePixels = this.getActivePixels();\n\n\t\t\tfor (const pixelName of activePixels) {\n\t\t\t\tconst decision = this.getFiringDecision(pixelName, eventName);\n\t\t\t\tif (decision.fire_server) {\n\t\t\t\t\tpixels.push(pixelName);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn pixels;\n\t\t},\n\t};\n\n}(window.pmw = window.pmw || {}, jQuery));",null,null,"(function() {\n  var expandIPv6, ipaddr, ipv4Part, ipv4Regexes, ipv6Part, ipv6Regexes, matchCIDR, root, zoneIndex;\n\n  ipaddr = {};\n\n  root = this;\n\n  if ((typeof module !== \"undefined\" && module !== null) && module.exports) {\n    module.exports = ipaddr;\n  } else {\n    root['ipaddr'] = ipaddr;\n  }\n\n  matchCIDR = function(first, second, partSize, cidrBits) {\n    var part, shift;\n    if (first.length !== second.length) {\n      throw new Error(\"ipaddr: cannot match CIDR for objects with different lengths\");\n    }\n    part = 0;\n    while (cidrBits > 0) {\n      shift = partSize - cidrBits;\n      if (shift < 0) {\n        shift = 0;\n      }\n      if (first[part] >> shift !== second[part] >> shift) {\n        return false;\n      }\n      cidrBits -= partSize;\n      part += 1;\n    }\n    return true;\n  };\n\n  ipaddr.subnetMatch = function(address, rangeList, defaultName) {\n    var k, len, rangeName, rangeSubnets, subnet;\n    if (defaultName == null) {\n      defaultName = 'unicast';\n    }\n    for (rangeName in rangeList) {\n      rangeSubnets = rangeList[rangeName];\n      if (rangeSubnets[0] && !(rangeSubnets[0] instanceof Array)) {\n        rangeSubnets = [rangeSubnets];\n      }\n      for (k = 0, len = rangeSubnets.length; k < len; k++) {\n        subnet = rangeSubnets[k];\n        if (address.kind() === subnet[0].kind()) {\n          if (address.match.apply(address, subnet)) {\n            return rangeName;\n          }\n        }\n      }\n    }\n    return defaultName;\n  };\n\n  ipaddr.IPv4 = (function() {\n    function IPv4(octets) {\n      var k, len, octet;\n      if (octets.length !== 4) {\n        throw new Error(\"ipaddr: ipv4 octet count should be 4\");\n      }\n      for (k = 0, len = octets.length; k < len; k++) {\n        octet = octets[k];\n        if (!((0 <= octet && octet <= 255))) {\n          throw new Error(\"ipaddr: ipv4 octet should fit in 8 bits\");\n        }\n      }\n      this.octets = octets;\n    }\n\n    IPv4.prototype.kind = function() {\n      return 'ipv4';\n    };\n\n    IPv4.prototype.toString = function() {\n      return this.octets.join(\".\");\n    };\n\n    IPv4.prototype.toNormalizedString = function() {\n      return this.toString();\n    };\n\n    IPv4.prototype.toByteArray = function() {\n      return this.octets.slice(0);\n    };\n\n    IPv4.prototype.match = function(other, cidrRange) {\n      var ref;\n      if (cidrRange === void 0) {\n        ref = other, other = ref[0], cidrRange = ref[1];\n      }\n      if (other.kind() !== 'ipv4') {\n        throw new Error(\"ipaddr: cannot match ipv4 address with non-ipv4 one\");\n      }\n      return matchCIDR(this.octets, other.octets, 8, cidrRange);\n    };\n\n    IPv4.prototype.SpecialRanges = {\n      unspecified: [[new IPv4([0, 0, 0, 0]), 8]],\n      broadcast: [[new IPv4([255, 255, 255, 255]), 32]],\n      multicast: [[new IPv4([224, 0, 0, 0]), 4]],\n      linkLocal: [[new IPv4([169, 254, 0, 0]), 16]],\n      loopback: [[new IPv4([127, 0, 0, 0]), 8]],\n      carrierGradeNat: [[new IPv4([100, 64, 0, 0]), 10]],\n      \"private\": [[new IPv4([10, 0, 0, 0]), 8], [new IPv4([172, 16, 0, 0]), 12], [new IPv4([192, 168, 0, 0]), 16]],\n      reserved: [[new IPv4([192, 0, 0, 0]), 24], [new IPv4([192, 0, 2, 0]), 24], [new IPv4([192, 88, 99, 0]), 24], [new IPv4([198, 51, 100, 0]), 24], [new IPv4([203, 0, 113, 0]), 24], [new IPv4([240, 0, 0, 0]), 4]]\n    };\n\n    IPv4.prototype.range = function() {\n      return ipaddr.subnetMatch(this, this.SpecialRanges);\n    };\n\n    IPv4.prototype.toIPv4MappedAddress = function() {\n      return ipaddr.IPv6.parse(\"::ffff:\" + (this.toString()));\n    };\n\n    IPv4.prototype.prefixLengthFromSubnetMask = function() {\n      var cidr, i, k, octet, stop, zeros, zerotable;\n      zerotable = {\n        0: 8,\n        128: 7,\n        192: 6,\n        224: 5,\n        240: 4,\n        248: 3,\n        252: 2,\n        254: 1,\n        255: 0\n      };\n      cidr = 0;\n      stop = false;\n      for (i = k = 3; k >= 0; i = k += -1) {\n        octet = this.octets[i];\n        if (octet in zerotable) {\n          zeros = zerotable[octet];\n          if (stop && zeros !== 0) {\n            return null;\n          }\n          if (zeros !== 8) {\n            stop = true;\n          }\n          cidr += zeros;\n        } else {\n          return null;\n        }\n      }\n      return 32 - cidr;\n    };\n\n    return IPv4;\n\n  })();\n\n  ipv4Part = \"(0?\\\\d+|0x[a-f0-9]+)\";\n\n  ipv4Regexes = {\n    fourOctet: new RegExp(\"^\" + ipv4Part + \"\\\\.\" + ipv4Part + \"\\\\.\" + ipv4Part + \"\\\\.\" + ipv4Part + \"$\", 'i'),\n    longValue: new RegExp(\"^\" + ipv4Part + \"$\", 'i')\n  };\n\n  ipaddr.IPv4.parser = function(string) {\n    var match, parseIntAuto, part, shift, value;\n    parseIntAuto = function(string) {\n      if (string[0] === \"0\" && string[1] !== \"x\") {\n        return parseInt(string, 8);\n      } else {\n        return parseInt(string);\n      }\n    };\n    if (match = string.match(ipv4Regexes.fourOctet)) {\n      return (function() {\n        var k, len, ref, results;\n        ref = match.slice(1, 6);\n        results = [];\n        for (k = 0, len = ref.length; k < len; k++) {\n          part = ref[k];\n          results.push(parseIntAuto(part));\n        }\n        return results;\n      })();\n    } else if (match = string.match(ipv4Regexes.longValue)) {\n      value = parseIntAuto(match[1]);\n      if (value > 0xffffffff || value < 0) {\n        throw new Error(\"ipaddr: address outside defined range\");\n      }\n      return ((function() {\n        var k, results;\n        results = [];\n        for (shift = k = 0; k <= 24; shift = k += 8) {\n          results.push((value >> shift) & 0xff);\n        }\n        return results;\n      })()).reverse();\n    } else {\n      return null;\n    }\n  };\n\n  ipaddr.IPv6 = (function() {\n    function IPv6(parts, zoneId) {\n      var i, k, l, len, part, ref;\n      if (parts.length === 16) {\n        this.parts = [];\n        for (i = k = 0; k <= 14; i = k += 2) {\n          this.parts.push((parts[i] << 8) | parts[i + 1]);\n        }\n      } else if (parts.length === 8) {\n        this.parts = parts;\n      } else {\n        throw new Error(\"ipaddr: ipv6 part count should be 8 or 16\");\n      }\n      ref = this.parts;\n      for (l = 0, len = ref.length; l < len; l++) {\n        part = ref[l];\n        if (!((0 <= part && part <= 0xffff))) {\n          throw new Error(\"ipaddr: ipv6 part should fit in 16 bits\");\n        }\n      }\n      if (zoneId) {\n        this.zoneId = zoneId;\n      }\n    }\n\n    IPv6.prototype.kind = function() {\n      return 'ipv6';\n    };\n\n    IPv6.prototype.toString = function() {\n      return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/, '::');\n    };\n\n    IPv6.prototype.toRFC5952String = function() {\n      var bestMatchIndex, bestMatchLength, match, regex, string;\n      regex = /((^|:)(0(:|$)){2,})/g;\n      string = this.toNormalizedString();\n      bestMatchIndex = 0;\n      bestMatchLength = -1;\n      while ((match = regex.exec(string))) {\n        if (match[0].length > bestMatchLength) {\n          bestMatchIndex = match.index;\n          bestMatchLength = match[0].length;\n        }\n      }\n      if (bestMatchLength < 0) {\n        return string;\n      }\n      return string.substring(0, bestMatchIndex) + '::' + string.substring(bestMatchIndex + bestMatchLength);\n    };\n\n    IPv6.prototype.toByteArray = function() {\n      var bytes, k, len, part, ref;\n      bytes = [];\n      ref = this.parts;\n      for (k = 0, len = ref.length; k < len; k++) {\n        part = ref[k];\n        bytes.push(part >> 8);\n        bytes.push(part & 0xff);\n      }\n      return bytes;\n    };\n\n    IPv6.prototype.toNormalizedString = function() {\n      var addr, part, suffix;\n      addr = ((function() {\n        var k, len, ref, results;\n        ref = this.parts;\n        results = [];\n        for (k = 0, len = ref.length; k < len; k++) {\n          part = ref[k];\n          results.push(part.toString(16));\n        }\n        return results;\n      }).call(this)).join(\":\");\n      suffix = '';\n      if (this.zoneId) {\n        suffix = '%' + this.zoneId;\n      }\n      return addr + suffix;\n    };\n\n    IPv6.prototype.toFixedLengthString = function() {\n      var addr, part, suffix;\n      addr = ((function() {\n        var k, len, ref, results;\n        ref = this.parts;\n        results = [];\n        for (k = 0, len = ref.length; k < len; k++) {\n          part = ref[k];\n          results.push(part.toString(16).padStart(4, '0'));\n        }\n        return results;\n      }).call(this)).join(\":\");\n      suffix = '';\n      if (this.zoneId) {\n        suffix = '%' + this.zoneId;\n      }\n      return addr + suffix;\n    };\n\n    IPv6.prototype.match = function(other, cidrRange) {\n      var ref;\n      if (cidrRange === void 0) {\n        ref = other, other = ref[0], cidrRange = ref[1];\n      }\n      if (other.kind() !== 'ipv6') {\n        throw new Error(\"ipaddr: cannot match ipv6 address with non-ipv6 one\");\n      }\n      return matchCIDR(this.parts, other.parts, 16, cidrRange);\n    };\n\n    IPv6.prototype.SpecialRanges = {\n      unspecified: [new IPv6([0, 0, 0, 0, 0, 0, 0, 0]), 128],\n      linkLocal: [new IPv6([0xfe80, 0, 0, 0, 0, 0, 0, 0]), 10],\n      multicast: [new IPv6([0xff00, 0, 0, 0, 0, 0, 0, 0]), 8],\n      loopback: [new IPv6([0, 0, 0, 0, 0, 0, 0, 1]), 128],\n      uniqueLocal: [new IPv6([0xfc00, 0, 0, 0, 0, 0, 0, 0]), 7],\n      ipv4Mapped: [new IPv6([0, 0, 0, 0, 0, 0xffff, 0, 0]), 96],\n      rfc6145: [new IPv6([0, 0, 0, 0, 0xffff, 0, 0, 0]), 96],\n      rfc6052: [new IPv6([0x64, 0xff9b, 0, 0, 0, 0, 0, 0]), 96],\n      '6to4': [new IPv6([0x2002, 0, 0, 0, 0, 0, 0, 0]), 16],\n      teredo: [new IPv6([0x2001, 0, 0, 0, 0, 0, 0, 0]), 32],\n      reserved: [[new IPv6([0x2001, 0xdb8, 0, 0, 0, 0, 0, 0]), 32]]\n    };\n\n    IPv6.prototype.range = function() {\n      return ipaddr.subnetMatch(this, this.SpecialRanges);\n    };\n\n    IPv6.prototype.isIPv4MappedAddress = function() {\n      return this.range() === 'ipv4Mapped';\n    };\n\n    IPv6.prototype.toIPv4Address = function() {\n      var high, low, ref;\n      if (!this.isIPv4MappedAddress()) {\n        throw new Error(\"ipaddr: trying to convert a generic ipv6 address to ipv4\");\n      }\n      ref = this.parts.slice(-2), high = ref[0], low = ref[1];\n      return new ipaddr.IPv4([high >> 8, high & 0xff, low >> 8, low & 0xff]);\n    };\n\n    IPv6.prototype.prefixLengthFromSubnetMask = function() {\n      var cidr, i, k, part, stop, zeros, zerotable;\n      zerotable = {\n        0: 16,\n        32768: 15,\n        49152: 14,\n        57344: 13,\n        61440: 12,\n        63488: 11,\n        64512: 10,\n        65024: 9,\n        65280: 8,\n        65408: 7,\n        65472: 6,\n        65504: 5,\n        65520: 4,\n        65528: 3,\n        65532: 2,\n        65534: 1,\n        65535: 0\n      };\n      cidr = 0;\n      stop = false;\n      for (i = k = 7; k >= 0; i = k += -1) {\n        part = this.parts[i];\n        if (part in zerotable) {\n          zeros = zerotable[part];\n          if (stop && zeros !== 0) {\n            return null;\n          }\n          if (zeros !== 16) {\n            stop = true;\n          }\n          cidr += zeros;\n        } else {\n          return null;\n        }\n      }\n      return 128 - cidr;\n    };\n\n    return IPv6;\n\n  })();\n\n  ipv6Part = \"(?:[0-9a-f]+::?)+\";\n\n  zoneIndex = \"%[0-9a-z]{1,}\";\n\n  ipv6Regexes = {\n    zoneIndex: new RegExp(zoneIndex, 'i'),\n    \"native\": new RegExp(\"^(::)?(\" + ipv6Part + \")?([0-9a-f]+)?(::)?(\" + zoneIndex + \")?$\", 'i'),\n    transitional: new RegExp((\"^((?:\" + ipv6Part + \")|(?:::)(?:\" + ipv6Part + \")?)\") + (ipv4Part + \"\\\\.\" + ipv4Part + \"\\\\.\" + ipv4Part + \"\\\\.\" + ipv4Part) + (\"(\" + zoneIndex + \")?$\"), 'i')\n  };\n\n  expandIPv6 = function(string, parts) {\n    var colonCount, lastColon, part, replacement, replacementCount, zoneId;\n    if (string.indexOf('::') !== string.lastIndexOf('::')) {\n      return null;\n    }\n    zoneId = (string.match(ipv6Regexes['zoneIndex']) || [])[0];\n    if (zoneId) {\n      zoneId = zoneId.substring(1);\n      string = string.replace(/%.+$/, '');\n    }\n    colonCount = 0;\n    lastColon = -1;\n    while ((lastColon = string.indexOf(':', lastColon + 1)) >= 0) {\n      colonCount++;\n    }\n    if (string.substr(0, 2) === '::') {\n      colonCount--;\n    }\n    if (string.substr(-2, 2) === '::') {\n      colonCount--;\n    }\n    if (colonCount > parts) {\n      return null;\n    }\n    replacementCount = parts - colonCount;\n    replacement = ':';\n    while (replacementCount--) {\n      replacement += '0:';\n    }\n    string = string.replace('::', replacement);\n    if (string[0] === ':') {\n      string = string.slice(1);\n    }\n    if (string[string.length - 1] === ':') {\n      string = string.slice(0, -1);\n    }\n    parts = (function() {\n      var k, len, ref, results;\n      ref = string.split(\":\");\n      results = [];\n      for (k = 0, len = ref.length; k < len; k++) {\n        part = ref[k];\n        results.push(parseInt(part, 16));\n      }\n      return results;\n    })();\n    return {\n      parts: parts,\n      zoneId: zoneId\n    };\n  };\n\n  ipaddr.IPv6.parser = function(string) {\n    var addr, k, len, match, octet, octets, zoneId;\n    if (ipv6Regexes['native'].test(string)) {\n      return expandIPv6(string, 8);\n    } else if (match = string.match(ipv6Regexes['transitional'])) {\n      zoneId = match[6] || '';\n      addr = expandIPv6(match[1].slice(0, -1) + zoneId, 6);\n      if (addr.parts) {\n        octets = [parseInt(match[2]), parseInt(match[3]), parseInt(match[4]), parseInt(match[5])];\n        for (k = 0, len = octets.length; k < len; k++) {\n          octet = octets[k];\n          if (!((0 <= octet && octet <= 255))) {\n            return null;\n          }\n        }\n        addr.parts.push(octets[0] << 8 | octets[1]);\n        addr.parts.push(octets[2] << 8 | octets[3]);\n        return {\n          parts: addr.parts,\n          zoneId: addr.zoneId\n        };\n      }\n    }\n    return null;\n  };\n\n  ipaddr.IPv4.isIPv4 = ipaddr.IPv6.isIPv6 = function(string) {\n    return this.parser(string) !== null;\n  };\n\n  ipaddr.IPv4.isValid = function(string) {\n    var e;\n    try {\n      new this(this.parser(string));\n      return true;\n    } catch (error1) {\n      e = error1;\n      return false;\n    }\n  };\n\n  ipaddr.IPv4.isValidFourPartDecimal = function(string) {\n    if (ipaddr.IPv4.isValid(string) && string.match(/^(0|[1-9]\\d*)(\\.(0|[1-9]\\d*)){3}$/)) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  ipaddr.IPv6.isValid = function(string) {\n    var addr, e;\n    if (typeof string === \"string\" && string.indexOf(\":\") === -1) {\n      return false;\n    }\n    try {\n      addr = this.parser(string);\n      new this(addr.parts, addr.zoneId);\n      return true;\n    } catch (error1) {\n      e = error1;\n      return false;\n    }\n  };\n\n  ipaddr.IPv4.parse = function(string) {\n    var parts;\n    parts = this.parser(string);\n    if (parts === null) {\n      throw new Error(\"ipaddr: string is not formatted like ip address\");\n    }\n    return new this(parts);\n  };\n\n  ipaddr.IPv6.parse = function(string) {\n    var addr;\n    addr = this.parser(string);\n    if (addr.parts === null) {\n      throw new Error(\"ipaddr: string is not formatted like ip address\");\n    }\n    return new this(addr.parts, addr.zoneId);\n  };\n\n  ipaddr.IPv4.parseCIDR = function(string) {\n    var maskLength, match, parsed;\n    if (match = string.match(/^(.+)\\/(\\d+)$/)) {\n      maskLength = parseInt(match[2]);\n      if (maskLength >= 0 && maskLength <= 32) {\n        parsed = [this.parse(match[1]), maskLength];\n        Object.defineProperty(parsed, 'toString', {\n          value: function() {\n            return this.join('/');\n          }\n        });\n        return parsed;\n      }\n    }\n    throw new Error(\"ipaddr: string is not formatted like an IPv4 CIDR range\");\n  };\n\n  ipaddr.IPv4.subnetMaskFromPrefixLength = function(prefix) {\n    var filledOctetCount, j, octets;\n    prefix = parseInt(prefix);\n    if (prefix < 0 || prefix > 32) {\n      throw new Error('ipaddr: invalid IPv4 prefix length');\n    }\n    octets = [0, 0, 0, 0];\n    j = 0;\n    filledOctetCount = Math.floor(prefix / 8);\n    while (j < filledOctetCount) {\n      octets[j] = 255;\n      j++;\n    }\n    if (filledOctetCount < 4) {\n      octets[filledOctetCount] = Math.pow(2, prefix % 8) - 1 << 8 - (prefix % 8);\n    }\n    return new this(octets);\n  };\n\n  ipaddr.IPv4.broadcastAddressFromCIDR = function(string) {\n    var cidr, error, i, ipInterfaceOctets, octets, subnetMaskOctets;\n    try {\n      cidr = this.parseCIDR(string);\n      ipInterfaceOctets = cidr[0].toByteArray();\n      subnetMaskOctets = this.subnetMaskFromPrefixLength(cidr[1]).toByteArray();\n      octets = [];\n      i = 0;\n      while (i < 4) {\n        octets.push(parseInt(ipInterfaceOctets[i], 10) | parseInt(subnetMaskOctets[i], 10) ^ 255);\n        i++;\n      }\n      return new this(octets);\n    } catch (error1) {\n      error = error1;\n      throw new Error('ipaddr: the address does not have IPv4 CIDR format');\n    }\n  };\n\n  ipaddr.IPv4.networkAddressFromCIDR = function(string) {\n    var cidr, error, i, ipInterfaceOctets, octets, subnetMaskOctets;\n    try {\n      cidr = this.parseCIDR(string);\n      ipInterfaceOctets = cidr[0].toByteArray();\n      subnetMaskOctets = this.subnetMaskFromPrefixLength(cidr[1]).toByteArray();\n      octets = [];\n      i = 0;\n      while (i < 4) {\n        octets.push(parseInt(ipInterfaceOctets[i], 10) & parseInt(subnetMaskOctets[i], 10));\n        i++;\n      }\n      return new this(octets);\n    } catch (error1) {\n      error = error1;\n      throw new Error('ipaddr: the address does not have IPv4 CIDR format');\n    }\n  };\n\n  ipaddr.IPv6.parseCIDR = function(string) {\n    var maskLength, match, parsed;\n    if (match = string.match(/^(.+)\\/(\\d+)$/)) {\n      maskLength = parseInt(match[2]);\n      if (maskLength >= 0 && maskLength <= 128) {\n        parsed = [this.parse(match[1]), maskLength];\n        Object.defineProperty(parsed, 'toString', {\n          value: function() {\n            return this.join('/');\n          }\n        });\n        return parsed;\n      }\n    }\n    throw new Error(\"ipaddr: string is not formatted like an IPv6 CIDR range\");\n  };\n\n  ipaddr.isValid = function(string) {\n    return ipaddr.IPv6.isValid(string) || ipaddr.IPv4.isValid(string);\n  };\n\n  ipaddr.parse = function(string) {\n    if (ipaddr.IPv6.isValid(string)) {\n      return ipaddr.IPv6.parse(string);\n    } else if (ipaddr.IPv4.isValid(string)) {\n      return ipaddr.IPv4.parse(string);\n    } else {\n      throw new Error(\"ipaddr: the address has neither IPv6 nor IPv4 format\");\n    }\n  };\n\n  ipaddr.parseCIDR = function(string) {\n    var e;\n    try {\n      return ipaddr.IPv6.parseCIDR(string);\n    } catch (error1) {\n      e = error1;\n      try {\n        return ipaddr.IPv4.parseCIDR(string);\n      } catch (error1) {\n        e = error1;\n        throw new Error(\"ipaddr: the address has neither IPv6 nor IPv4 CIDR format\");\n      }\n    }\n  };\n\n  ipaddr.fromByteArray = function(bytes) {\n    var length;\n    length = bytes.length;\n    if (length === 4) {\n      return new ipaddr.IPv4(bytes);\n    } else if (length === 16) {\n      return new ipaddr.IPv6(bytes);\n    } else {\n      throw new Error(\"ipaddr: the binary input is neither an IPv6 nor IPv4 address\");\n    }\n  };\n\n  ipaddr.process = function(string) {\n    var addr;\n    addr = this.parse(string);\n    if (addr.kind() === 'ipv6' && addr.isIPv4MappedAddress()) {\n      return addr.toIPv4Address();\n    } else {\n      return addr;\n    }\n  };\n\n}).call(this);\n","/**\n * Created by elgs on 3/5/16.\n */\nconst normalize = function (a) {\n   if (!_validate(a)) {\n      throw new Error('Invalid address: ' + a);\n   }\n   a = a.toLowerCase()\n\n   const nh = a.split(/\\:\\:/g);\n   if (nh.length > 2) {\n      throw new Error('Invalid address: ' + a);\n   }\n\n   let sections = [];\n   if (nh.length == 1) {\n      // full mode\n      sections = a.split(/\\:/g);\n      if (sections.length !== 8) {\n         throw new Error('Invalid address: ' + a);\n      }\n   } else if (nh.length == 2) {\n      // compact mode\n      const n = nh[0];\n      const h = nh[1];\n      const ns = n.split(/\\:/g);\n      const hs = h.split(/\\:/g);\n      for (let i in ns) {\n         sections[i] = ns[i];\n      }\n      for (let i = hs.length; i > 0; --i) {\n         sections[7 - (hs.length - i)] = hs[i - 1];\n      }\n   }\n   for (let i = 0; i < 8; ++i) {\n      if (sections[i] === undefined) {\n         sections[i] = '0000';\n      }\n      sections[i] = _leftPad(sections[i], '0', 4);\n   }\n   return sections.join(':');\n};\n\nconst abbreviate = function (a) {\n   if (!_validate(a)) {\n      throw new Error('Invalid address: ' + a);\n   }\n   a = normalize(a);\n   a = a.replace(/0000/g, 'g');\n   a = a.replace(/\\:000/g, ':');\n   a = a.replace(/\\:00/g, ':');\n   a = a.replace(/\\:0/g, ':');\n   a = a.replace(/g/g, '0');\n   const sections = a.split(/\\:/g);\n   let zPreviousFlag = false;\n   let zeroStartIndex = -1;\n   let zeroLength = 0;\n   let zStartIndex = -1;\n   let zLength = 0;\n   for (let i = 0; i < 8; ++i) {\n      const section = sections[i];\n      let zFlag = (section === '0');\n      if (zFlag && !zPreviousFlag) {\n         zStartIndex = i;\n      }\n      if (!zFlag && zPreviousFlag) {\n         zLength = i - zStartIndex;\n      }\n      if (zLength > 1 && zLength > zeroLength) {\n         zeroStartIndex = zStartIndex;\n         zeroLength = zLength;\n      }\n      zPreviousFlag = (section === '0');\n   }\n   if (zPreviousFlag) {\n      zLength = 8 - zStartIndex;\n   }\n   if (zLength > 1 && zLength > zeroLength) {\n      zeroStartIndex = zStartIndex;\n      zeroLength = zLength;\n   }\n   //console.log(zeroStartIndex, zeroLength);\n   //console.log(sections);\n   if (zeroStartIndex >= 0 && zeroLength > 1) {\n      sections.splice(zeroStartIndex, zeroLength, 'g');\n   }\n   //console.log(sections);\n   a = sections.join(':');\n   //console.log(a);\n   a = a.replace(/\\:g\\:/g, '::');\n   a = a.replace(/\\:g/g, '::');\n   a = a.replace(/g\\:/g, '::');\n   a = a.replace(/g/g, '::');\n   //console.log(a);\n   return a;\n};\n\n// Basic validation\nconst _validate = function (a) {\n   return /^[a-f0-9\\\\:]+$/ig.test(a);\n};\n\nconst _leftPad = function (d, p, n) {\n   const padding = p.repeat(n);\n   if (d.length < padding.length) {\n      d = padding.substring(0, padding.length - d.length) + d;\n   }\n   return d;\n};\n\nconst _hex2bin = function (hex) {\n   return parseInt(hex, 16).toString(2)\n};\nconst _bin2hex = function (bin) {\n   return parseInt(bin, 2).toString(16)\n};\n\nconst _addr2bin = function (addr) {\n   const nAddr = normalize(addr);\n   const sections = nAddr.split(\":\");\n   let binAddr = '';\n   for (const section of sections) {\n      binAddr += _leftPad(_hex2bin(section), '0', 16);\n   }\n   return binAddr;\n};\n\nconst _bin2addr = function (bin) {\n   const addr = [];\n   for (let i = 0; i < 8; ++i) {\n      const binPart = bin.substr(i * 16, 16);\n      const hexSection = _leftPad(_bin2hex(binPart), '0', 4);\n      addr.push(hexSection);\n   }\n   return addr.join(':');\n};\n\nconst divideSubnet = function (addr, mask0, mask1, limit, abbr) {\n   if (!_validate(addr)) {\n      throw new Error('Invalid address: ' + addr);\n   }\n   mask0 *= 1;\n   mask1 *= 1;\n   limit *= 1;\n   mask1 = mask1 || 128;\n   if (mask0 < 1 || mask1 < 1 || mask0 > 128 || mask1 > 128 || mask0 > mask1) {\n      throw new Error('Invalid masks.');\n   }\n   const ret = [];\n   const binAddr = _addr2bin(addr);\n   const binNetPart = binAddr.substr(0, mask0);\n   const binHostPart = '0'.repeat(128 - mask1);\n   const numSubnets = Math.pow(2, mask1 - mask0);\n   for (let i = 0; i < numSubnets; ++i) {\n      if (!!limit && i >= limit) {\n         break;\n      }\n      const binSubnet = _leftPad(i.toString(2), '0', mask1 - mask0);\n      const binSubAddr = binNetPart + binSubnet + binHostPart;\n      const hexAddr = _bin2addr(binSubAddr);\n      if (!!abbr) {\n         ret.push(abbreviate(hexAddr));\n      } else {\n         ret.push(hexAddr);\n      }\n\n   }\n   // console.log(numSubnets);\n   // console.log(binNetPart, binSubnetPart, binHostPart);\n   // console.log(binNetPart.length, binSubnetPart.length, binHostPart.length);\n   // console.log(ret.length);\n   return ret;\n};\n\nconst range = function (addr, mask0, mask1, abbr) {\n   if (!_validate(addr)) {\n      throw new Error('Invalid address: ' + addr);\n   }\n   mask0 *= 1;\n   mask1 *= 1;\n   mask1 = mask1 || 128;\n   if (mask0 < 1 || mask1 < 1 || mask0 > 128 || mask1 > 128 || mask0 > mask1) {\n      throw new Error('Invalid masks.');\n   }\n   const binAddr = _addr2bin(addr);\n   const binNetPart = binAddr.substr(0, mask0);\n   const binHostPart = '0'.repeat(128 - mask1);\n   const binStartAddr = binNetPart + '0'.repeat(mask1 - mask0) + binHostPart;\n   const binEndAddr = binNetPart + '1'.repeat(mask1 - mask0) + binHostPart;\n   if (!!abbr) {\n      return {\n         start: abbreviate(_bin2addr(binStartAddr)),\n         end: abbreviate(_bin2addr(binEndAddr)),\n         size: Math.pow(2, mask1 - mask0)\n      };\n   } else {\n      return {\n         start: _bin2addr(binStartAddr),\n         end: _bin2addr(binEndAddr),\n         size: Math.pow(2, mask1 - mask0)\n      };\n   }\n};\n\nconst randomSubnet = function (addr, mask0, mask1, limit, abbr) {\n   if (!_validate(addr)) {\n      throw new Error('Invalid address: ' + addr);\n   }\n   mask0 *= 1;\n   mask1 *= 1;\n   limit *= 1;\n   mask1 = mask1 || 128;\n   limit = limit || 1;\n   if (mask0 < 1 || mask1 < 1 || mask0 > 128 || mask1 > 128 || mask0 > mask1) {\n      throw new Error('Invalid masks.');\n   }\n   const ret = [];\n   const binAddr = _addr2bin(addr);\n   const binNetPart = binAddr.substr(0, mask0);\n   const binHostPart = '0'.repeat(128 - mask1);\n   const numSubnets = Math.pow(2, mask1 - mask0);\n   for (let i = 0; i < numSubnets && i < limit; ++i) {\n      // generate an binary string with length of mask1 - mask0\n      let binSubnet = '';\n      for (let j = 0; j < mask1 - mask0; ++j) {\n         binSubnet += Math.floor(Math.random() * 2);\n      }\n      const binSubAddr = binNetPart + binSubnet + binHostPart;\n      const hexAddr = _bin2addr(binSubAddr);\n      if (!!abbr) {\n         ret.push(abbreviate(hexAddr));\n      } else {\n         ret.push(hexAddr);\n      }\n   }\n   // console.log(numSubnets);\n   // console.log(binNetPart, binSubnetPart, binHostPart);\n   // console.log(binNetPart.length, binSubnetPart.length, binHostPart.length);\n   // console.log(ret.length);\n   return ret;\n};\n\nconst ptr = function (addr, mask) {\n   if (!_validate(addr)) {\n      throw new Error('Invalid address: ' + addr);\n   }\n   mask *= 1;\n   if (mask < 1 || mask > 128 || Math.floor(mask / 4) != mask / 4) {\n      throw new Error('Invalid masks.');\n   }\n   const fullAddr = normalize(addr);\n   const reverse = fullAddr.replace(/:/g, '').split('').reverse();\n   return reverse.slice(0, (128 - mask) / 4).join('.');\n};\n\nif (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n   exports.normalize = normalize;\n   exports.abbreviate = abbreviate;\n   exports.divideSubnet = divideSubnet;\n   exports.range = range;\n   exports.randomSubnet = randomSubnet;\n   exports.ptr = ptr;\n} else {\n   window.normalize = normalize;\n   window.abbreviate = abbreviate;\n   window.divideSubnet = divideSubnet;\n   window.range = range;\n   window.randomSubnet = randomSubnet;\n   window.ptr = ptr;\n}\n","import ipaddr from 'ipaddr.js';\n// @ts-ignore: Can't find a @types/ip6 package\nimport ip6 from 'ip6';\n\nexport function isIP(addr: string) {\n  return ipaddr.isValid(addr);\n}\n\nexport function version(addr: string): number {\n  try {\n    const parse_addr = ipaddr.parse(addr);\n    const kind = parse_addr.kind();\n\n    if (kind === 'ipv4') {\n      return 4; //IPv4\n    } else if (kind === 'ipv6') {\n      return 6; //IPv6\n    } else {\n      /* istanbul ignore next */\n      return 0; //not 4 or 6\n    }\n  } catch (err) {\n    return 0; //not 4 or 6\n  }\n}\n\nexport function isV4(addr: string) {\n  return version(addr) === 4;\n}\n\nexport function isV6(addr: string) {\n  return version(addr) === 6;\n}\n\nexport function isRange(range: string) {\n  try {\n    const cidr = ipaddr.parseCIDR(range);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\nexport function inRange(addr: string, range: string | string[]) {\n  if (typeof range === 'string') {\n    if (range.indexOf('/') !== -1) {\n      try {\n        const range_data = range.split('/');\n\n        const parse_addr = ipaddr.parse(addr);\n        const parse_range = ipaddr.parse(range_data[0]);\n\n        //@ts-ignore:  It works.\n        return parse_addr.match(parse_range, range_data[1]);\n      } catch (err) {\n        return false;\n      }\n    } else {\n      addr = isV6(addr) ? ip6.normalize(addr) : addr; //v6 normalize addr\n      range = isV6(range) ? ip6.normalize(range) : range; //v6 normalize range\n\n      return isIP(range as string) && addr === range;\n    }\n  } else if (range && typeof range === 'object') {\n    //list\n    for (const check_range in range) {\n      if (inRange(addr, range[check_range]) === true) {\n        return true;\n      }\n    }\n    return false;\n  } else {\n    return false;\n  }\n}\n\nexport function storeIP(addr: string) {\n  try {\n    var parse_addr = ipaddr.parse(addr);\n    var kind = parse_addr.kind();\n\n    if (kind === 'ipv4') {\n      //is a plain v4 address\n      return addr;\n    } else if (kind === 'ipv6') {\n      //@ts-ignore:  it exists!\n      if (parse_addr.isIPv4MappedAddress()) {\n        //convert v4 mapped to v6 addresses to a v4 in it's original format\n        //@ts-ignore:  it exists!\n        return parse_addr.toIPv4Address().toString();\n      } //is a v6, abbreviate it\n      else {\n        return ip6.abbreviate(addr);\n      }\n    } else {\n      return null; //invalid IP address\n    }\n  } catch (err) {\n    return null; //invalid IP address\n  }\n}\n\n// searchIP is a aliases of storeIP\nexport { storeIP as searchIP };\n\nexport function displayIP(addr: string) {\n  try {\n    var parse_addr = ipaddr.parse(addr);\n    var kind = parse_addr.kind();\n\n    if (kind === 'ipv4') {\n      //is a plain v4 address\n      return addr;\n    } else if (kind === 'ipv6') {\n      //@ts-ignore:  it exists!\n      if (parse_addr.isIPv4MappedAddress()) {\n        //convert v4 mapped to v6 addresses to a v4 in it's original format\n        //@ts-ignore:  it exists!\n        return parse_addr.toIPv4Address().toString();\n      } //is a v6, normalize it\n      else {\n        return ip6.normalize(addr);\n      }\n    } else {\n      return ''; //invalid IP address\n    }\n  } catch (err) {\n    return ''; //invalid IP address\n  }\n}\n","/**\n * Create a wpm namespace under which all functions are declared\n */\n\n// https://stackoverflow.com/a/5947280/4688612\n\n(function (pmw, $, undefined) {\n\n\tconst pmwDeduper = {\n\t\tkeyName          : \"_wpm_order_ids\",\n\t\tcookieExpiresDays: 365,\n\t};\n\n\tconst pmwRestSettings = {\n\t\t// cookiesAvailable                  : '_wpm_cookies_are_available',\n\t\tcookiePmwRestEndpointAvailable: \"restEndpointAvailable\",\n\t\trestEndpointPost              : \"pmw/v1/test/\",\n\t\trestFails                     : 0,\n\t\trestFailsThreshold            : 10,\n\t};\n\n\tpmw.emailSelected         = false;\n\tpmw.paymentMethodSelected = false;\n\n\tpmw.isBelowRestErrorThreshold = () => pmw.retrieveData(pmwRestSettings.restFails) <= pmwRestSettings.restFailsThreshold;\n\n\tpmw.isRestEndpointAvailable = async () => {\n\n\t\t// If we already tested the endpoint and have a stored value, return it\n\t\tif (pmw.retrieveData(pmwRestSettings.cookiePmwRestEndpointAvailable)) {\n\t\t\treturn pmw.retrieveData(pmwRestSettings.cookiePmwRestEndpointAvailable);\n\t\t}\n\n\t\treturn await pmw.testEndpoint();\n\t};\n\n\t/**\n\t * Tests a given endpoint by sending a POST request. If the response status is 200, it stores `true` in the dataStorage with given cookie name; else it stores `false`.\n\t *\n\t * @param {string} url - The URL of the endpoint to test. Defaults to concatenation of `pmw.root` and `wpmRestSettings.restEndpointPost`.\n\t * @param {string} cookieName - The name of the cookie where the test result will be stored. Defaults to `wpmRestSettings.cookiePmwRestEndpointAvailable`.\n\t * @returns {Promise<boolean>} - Returns a promise that resolves to `true` if the response status is 200, and `false` otherwise.\n\t * @async\n\t */\n\tpmw.testEndpoint = async (\n\t\turl        = pmw.root + pmwRestSettings.restEndpointPost,\n\t\tcookieName = pmwRestSettings.cookiePmwRestEndpointAvailable,\n\t) => {\n\n\t\ttry {\n\n\t\t\tconst response = await fetch(url, {\n\t\t\t\tmethod   : \"POST\",\n\t\t\t\tmode     : \"cors\",\n\t\t\t\tcache    : \"no-cache\",\n\t\t\t\tkeepalive: true,\n\t\t\t\tredirect : \"error\",\t// don't follow redirects\n\t\t\t});\n\n\t\t\tif (!response.ok) {\n\t\t\t\tpmw.storeData(cookieName, false);\n\t\t\t\tpmw.console.error(\"Error testing the endpoint. Status: \" + response.status + \" | response: \", response);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst responseJson = await response.json();\n\n\t\t\t// Return false if responseJson.success is not true\n\t\t\tif (!responseJson.success) {\n\t\t\t\tpmw.storeData(cookieName, false);\n\t\t\t\tpmw.console.error(\"Error testing the endpoint. Response JSON: \" + JSON.stringify(responseJson));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tpmw.storeData(cookieName, true);\n\t\t\treturn true;\n\n\t\t} catch (e) {\n\t\t\tpmw.storeData(cookieName, false);\n\t\t\tpmw.console.error(\"Error testing the endpoint. Error: \" + e);\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tpmw.isPmwRestEndpointAvailable = (cookieName = pmwRestSettings.cookiePmwRestEndpointAvailable) => !!pmw.retrieveData(cookieName);\n\n\t/**\n\t * This function writes the provided orderId into storage. It will first retrieve the existing orderIds\n\t * from the storage if any, then add the new orderId into this existing array of orderIds  and stores\n\t * the updated array back to the storage.\n\t * If the function pmw.storeOrderIdOnServer exists and order_duplication_prevention is set to true in pmwDataLayer.shop,\n\t * this function will also store the orderId, orderKey and source on the server side using pmw.storeOrderIdOnServer.\n\t *\n\t * @param {String}  orderId  - The ID of the order to be stored.\n\t * @param {String}  orderKey - The Key of the order to be stored.\n\t * @param {String}  source - The source from which the order originated (default: 'thankyou_page').\n\t */\n\tpmw.writeOrderIdToStorage = (orderId, orderKey, source = \"thankyou_page\") => {\n\n\t\t// Get existing order ids\n\t\tlet orderIds = pmw.retrieveData(\"orderIds\", true) || [];\n\n\t\t// Add the new order id\n\t\torderIds.push(orderId);\n\n\t\t// Store the order ids\n\t\tpmw.storeData(\"orderIds\", orderIds, true);\n\n\t\tif (typeof pmw.storeOrderIdOnServer === \"function\") {\n\t\t\tpmw.storeOrderIdOnServer({\n\t\t\t\torderId : orderId,\n\t\t\t\torderKey: orderKey,\n\t\t\t\tsource  : source,\n\t\t\t});\n\t\t}\n\t};\n\n\tpmw.isOrderIdStored = orderId => {\n\n\t\t// If order deduplication is disabled, return false\n\t\tif (!pmwDataLayer.shop.order_duplication_prevention) {\n\t\t\tpmw.console.log(\"order duplication prevention is off\");\n\t\t\treturn false;\n\t\t}\n\n\t\tconst orderIds = pmw.retrieveData(\"orderIds\", true) || [];\n\t\treturn orderIds.includes(orderId);\n\t};\n\n\t/**\n\t * Check if the email address is valid\n\t *\n\t * https://stackoverflow.com/questions/201323/how-can-i-validate-an-email-address-using-a-regular-expression\n\t * https://www.w3.org/TR/html5/forms.html#valid-e-mail-address\n\t * https://fightingforalostcause.net/content/misc/2006/compare-email-regex.php\n\t *\n\t * @param email\n\t * @returns {boolean}\n\t */\n\tpmw.isEmail = email => {\n\n\t\t/**\n\t\t * GitHub Copilot generated RFC 5322 compliant regex\n\t\t * - Don't allow emails without a top-level domain like \"john@localhost\"\n\t\t * - Don't allow emails with dots at the end of the name like \"john.doe.@example.com\"\n\t\t */\n\t\tconst regex = new RegExp(\n\t\t\t\"^(([^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\\\"]+(\\\\.[^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\\\"]+)*)|(\\\".+\\\"))\"\n\t\t\t+ \"@\"\n\t\t\t+ \"((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\])\"\n\t\t\t+ \"|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$\",\n\t\t);\n\n\t\treturn regex.test(email);\n\t};\n\n\tpmw.removeProductFromCart = async (productId, quantityToRemove = null) => {\n\n\t\ttry {\n\n\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\tproductId = pmw.getIdBasedOndVariationsOutputSetting(productId);\n\n\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\tlet quantity;\n\n\t\t\tif (quantityToRemove == null) {\n\t\t\t\tquantity = pmwDataLayer.cart[productId].quantity;\n\t\t\t} else {\n\t\t\t\tquantity = quantityToRemove;\n\t\t\t}\n\n\t\t\tif (!pmwDataLayer.cart[productId]) {\n\t\t\t\tawait pmw.getProductsFromBackend([productId]);\n\t\t\t}\n\n\t\t\tlet product = pmw.getProductDetailsFormattedForEvent(productId, quantity);\n\n\t\t\tjQuery(document).trigger(\"pmw:remove-from-cart\", product);\n\n\t\t\tif (quantityToRemove == null || pmwDataLayer.cart[productId].quantity === quantityToRemove) {\n\t\t\t\tdelete pmwDataLayer.cart[productId];\n\t\t\t} else {\n\t\t\t\tpmwDataLayer.cart[productId].quantity = pmwDataLayer.cart[productId].quantity - quantity;\n\t\t\t}\n\n\t\t\tpmw.storeCartData(pmwDataLayer.cart);\n\n\t\t} catch (e) {\n\t\t\tpmw.console.error(\"error: \", e);\n\t\t}\n\t};\n\n\tpmw.getIdBasedOndVariationsOutputSetting = productId => {\n\n\t\ttry {\n\t\t\tif (pmwDataLayer?.shop?.variations_output) return productId;\n\n\t\t\tif (pmwDataLayer.products[productId].is_variation) return pmwDataLayer.products[productId].parent_id;\n\n\t\t\treturn productId;\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tpmw.prepareSelectors = (selectors, type) => {\n\n\t\tif (pmwDataLayer?.shop?.selectors?.[type]) {\n\n\t\t\t// merge the selectors from the addToCartSelectors array with the selectors from the pmwDataLayer.shop.selectors.addToCart array\n\t\t\tselectors = selectors.concat(pmwDataLayer.shop.selectors[type]);\n\n\t\t\t// Remove duplicates\n\t\t\tselectors = [...new Set(selectors)];\n\n\t\t\t// If one of the selectors is document, remove it\n\t\t\tif (selectors.indexOf(\"document\") >= 0) {\n\t\t\t\tselectors.splice(selectors.indexOf(\"document\"), 1);\n\t\t\t}\n\n\t\t\t// If one of the selectors is body, remove all others\n\t\t\tif (selectors.indexOf(\"body\") >= 0) {\n\t\t\t\tselectors = [\"body\"];\n\t\t\t}\n\t\t}\n\n\t\treturn selectors.join(\", \");\n\t};\n\n\t// add_to_cart\n\tpmw.addProductToCart = async (productId, quantity) => {\n\n\t\t// Cast quantity to number to make sure it's a number\n\t\tquantity = Number(quantity);\n\n\t\ttry {\n\n\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\tproductId = pmw.getIdBasedOndVariationsOutputSetting(productId);\n\n\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\tif (!pmwDataLayer?.products[productId]) {\n\t\t\t\tawait pmw.getProductsFromBackend([productId]);\n\t\t\t}\n\n\t\t\tlet product = pmw.getProductDetailsFormattedForEvent(productId, quantity);\n\n\t\t\tjQuery(document).trigger(\"pmw:add-to-cart\", product);\n\n\t\t\t// add product to cart pmwDataLayer['cart']\n\n\t\t\t// if the product already exists in the object, only add the additional quantity\n\t\t\t// otherwise create that product object in the pmwDataLayer['cart']\n\t\t\tif (pmwDataLayer?.cart[productId]) {\n\n\t\t\t\tpmwDataLayer.cart[productId].quantity = pmwDataLayer.cart[productId].quantity + quantity;\n\t\t\t} else {\n\n\t\t\t\tif (!(\"cart\" in pmwDataLayer)) pmwDataLayer.cart = {};\n\n\t\t\t\tpmwDataLayer.cart[productId] = pmw.getProductDetailsFormattedForEvent(productId, quantity);\n\t\t\t}\n\n\t\t\tpmw.storeCartData(pmwDataLayer.cart);\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\n\t\t\t// fallback if pmwDataLayer.cart and pmwDataLayer.products got out of sync in case cart caching has an issue\n\t\t\tpmw.getCartItemsFromBackend();\n\t\t}\n\t};\n\n\tpmw.initCart = () => {\n\n\t\t// If the WC cart doesn't exist, eg. after a confirmed purchase,\n\t\t// and we still have a cart object in the storage, reset it.\n\t\tif (\n\t\t\t!pmw.doesWooCommerceCartExist()\n\t\t\t&& Object.keys(pmw.retrieveCartData()).length !== 0\n\t\t) {\n\t\t\tpmw.storeCartData({});\n\t\t\treturn;\n\t\t}\n\n\t\t// If the cart object is in the storage, use it\n\t\tif (pmw.retrieveCartData()) {\n\t\t\tpmw.saveCartObjectToDataLayer(pmw.retrieveCartData());\n\t\t\treturn;\n\t\t}\n\n\t\t// If the cart object is missing in the storage, create an empty one and get the cart items from the backend\n\t\tpmw.storeCartData({});\n\t\tpmw.getCartItemsFromBackend();\n\t};\n\n\t// get all cart items from the backend\n\tpmw.getCartItemsFromBackend = () => {\n\t\ttry {\n\n\t\t\t/**\n\t\t\t * Can't use a REST API endpoint, as the cart session will not be loaded if the\n\t\t\t * endpoint is called.\n\t\t\t *\n\t\t\t * https://wordpress.org/support/topic/wc-cart-is-null-in-custom-rest-api/#post-11442843\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Get the cart items from the backend the data object using fetch API\n\t\t\t * and log success or error messages\n\t\t\t * and url encoded data\n\t\t\t */\n\t\t\tfetch(pmw.ajax_url, {\n\t\t\t\tmethod   : \"POST\",\n\t\t\t\tcache    : \"no-cache\",\n\t\t\t\tbody     : new URLSearchParams({action: \"pmw_get_cart_items\"}),\n\t\t\t\tkeepalive: true,\n\t\t\t\tredirect : \"error\",\n\t\t\t})\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response.ok) {\n\t\t\t\t\t\treturn response.json();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow Error(\"Error getting cart items from backend\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(data => {\n\n\t\t\t\t\tif (data.success) {\n\n\t\t\t\t\t\tif (!data.data[\"cart\"]) data.data[\"cart\"] = {};\n\t\t\t\t\t\tpmw.saveCartObjectToDataLayer(data.data[\"cart\"]);\n\t\t\t\t\t\tpmw.storeCartData(data.data[\"cart\"]);\n\n\t\t\t\t\t\t// Save cart_item_keys from AJAX response for remove_from_cart tracking\n\t\t\t\t\t\t// This provides fallback when inline scripts are suppressed via pmw_output_cart_item_data filter\n\t\t\t\t\t\tif (data.data[\"cart_item_keys\"]) {\n\t\t\t\t\t\t\tpmwDataLayer.cart_item_keys = Object.assign(\n\t\t\t\t\t\t\t\tpmwDataLayer.cart_item_keys || {},\n\t\t\t\t\t\t\t\tdata.data[\"cart_item_keys\"]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow Error(\"Error getting cart items from backend\");\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\t// Get product IDs from the backend\n\tpmw.getProductsFromBackend = async productIds => {\n\n\t\tif (pmwDataLayer?.products) {\n\t\t\t// If productIds already exists as key in pmwDataLayer.products, remove it from the array\n\t\t\tproductIds = productIds.filter(productId => !(productId in pmwDataLayer.products));\n\t\t}\n\n\t\t// If no product IDs are in the object, don't try to get anything from the server\n\t\tif (!productIds || productIds.length === 0) return;\n\n\t\t// if no page_id is set, don't try to get anything from the server\n\t\tif (!pmwDataLayer.general.page_id) return;\n\n\t\t// if productIds is not an array, or it's an empty array, don't try to get anything from the server\n\t\tif (!Array.isArray(productIds) || productIds.length === 0) return;\n\n\t\ttry {\n\n\t\t\tlet data = {\n\t\t\t\taction     : \"pmw_get_product_ids\",  // for the AJAX call\n\t\t\t\tpage_id    : pmwDataLayer.general.page_id,\n\t\t\t\tpage_type  : pmwDataLayer.shop.page_type,\n\t\t\t\tproduct_ids: productIds,\n\t\t\t};\n\n\t\t\tconst isRestEndpointAvailable = await pmw.isRestEndpointAvailable();\n\t\t\tconst url                     = isRestEndpointAvailable ? pmw.root + \"pmw/v1/products/\" : pmw.ajax_url;\n\n\t\t\tconst options = {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tcache : \"no-cache\",\n\t\t\t\tbody  : isRestEndpointAvailable ? JSON.stringify(data) : new URLSearchParams(data),\n\t\t\t};\n\n\t\t\t// If the REST API is available, set the headers to JSON\n\t\t\tif (isRestEndpointAvailable) {\n\t\t\t\toptions.headers = {\"Content-Type\": \"application/json\"};\n\t\t\t}\n\n\t\t\tlet response = await fetch(url, options);\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(\"Error getting products from backend. Status: \" + response.status + \" Status text: \" + response.statusText);\n\t\t\t}\n\n\t\t\tlet responseData = await response.json();\n\n\t\t\tif (!responseData.success) {\n\t\t\t\tthrow new Error(\"Error getting products from backend: \" + responseData.data);\n\t\t\t}\n\n\t\t\tpmwDataLayer.products = Object.assign({}, pmwDataLayer.products, responseData.data);\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tpmw.saveCartObjectToDataLayer = cartObject => {\n\n\t\tpmwDataLayer.cart     = cartObject;\n\t\tpmwDataLayer.products = Object.assign({}, pmwDataLayer.products, cartObject);\n\t};\n\n\tpmw.triggerViewItemEventPrep = async productId => {\n\n\t\tif (!pmwDataLayer?.products[productId]) {\n\t\t\tawait pmw.getProductsFromBackend([productId]);\n\t\t}\n\n\t\tif (!pmwDataLayer?.products[productId]) {\n\t\t\tpmw.triggerViewItemEventNoProduct();\n\t\t\tpmw.console.log(`Product with ID ${productId} not found in the data layer and couldn't be retrieved from the backend. Triggering view-item event without product data.`);\n\t\t} else {\n\t\t\tpmw.triggerViewItemEvent(productId);\n\t\t}\n\t};\n\n\tpmw.triggerViewItemEvent = productId => {\n\n\t\tlet product = pmw.getProductDetailsFormattedForEvent(productId);\n\n\t\tif (!product) return;\n\n\t\tjQuery(document).trigger(\"pmw:view-item\", product);\n\t};\n\n\tpmw.triggerViewItemEventNoProduct = () => {\n\t\tjQuery(document).trigger(\"pmw:view-item\");\n\t};\n\n\tpmw.fireCheckoutOption = (step, checkout_option = null, value = null) => {\n\n\t\tlet data = {\n\t\t\tstep           : step,\n\t\t\tcheckout_option: checkout_option,\n\t\t\tvalue          : value,\n\t\t};\n\n\t\tjQuery(document).trigger(\"pmw:checkout-option\", data);\n\t};\n\n\tpmw.fireCheckoutProgress = step => {\n\n\t\tlet data = {\n\t\t\tstep: step,\n\t\t};\n\n\t\tjQuery(document).trigger(\"pmw:checkout-progress\", data);\n\t};\n\n\tpmw.getPostIdFromString = string => {\n\n\t\ttry {\n\t\t\treturn string.match(/(post-)(\\d+)/)[2];\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tpmw.triggerViewItemList = productId => {\n\n\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\tproductId = pmw.getIdBasedOndVariationsOutputSetting(productId);\n\n\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\tjQuery(document).trigger(\"pmw:view-item-list\", pmw.getProductDataForViewItemEvent(productId));\n\t};\n\n\tpmw.getProductDataForViewItemEvent = productId => {\n\n\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\ttry {\n\t\t\tif (pmwDataLayer.products[productId]) {\n\n\t\t\t\treturn pmw.getProductDetailsFormattedForEvent(productId);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tpmw.getMainProductIdFromProductPage = () => {\n\n\t\ttry {\n\t\t\tif ([\"simple\", \"variable\", \"grouped\", \"composite\", \"bundle\"].indexOf(pmwDataLayer.shop.product_type) >= 0) {\n\t\t\t\treturn jQuery(\".pmwProductId:first\").data(\"id\");\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tpmw.viewItemListTriggerTestMode = target => {\n\n\t\tjQuery(target).css({\"position\": \"relative\"});\n\t\tjQuery(target).append(\"<div id=\\\"viewItemListTriggerOverlay\\\"></div>\");\n\t\tjQuery(target).find(\"#viewItemListTriggerOverlay\").css({\n\t\t\t\"z-index\"         : \"10\",\n\t\t\t\"display\"         : \"block\",\n\t\t\t\"position\"        : \"absolute\",\n\t\t\t\"height\"          : \"100%\",\n\t\t\t\"top\"             : \"0\",\n\t\t\t\"left\"            : \"0\",\n\t\t\t\"right\"           : \"0\",\n\t\t\t\"opacity\"         : pmwDataLayer.shop.view_item_list_trigger.opacity,\n\t\t\t\"background-color\": pmwDataLayer.shop.view_item_list_trigger.background_color,\n\t\t});\n\t};\n\n\tpmw.getSearchTermFromUrl = () => {\n\n\t\ttry {\n\t\t\tlet urlParameters = new URLSearchParams(window.location.search);\n\t\t\treturn urlParameters.get(\"s\");\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\t// we need this to track timeouts for intersection observers\n\tlet ioTimeouts = {};\n\n\tpmw.observerCallback = (entries, observer) => {\n\n\t\tentries.forEach((entry) => {\n\n\t\t\ttry {\n\t\t\t\tlet productId;\n\n\t\t\t\tlet elementId = jQuery(entry.target).data(\"ioid\");\n\n\t\t\t\t// Get the productId from next element, if wpmProductId is a sibling, like in Gutenberg blocks\n\t\t\t\t// otherwise go search in children, like in regular WC loop items\n\t\t\t\tif (jQuery(entry.target).next(\".pmwProductId\").length) {\n\t\t\t\t\t// console.log('test 1');\n\t\t\t\t\tproductId = jQuery(entry.target).next(\".pmwProductId\").data(\"id\");\n\t\t\t\t} else {\n\t\t\t\t\tproductId = jQuery(entry.target).find(\".pmwProductId\").data(\"id\");\n\t\t\t\t}\n\n\n\t\t\t\tif (!productId) throw Error(\"pmwProductId element not found\");\n\n\t\t\t\tif (entry.isIntersecting) {\n\n\t\t\t\t\tioTimeouts[elementId] = setTimeout(() => {\n\n\t\t\t\t\t\tpmw.triggerViewItemList(productId);\n\t\t\t\t\t\tif (pmwDataLayer.shop.view_item_list_trigger.test_mode) pmw.viewItemListTriggerTestMode(entry.target);\n\t\t\t\t\t\tif (pmwDataLayer.shop.view_item_list_trigger.repeat === false) observer.unobserve(entry.target);\n\t\t\t\t\t}, pmwDataLayer.shop.view_item_list_trigger.timeout);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tclearTimeout(ioTimeouts[elementId]);\n\t\t\t\t\tif (pmwDataLayer.shop.view_item_list_trigger.test_mode) jQuery(entry.target).find(\"#viewItemListTriggerOverlay\").remove();\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t});\n\t};\n\n\t// fire view_item_list only on products that have become visible\n\tlet io;\n\tlet ioid = 0;\n\n\tconst getCommonIdentifiersToWatch = () => {\n\n\t\tlet listOfClassNames = {\n\t\t\tnested: [],\n\t\t\tflat  : [],\n\t\t};\n\n\t\ttry {\n\n\t\t\tconst haveSameNestingDepth = (element1, element2) => {\n\n\t\t\t\t// If both are the same, return the parent\n\t\t\t\treturn jQuery(element1).parents().length === jQuery(element2).parents().length;\n\t\t\t};\n\n\t\t\tconst findCommonParentElement = (element1, element2) => {\n\t\t\t\t// If both are the same, return the parent\n\t\t\t\tif (jQuery(element1).parent().is(jQuery(element2).parent())) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tnode: jQuery(element1).parent(),\n\t\t\t\t\t\ttype: \"flat\",\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tnode: jQuery(element1).parents().has(jQuery(element2).parents()).first(),\n\t\t\t\t\ttype: \"nested\",\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tconst countOfChildren = (element) => {\n\t\t\t\t// Return the count of \"wpmProductId\" elements\n\t\t\t\treturn jQuery(element).find(\".pmwProductId\").length;\n\t\t\t};\n\n\t\t\tconst getCommonClass = (classes1, classes2) => {\n\n\t\t\t\t// console.log(\"classes1\", classes1);\n\t\t\t\t// console.log(\"classes2\", classes2);\n\t\t\t\t// classes 1 and 2 are arrays of classes\n\t\t\t\t// They may contain the same classes, but not in the same order\n\t\t\t\t// Return the first common class that's present in both arrays\n\n\t\t\t\treturn classes1.filter(value => classes2.includes(value))[0] || null;\n\t\t\t};\n\n\t\t\tconst pmwProductIds = document.querySelectorAll(\".pmwProductId\");\n\n\t\t\t// If zero or only one product template is found, then we can't run the algorithm\n\t\t\tif (pmwProductIds.length === 1) {\n\t\t\t\t// console.log(\"No product or too few templates found\")\n\t\t\t\treturn listOfClassNames;\n\t\t\t}\n\n\t\t\t// console.log(\"wpmProductIds\", wpmProductIds);\n\t\t\t// console.log(\"looping\")\n\n\t\t\tfor (let i = 0; i < pmwProductIds.length - 1; i++) {\n\n\t\t\t\t// console.log(\"i\", i)\n\n\t\t\t\tif (!haveSameNestingDepth(pmwProductIds[i], pmwProductIds[i + 1])) {\n\t\t\t\t\t// console.log(\"The nesting depth is not the same\")\n\t\t\t\t\ti++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet productsNode = findCommonParentElement(pmwProductIds[i], pmwProductIds[i + 1]);\n\t\t\t\t// console.log(\"productsNode.node\", productsNode.node)\n\t\t\t\t// console.log(\"productsNode.type\", productsNode.type)\n\n\t\t\t\t// If the productsNode is nested, get the first class of the first child. Then console log the class\n\t\t\t\tif (productsNode.type === \"nested\") {\n\n\t\t\t\t\tlet firstChildClassAttr = productsNode.node.children().first().attr(\"class\");\n\t\t\t\t\tlet firstChildClasses   = firstChildClassAttr ? firstChildClassAttr.split(\" \") : [];\n\n\t\t\t\t\tlet secondChildClassAttr = productsNode.node.children().first().next().attr(\"class\");\n\t\t\t\t\tlet secondChildClasses   = secondChildClassAttr ? secondChildClassAttr.split(\" \") : [];\n\n\t\t\t\t\tconst commonClass = getCommonClass(firstChildClasses, secondChildClasses);\n\n\t\t\t\t\tlistOfClassNames.nested.push(commonClass);\n\t\t\t\t} else if (productsNode.type === \"flat\") {\n\n\t\t\t\t\t// If class is not found, continue\n\t\t\t\t\tif (!productsNode.node.children().first().attr(\"class\")) continue;\n\n\t\t\t\t\t// firstProductTemplateClasses is the classes of the first child element of the productsNode\n\t\t\t\t\tlet firstProductTemplateClasses = productsNode.node.children().first().attr(\"class\").split(\" \")[0];\n\n\t\t\t\t\tlistOfClassNames.flat.push(firstProductTemplateClasses);\n\t\t\t\t}\n\n\t\t\t\t// which wpmProductIds is the last one in the productsNode? console log the index of the last wpmProductId in the productsNode\n\t\t\t\t// console.log(\"productsNode.children().length\", countOfChildren(productsNode));\n\n\t\t\t\ti = i + countOfChildren(productsNode.node) - 1;\n\t\t\t}\n\n\t\t\t// Make the list of class names unique\n\t\t\tlistOfClassNames.nested = [...new Set(listOfClassNames.nested)];\n\t\t\tlistOfClassNames.flat   = [...new Set(listOfClassNames.flat)];\n\n\t\t\treturn listOfClassNames;\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn listOfClassNames;\n\t\t}\n\t};\n\n\n\tlet detectedProductTemplateClasses = {\n\t\tnested: [],\n\t\tflat  : [],\n\t};\n\n\tconst isNestedClass = (elem) => {\n\t\tlet nestedClassNames = [\n\t\t\t\"product\",\n\t\t\t\"type-product\",\n\t\t\t\"product-item-inner\",\n\t\t\t...detectedProductTemplateClasses.nested,\n\t\t];\n\n\t\treturn nestedClassNames.some(className => jQuery(elem).closest(\".\" + className).length);\n\t};\n\n\tconst isFlatClass = (elem) => {\n\n\t\tlet flatClassNames = [\n\t\t\t\"wc-block-grid__product\",\n\t\t\t\"product\",\n\t\t\t\"product-small\",\n\t\t\t\"woocommerce-LoopProduct-link\",\n\t\t\t...detectedProductTemplateClasses.flat,\n\t\t];\n\n\t\treturn flatClassNames.some(className => jQuery(elem).prev().hasClass(className));\n\t};\n\n\tconst getAllElementsToWatch = () => {\n\n\t\tdetectedProductTemplateClasses = getCommonIdentifiersToWatch();\n\n\t\treturn jQuery(\".pmwProductId\")\n\t\t\t.map(function (i, elem) {\n\n\t\t\t\tif (isNestedClass(elem)) {\n\t\t\t\t\treturn jQuery(elem).parent();\n\t\t\t\t} else if (isFlatClass(elem)) {\n\t\t\t\t\treturn jQuery(this).prev();\n\t\t\t\t} else if (jQuery(elem).closest(\".product\").length) {\n\t\t\t\t\treturn jQuery(elem).closest(\".product\");\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tpmw.startIntersectionObserverToWatch = () => {\n\n\t\ttry {\n\t\t\t// enable view_item_list test mode from browser\n\t\t\tif (pmw.urlHasParameter(\"vildemomode\")) pmwDataLayer.shop.view_item_list_trigger.test_mode = true;\n\n\t\t\t// set up intersection observer\n\t\t\t// https://stackoverflow.com/questions/62084306/intersectionobserver-not-working-in-safari-or-ios\n\t\t\tio = new IntersectionObserver(pmw.observerCallback, {\n\t\t\t\troot: null,\n\t\t\t\t// root     : document.body,\n\t\t\t\tthreshold: pmwDataLayer.shop.view_item_list_trigger.threshold,\n\t\t\t});\n\n\t\t\tgetAllElementsToWatch().each((i, elem) => {\n\n\t\t\t\tjQuery(elem[0]).data(\"ioid\", ioid++);\n\n\t\t\t\tio.observe(elem[0]);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\t// Watch DOM for new lazy loaded products and add them to the intersection observer\n\tpmw.startProductsMutationObserverToWatch = () => {\n\n\t\ttry {\n\t\t\t// Pass in the target node, as well as the observer options\n\n\t\t\t// selects the most common parent node\n\t\t\t// https://stackoverflow.com/a/7648323/4688612\n\t\t\tlet productsNode = jQuery(\".pmwProductId:eq(0)\").parents().has(jQuery(\".pmwProductId:eq(1)\").parents()).first();\n\n\t\t\tif (productsNode.length) {\n\t\t\t\tproductsMutationObserver.observe(productsNode[0], {\n\t\t\t\t\tattributes   : true,\n\t\t\t\t\tchildList    : true,\n\t\t\t\t\tcharacterData: true,\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\t// Create an observer instance\n\tconst productsMutationObserver = new MutationObserver(mutations => {\n\n\t\tmutations.forEach(mutation => {\n\t\t\tlet newNodes = mutation.addedNodes; // DOM NodeList\n\t\t\tif (newNodes !== null) { // If there are new nodes added\n\t\t\t\tlet nodes = jQuery(newNodes); // jQuery set\n\t\t\t\tnodes.each((i, node) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t// jQuery(this).hasClass(\"type-product\") ||\n\t\t\t\t\t\t// jQuery(this).hasClass(\"product-small\") ||\n\t\t\t\t\t\t// jQuery(this).hasClass(\"wc-block-grid__product\")\n\t\t\t\t\t\t// jQuery(this).hasClass(\"type-product\")\n\t\t\t\t\t\tisNestedClass(node) || isFlatClass(node)\n\t\t\t\t\t) {\n\t\t\t\t\t\t// check if the node has a child or sibling wpmProductId\n\t\t\t\t\t\t// if yes add it to the intersectionObserver\n\t\t\t\t\t\tif (hasPmwProductIdElement(node)) {\n\t\t\t\t\t\t\tjQuery(node).data(\"ioid\", ioid++);\n\t\t\t\t\t\t\tio.observe(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\tlet hasPmwProductIdElement = elem =>\n\t\t!!(jQuery(elem).find(\".pmwProductId\").length ||\n\t\t\tjQuery(elem).siblings(\".pmwProductId\").length);\n\n\t/**\n\t * Sets a new cookie or updates an existing one with the provided name and value.\n\t *\n\t * @function setCookie\n\t * @global\n\t * @param {string} cookieName - The name of the cookie.\n\t * @param {string} [cookieValue=\"\"] - The value to set for the cookie. Default value is an empty string.\n\t * @param {number|null} [expiryDays=null] - The number of days until the cookie expires. If not provided, the cookie will last until the end of the session.\n\t * @returns {void}\n\t *\n\t * @example\n\t * // This will create a cookie \"username\" with the value \"JohnDoe\" that expires in 7 days\n\t * pmw.setCookie(\"username\", \"JohnDoe\", 7);\n\t */\n\tpmw.setCookie = (cookieName, cookieValue = \"\", expiryDays = null) => {\n\n\t\tif (expiryDays) {\n\n\t\t\tlet d = new Date();\n\t\t\td.setTime(d.getTime() + (expiryDays * 24 * 60 * 60 * 1000));\n\t\t\tlet expires     = \"expires=\" + d.toUTCString();\n\t\t\tdocument.cookie = cookieName + \"=\" + cookieValue + \";\" + expires + \";path=/\";\n\t\t} else {\n\t\t\tdocument.cookie = cookieName + \"=\" + cookieValue + \";path=/\";\n\t\t}\n\t};\n\n\t/**\n\t * Retrieves the value of a specific cookie from the document's cookie string.\n\t *\n\t * @param {String} cookieName - The name of the cookie to retrieve.\n\t * @returns {String} - The value of the cookie if found, an empty string otherwise.\n\t *\n\t * @example\n\t * // returns 'value' if 'cookieName=value' exists in document.cookie\n\t * pmw.getCookie('cookieName')\n\t */\n\tpmw.getCookie = cookieName => {\n\n\t\tlet name          = cookieName + \"=\";\n\t\tlet decodedCookie = decodeURIComponent(document.cookie);\n\t\tlet ca            = decodedCookie.split(\";\");\n\n\t\tfor (let i = 0; i < ca.length; i++) {\n\n\t\t\tlet c = ca[i];\n\n\t\t\twhile (c.charAt(0) == \" \") {\n\t\t\t\tc = c.substring(1);\n\t\t\t}\n\n\t\t\tif (c.indexOf(name) == 0) {\n\t\t\t\treturn c.substring(name.length, c.length);\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t};\n\n\t/**\n\t * Find and get the cookie with a name that contains the string.\n\t * If one is found, then return the cookie.\n\t * If none is found, then return false.\n\t *\n\t * @param string\n\t * @returns {boolean|string}\n\t *\n\t * @since 1.32.5\n\t */\n\tpmw.getCookieThatContainsRegex = (regex) => {\n\n\t\tlet cookies = document.cookie.split(\";\");\n\n\t\tfor (let i = 0; i < cookies.length; i++) {\n\t\t\tlet cookie = cookies[i].trim();\n\n\t\t\tif (regex.test(cookie)) {\n\t\t\t\treturn cookie;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tpmw.deleteCookie = cookieName => {\n\t\tpmw.setCookie(cookieName, \"\", -1);\n\t};\n\n\t/**\n\t * Store data in the browser\n\t *\n\t * Try to store the data in the local storage (session or persistent) if available.\n\t * If not available, store the data in the cookie.\n\t *\n\t * Max cookie expiry is 400 days as specified by Google Chrome: https://developer.chrome.com/blog/cookie-max-age-expires/\n\t *\n\t * @param key\n\t * @param value\n\t * @param persistent\n\t * @param extension - If true, this will be saved in a separate key\n\t */\n\tpmw.storeData = (key, value, persistent = false, extension = false) => {\n\n\t\tconst suffix = extension ? key : \"\";\n\n\t\tlet dataGetter = persistent ? pmw.getPersistentData : pmw.getSessionData;\n\t\tlet dataSetter = persistent ? pmw.setPersistentData : pmw.setSessionData;\n\n\t\tlet data = dataGetter(suffix);\n\t\textension ? data = value : data[key] = value;\n\n\t\tdataSetter(data, suffix);\n\t};\n\n\tpmw.retrieveData = (key, persistent = false, extension = false) => {\n\n\t\tconst suffix = extension ? key : \"\";\n\n\t\tlet data = persistent ? pmw.getPersistentData(suffix) : pmw.getSessionData(suffix);\n\n\t\treturn extension ? data : data[key];\n\t};\n\n\tpmw.deleteDataKey = (key, persistent = false, extension = false) => {\n\n\t\tconst suffix = extension ? key : \"\";\n\n\t\tlet dataGetter = persistent ? pmw.getPersistentData : pmw.getSessionData;\n\t\tlet dataSetter = persistent ? pmw.setPersistentData : pmw.setSessionData;\n\n\t\tlet data = dataGetter(suffix);\n\t\t// extension ? delete data : delete data[key]\n\n\t\tif (extension) {\n\n\t\t\ttry {\n\t\t\t\tif (persistent && window.localStorage) window.localStorage.removeItem(pmw.getPersistentDataKey(suffix));\n\t\t\t\tif (!persistent && window.sessionStorage) window.sessionStorage.removeItem(pmw.getSessionDataKey(suffix));\n\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tdelete data[key];\n\n\t\tdataSetter(data, suffix);\n\t};\n\n\tpmw.storeCartData = data => {\n\t\tpmw.storeData(\"cart\", data, false, true);\n\t};\n\n\tpmw.retrieveCartData = () => {\n\t\treturn pmw.retrieveData(\"cart\", false, true);\n\t};\n\n\tpmw.getSessionDataKey = (suffix = \"\") => {\n\t\tconst defaultStorageKey = \"_pmw_session_data\";\n\n\t\tif (suffix) {\n\t\t\treturn defaultStorageKey + \"_\" + suffix;\n\t\t}\n\n\t\treturn defaultStorageKey;\n\t};\n\n\tpmw.getPersistentDataKey = (storageKeySuffix) => {\n\n\t\tconst defaultStorageKey = \"_pmw_persistent_data\";\n\n\t\tif (storageKeySuffix) {\n\t\t\treturn defaultStorageKey + \"_\" + storageKeySuffix;\n\t\t}\n\n\t\treturn defaultStorageKey;\n\t};\n\n\tpmw.getSessionData = (suffix = \"\") => {\n\n\t\tif (window.sessionStorage) {\n\n\t\t\tlet data = window.sessionStorage.getItem(pmw.getSessionDataKey(suffix));\n\n\t\t\treturn data !== null ? JSON.parse(data) : {};\n\t\t} else {\n\t\t\t// fallback to cookie\n\t\t\tlet data = pmw.getCookie(pmw.getSessionDataKey(suffix));\n\n\t\t\treturn data !== \"\" ? JSON.parse(data) : {};\n\t\t}\n\t};\n\n\tpmw.setSessionData = (data, storageKeySuffix = \"\") => {\n\t\tif (window.sessionStorage) {\n\t\t\twindow.sessionStorage.setItem(pmw.getSessionDataKey(storageKeySuffix), JSON.stringify(data));\n\t\t} else {\n\t\t\t// fallback to cookie\n\t\t\tpmw.setCookie(pmw.getSessionDataKey(storageKeySuffix), JSON.stringify(data));\n\t\t}\n\t};\n\n\tpmw.getPersistentData = (storageKeySuffix) => {\n\n\t\tif (window.localStorage) {\n\n\t\t\tlet data = window.localStorage.getItem(pmw.getPersistentDataKey(storageKeySuffix));\n\n\t\t\treturn data !== null ? JSON.parse(data) : {};\n\t\t} else {\n\t\t\t// fallback to cookie\n\t\t\tlet data = pmw.getCookie(pmw.getPersistentDataKey(storageKeySuffix));\n\n\t\t\treturn data !== \"\" ? JSON.parse(data) : {};\n\t\t}\n\t};\n\n\tpmw.setPersistentData = (data, storageKeySuffix = \"\") => {\n\n\t\tif (window.localStorage) {\n\t\t\twindow.localStorage.setItem(pmw.getPersistentDataKey(storageKeySuffix), JSON.stringify(data));\n\t\t} else {\n\t\t\t// fallback to cookie\n\t\t\tpmw.setCookie(pmw.getPersistentDataKey(storageKeySuffix), JSON.stringify(data), 400);\n\t\t}\n\t};\n\n\tpmw.storeOrderIdOnServer = async (orderDetails) => {\n\n\t\ttry {\n\n\t\t\tlet response;\n\n\t\t\tif (await pmw.isRestEndpointAvailable()) {\n\n\t\t\t\tresponse = await fetch(pmw.root + \"pmw/v1/pixels-fired/\", {\n\t\t\t\t\tmethod   : \"POST\",\n\t\t\t\t\theaders  : {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t\t// \"X-WP-Nonce\"  : pmw.nonce_wp_rest,\n\t\t\t\t\t},\n\t\t\t\t\tbody     : JSON.stringify({\n\t\t\t\t\t\torder_id : orderDetails.orderId,\n\t\t\t\t\t\torder_key: orderDetails.orderKey,\n\t\t\t\t\t\tsource   : orderDetails.source,\n\t\t\t\t\t\t// nonce   : pmw.pmw_nonce,\n\t\t\t\t\t}),\n\t\t\t\t\tkeepalive: true,\n\t\t\t\t\tcache    : \"no-cache\",\n\t\t\t\t\tredirect : \"error\",\n\t\t\t\t});\n\n\t\t\t} else {\n\n\t\t\t\tpmw.console.log(\"REST API not available, falling back to AJAX\");\n\n\t\t\t\t// save the state in the database\n\n\t\t\t\t// Send the data object with ajax request\n\t\t\t\t// and log success or error using fetch API and url encoded\n\t\t\t\tresponse = await fetch(pmw.ajax_url, {\n\t\t\t\t\tmethod   : \"POST\",\n\t\t\t\t\tbody     : new URLSearchParams({\n\t\t\t\t\t\taction   : \"pmw_purchase_pixels_fired\",\n\t\t\t\t\t\torder_id : orderDetails.orderId,\n\t\t\t\t\t\torder_key: orderDetails.orderKey,\n\t\t\t\t\t\tsource   : orderDetails.source,\n\t\t\t\t\t\t// nonce_ajax: pmw.nonce_ajax,\n\t\t\t\t\t}),\n\t\t\t\t\tkeepalive: true,\n\t\t\t\t\tredirect : \"error\",\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst responseJson = await response.json();\n\n\t\t\tif (responseJson.success) {\n\t\t\t\tpmw.console.log(\"\", responseJson.data);\n\t\t\t} else {\n\t\t\t\tpmw.console.error(\"\", responseJson.data);\n\t\t\t}\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tpmw.getProductIdByCartItemElement = element => {\n\n\t\tconst href = jQuery(element).find(\".product-remove\").find(\"a\").attr(\"href\");\n\t\tif (href) return pmw.getProductIdByCartItemKeyUrl(new URL(href));\n\n\t\tconst productId = jQuery(element).find(\"[data-product_id]\").first().attr(\"data-product_id\");\n\t\treturn productId ? productId : null;\n\t};\n\n\tpmw.getProductQuantityByCartItemElement = element => {\n\n\t\treturn jQuery(element).find(\".qty\").val() || null;\n\t};\n\n\tpmw.getProductIdByCartItemKeyUrl = url => {\n\n\t\tlet searchParams = new URLSearchParams(url.search);\n\t\tlet cartItemKey  = searchParams.get(\"remove_item\");\n\n\t\tlet productId;\n\n\t\tif (pmwDataLayer.cart_item_keys[cartItemKey][\"variation_id\"] === 0) {\n\t\t\tproductId = pmwDataLayer.cart_item_keys[cartItemKey][\"product_id\"];\n\t\t} else {\n\t\t\tproductId = pmwDataLayer.cart_item_keys[cartItemKey][\"variation_id\"];\n\t\t}\n\n\t\treturn productId;\n\t};\n\n\tpmw.getAddToCartLinkProductIds = () =>\n\t\tjQuery(\"a\").map(function () {\n\t\t\tlet href = jQuery(this).attr(\"href\");\n\n\t\t\tif (href && href.includes(\"?add-to-cart=\")) {\n\t\t\t\tlet matches = href.match(/(add-to-cart=)(\\d+)/);\n\t\t\t\tif (matches) return matches[2];\n\t\t\t}\n\t\t}).get();\n\n\tpmw.getProductDetailsFormattedForEvent = (productId, quantity = 1) => {\n\n\t\t// If pmwDataLayer.products[productId] doesn't exist, return an empty object\n\t\tif (!pmwDataLayer.products[productId]) return null;\n\n\t\tlet product = {\n\t\t\tid           : productId.toString(),\n\t\t\tdyn_r_ids    : pmwDataLayer.products[productId].dyn_r_ids,\n\t\t\tname         : pmwDataLayer.products[productId].name,\n\t\t\tlist_name    : pmwDataLayer.shop.list_name,\n\t\t\tbrand        : pmwDataLayer.products[productId].brand,\n\t\t\tcategory     : pmwDataLayer.products[productId].category,\n\t\t\tvariant      : pmwDataLayer.products[productId].variant,\n\t\t\tlist_position: pmwDataLayer.products[productId].position,\n\t\t\tquantity     : quantity,\n\t\t\tprice        : pmwDataLayer.products[productId].price,\n\t\t\tcurrency     : pmwDataLayer.shop.currency,\n\t\t\tis_variable  : pmwDataLayer.products[productId].is_variable,\n\t\t\tis_variation : pmwDataLayer.products[productId].is_variation,\n\t\t\tparent_id    : pmwDataLayer.products[productId].parent_id,\n\t\t};\n\n\t\tif (product.is_variation) product[\"parent_id_dyn_r_ids\"] = pmwDataLayer.products[productId].parent_id_dyn_r_ids;\n\n\t\treturn product;\n\t};\n\n\tpmw.getClidFromBrowser = (clidId = \"gclid\") => {\n\n\t\tlet clidCookieId;\n\n\t\tclidCookieId = {\n\t\t\tgclid: \"_gcl_aw\",\n\t\t\tdclid: \"_gcl_dc\",\n\t\t};\n\n\t\tif (pmw.getCookie(clidCookieId[clidId])) {\n\n\t\t\tlet clidCookie = pmw.getCookie(clidCookieId[clidId]);\n\t\t\tlet matches    = clidCookie.match(/(GCL.[\\d]*.)(.*)/);\n\t\t\treturn matches[2];\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t};\n\n\tpmw.getUserAgent = () => navigator.userAgent;\n\n\tpmw.getViewPort = () => ({\n\t\twidth : Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0),\n\t\theight: Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0),\n\t});\n\n\n\tpmw.consoleLogVersion = () => {\n\t\tconsole.log(pmwDataLayer.version);\n\t};\n\n\t/**\n\t * Loads a script and caches it using native browser caching.\n\t *\n\t * Uses script tag injection which:\n\t * - Leverages browser's HTTP cache (respects Cache-Control headers)\n\t * - Avoids CORS preflight issues (no custom headers sent)\n\t * - Auto-executes the script on load\n\t * - Prevents duplicate script loading\n\t *\n\t * This code is .thenable\n\t */\n\n\tconst loadedScripts = new Set();\n\n\tpmw.loadScriptAndCacheIt = (url, fallbackUrl) => {\n\n\t\t// Return resolved promise if script already loaded\n\t\tif (loadedScripts.has(url)) {\n\t\t\tpmw.console.log(\"Script already loaded: \" + url);\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst loadScript = (scriptUrl) => {\n\t\t\treturn new Promise((resolve, reject) => {\n\n\t\t\t\t// Check if script tag already exists in DOM\n\t\t\t\tif (document.querySelector(`script[src=\"${scriptUrl}\"]`)) {\n\t\t\t\t\tloadedScripts.add(scriptUrl);\n\t\t\t\t\tpmw.console.log(\"Script tag already exists: \" + scriptUrl);\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst script       = document.createElement(\"script\");\n\t\t\t\tscript.src         = scriptUrl;\n\t\t\t\tscript.async       = true;\n\t\t\t\tscript.crossOrigin = \"anonymous\"; // Enables CORS without sending credentials, avoids preflight issues\n\n\t\t\t\tscript.onload = () => {\n\t\t\t\t\tloadedScripts.add(scriptUrl);\n\t\t\t\t\tpmw.console.log(\"Successfully loaded script: \" + scriptUrl);\n\t\t\t\t\tresolve();\n\t\t\t\t};\n\n\t\t\t\tscript.onerror = () => {\n\t\t\t\t\tscript.remove(); // Clean up failed script tag\n\t\t\t\t\treject(new Error(\"Script failed to load: \" + scriptUrl));\n\t\t\t\t};\n\n\t\t\t\tdocument.head.appendChild(script);\n\t\t\t});\n\t\t};\n\n\t\treturn loadScript(url)\n\t\t\t.catch(() => {\n\t\t\t\tif (fallbackUrl) {\n\t\t\t\t\tpmw.console.log(\"Primary script failed, loading fallback: \" + fallbackUrl);\n\t\t\t\t\treturn loadScript(fallbackUrl);\n\t\t\t\t}\n\t\t\t\tthrow new Error(\"Primary script failed to load, and no fallback URL provided.\");\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tif (error.message.includes(\"fallback\")) {\n\t\t\t\t\tthrow error; // Re-throw if it's already the \"no fallback\" error\n\t\t\t\t}\n\t\t\t\tthrow new Error(\"Both primary and fallback scripts failed to load.\");\n\t\t\t});\n\t};\n\n\tpmw.getOrderItemPrice = orderItem => (orderItem.total + orderItem.total_tax) / orderItem.quantity;\n\n\tpmw.hasLoginEventFired = () => {\n\t\tlet data = pmw.getSessionData();\n\t\treturn data?.loginEventFired;\n\t};\n\n\tpmw.setLoginEventFired = () => {\n\t\tlet data                = pmw.getSessionData();\n\t\tdata[\"loginEventFired\"] = true;\n\t\tpmw.setSessionData(data);\n\t};\n\n\tpmw.pageLoaded = async () => new Promise(resolve => {\n\t\t(function waitForVar() {\n\t\t\tif (\"complete\" === document.readyState) return resolve();\n\t\t\tsetTimeout(waitForVar, 50);\n\t\t})();\n\t});\n\n\tpmw.pageReady = () => {\n\t\treturn new Promise(resolve => {\n\t\t\t(function waitForVar() {\n\t\t\t\tif (\"interactive\" === document.readyState || \"complete\" === document.readyState) return resolve();\n\t\t\t\tsetTimeout(waitForVar, 50);\n\t\t\t})();\n\t\t});\n\t};\n\n\tpmw.isMiniCartActive = () => {\n\t\tif (window.sessionStorage) {\n\t\t\tObject.keys(window.sessionStorage).forEach(key => {\n\t\t\t\tif (key.includes(\"wc_fragments\")) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tpmw.doesWooCommerceCartExist = () => document.cookie.includes(\"woocommerce_items_in_cart\");\n\n\tpmw.urlHasParameter = parameter => {\n\t\tlet urlParams = new URLSearchParams(window.location.search);\n\t\treturn urlParams.has(parameter);\n\t};\n\n\tpmw.getUrlParameter = parameter => {\n\t\tlet urlParams = new URLSearchParams(window.location.search);\n\t\treturn urlParams.get(parameter);\n\t};\n\n\t// https://stackoverflow.com/a/60606893/4688612\n\tpmw.hashAsync = (algo, str) => {\n\t\treturn crypto.subtle.digest(algo, new TextEncoder(\"utf-8\").encode(str)).then(buf => {\n\t\t\treturn Array.prototype.map.call(new Uint8Array(buf), x => ((\"00\" + x.toString(16)).slice(-2))).join(\"\");\n\t\t});\n\t};\n\n\tpmw.getCartValue = () => {\n\n\t\tlet value = 0;\n\n\t\tif (pmwDataLayer?.cart) {\n\n\t\t\tfor (const key in pmwDataLayer.cart) {\n\t\t\t\t// content_ids.push(pmwDataLayer.products[key].dyn_r_ids[pmwDataLayer.pixels.facebook.dynamic_remarketing.id_type])\n\n\t\t\t\tlet product = pmwDataLayer.cart[key];\n\n\t\t\t\tvalue += product.quantity * product.price;\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t};\n\n\t/**\n\t * Detect if the current URL contains at least one pattern\n\t *\n\t * @param patterns\n\t * @returns {boolean}\n\t */\n\tpmw.doesUrlContainPatterns = patterns => {\n\n\t\tfor (const pattern of patterns) {\n\t\t\tif (new RegExp(pattern).test(window.location.href)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Detect if the current URL contains at least one pattern that is on the tracking exclusion list\n\t *\n\t * https://www.linkedin.com/pulse/how-remove-google-robot-problem-via-gtm-facebook-pixel-hjelpdahl/\n\t * https://www.youtube.com/watch?v=b4I1ePZt8Z0\n\t *\n\t * @returns {boolean}\n\t */\n\tpmw.excludeDomainFromTracking = () => {\n\n\t\tlet exclude_domains = [\n\t\t\t\"appspot.com\",\n\t\t\t\"translate.google.com\",\n\t\t];\n\n\t\tif (pmwDataLayer?.general?.exclude_domains) {\n\t\t\texclude_domains = [...exclude_domains, ...pmwDataLayer.general.exclude_domains];\n\t\t}\n\n\t\t// Abort if URL contains excluded domains\n\t\tif (exclude_domains.some(domain => window.location.href.includes(domain))) {\n\t\t\tconsole.debug(\"Pixel Manager: Aborted due to excluded domain\");\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\t/**\n\t * Get a random event ID\n\t *\n\t * @param length\n\t * @return {string}\n\t */\n\tpmw.getRandomEventId = (length = 16) => {\n\t\tlet id = \"\";\n\t\twhile (id.length < length) {\n\t\t\tid += (Math.random() + 1).toString(36).substring(2);\n\t\t}\n\t\treturn id.substring(0, length);\n\t};\n\n\tpmw.pmwConsoleMessage = () => {\n\t\tlet message = \"Pixel Manager for WooCommerce: \";\n\t\tmessage += pmwDataLayer.version.pro ? \"pro\" : \"free\";\n\t\tmessage += \" | distro: \" + pmwDataLayer.version.distro;\n\t\tif (pmwDataLayer.version.distro === \"fms\" && pmwDataLayer.version.pro) {\n\t\t\tmessage += \" | active license: \" + (pmwDataLayer.version.eligible_for_updates ? \"yes\" : \"no\");\n\t\t}\n\t\tmessage += \" | version: \" + pmwDataLayer.version.number;\n\n\t\tif (pmwDataLayer.version.show === true) {\n\t\t\tconsole.log(message);\n\t\t} else {\n\t\t\tpmw.console.log(message);\n\t\t}\n\t};\n\n\tpmw.canLoadPremiumFeatures = () => {\n\t\treturn (pmwDataLayer.version.distro === \"fms\" && pmwDataLayer.version.pro && pmwDataLayer.version.eligible_for_updates) || pmwDataLayer.version.distro === \"wcm\";\n\t};\n\n\t/**\n\t * State if the pmw:dom:ready event has been fired\n\t *\n\t * @type {boolean}\n\t */\n\tlet pmwDomReadyFired = false;\n\n\n\t/**\n\t * Trigger the pmw:dom:ready event\n\t *\n\t * @returns {void}\n\t */\n\tpmw.triggerPmwDomReadyEvent = () => {\n\n\t\t// If the event has already been fired, return\n\t\tif (pmwDomReadyFired) return;\n\n\t\t// If the document is already loaded, fire the event\n\t\tif (document.readyState === \"complete\") {\n\t\t\tfirePmwDomReadyEvent();\n\t\t\treturn;\n\t\t}\n\n\t\t// Continue processing if the DOM has not yet been loaded\n\t\t// and attach the event listener to the DOMContentLoaded,\n\t\t// once through jQuery and once through the native DOM API\n\t\t// to maximize compatibility\n\n\t\t// If jQuery is available, use it to fire add the event listener\n\t\tjQuery(() => {\n\t\t\tfirePmwDomReadyEvent();\n\t\t});\n\n\t\t// Also add the event listener using the native DOM API\n\t\tdocument.addEventListener(\"DOMContentLoaded\", () => {\n\t\t\tfirePmwDomReadyEvent();\n\t\t}, true);\n\t};\n\n\t/**\n\t * Fire the pmw:dom:ready event\n\t *\n\t * @returns {void}\n\t */\n\tconst firePmwDomReadyEvent = () => {\n\n\t\t// If the event has already been fired, return\n\t\tif (pmwDomReadyFired) return;\n\n\t\t// Fire the event\n\t\tdocument.dispatchEvent(new Event(\"pmw:dom:ready\"));\n\n\t\t// Set the flag to true to indicate that the event has been fired\n\t\tpmwDomReadyFired = true;\n\t};\n\n\tpmw.getEmailFromTarget = target => {\n\n\t\t// Only try to add the clicked email if href is set\n\t\tif (target.href) {\n\n\t\t\t// Get the email from the link\n\t\t\t// But only if there is a valid email address in the link\n\t\t\t// Also, the href may contain other parameters, so we need to check for that and remove them\n\t\t\tlet email = target.href.replace(\"mailto:\", \"\");\n\n\n\t\t\tif (email.indexOf(\"?\") > -1) {\n\t\t\t\temail = email.split(\"?\")[0];\n\t\t\t}\n\n\t\t\t// Trim the email and remove all whitespaces\n\t\t\temail = email.replace(/\\s/g, \"\");\n\n\t\t\t// If the email is not empty and valid, add it to the data object\n\t\t\tif (email && pmw.isEmail(email)) {\n\t\t\t\treturn email;\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t};\n\n\tpmw.sendEventPayloadToServer = payload => {\n\t\tif (typeof pmw.sendEventPayloadToServerPremium === \"function\") {\n\t\t\tpmw.sendEventPayloadToServerPremium(payload);\n\t\t}\n\t};\n\n\t/**\n\t * Waits for all active pixels to load and then triggers the page view event.\n\t *\n\t * @return {Promise<unknown>}\n\t *\n\t * @since 1.49.0\n\t */\n\tpmw.waitForPixelsAndTriggerPageView = async () => {\n\n\t\treturn new Promise(resolve => {\n\n\t\t\t// Check if at least one pixel is active in the data layer\n\t\t\tif (!pmwDataLayer?.pixels) {\n\t\t\t\tpmw.console.error(\"pmwDataLayer or pmwDataLayer.pixels is not defined, triggering page view event immediately.\");\n\t\t\t\tdocument.dispatchEvent(new Event(\"pmw:page-view\"));\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet activePixels = pmwDataLayer?.general?.server_2_server?.pageview_event_s2s?.pixels || [];\n\n\t\t\t// This line filters the activePixels array, keeping only those pixel names that exist as keys\n\t\t\t// in the pmwDataLayer.pixels object (i.e., only pixels that are currently defined/active in the data layer)\n\t\t\tactivePixels = activePixels.filter(pixelName => pmwDataLayer.pixels[pixelName]);\n\n\t\t\t// If no pixels to check, trigger event immediately\n\t\t\tif (activePixels.length === 0) {\n\t\t\t\tpmw.console.log(\"No specific pixels to wait for, triggering page view event.\");\n\t\t\t\tdocument.dispatchEvent(new Event(\"pmw:page-view\"));\n\t\t\t\tresolve();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if all active pixels are loaded\n\t\t\tconst checkPixelsLoaded = () => {\n\t\t\t\tconst allLoaded = activePixels.every(pixelName =>\n\t\t\t\t\t!pmwDataLayer.pixels[pixelName] || pmwDataLayer.pixels[pixelName].loaded);\n\n\t\t\t\tif (allLoaded) {\n\t\t\t\t\t// pmw.console.log(\"All specified pixels to track s2s page-view events have been loaded. Triggering page-view event.\");\n\t\t\t\t\tdocument.dispatchEvent(new Event(\"pmw:page-view\"));\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\tsetTimeout(checkPixelsLoaded, 100);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tcheckPixelsLoaded();\n\t\t});\n\t};\n\n\tpmw.isWooCommerceActive = () => {\n\t\treturn !!pmwDataLayer.shop;\n\t};\n\n\t/**\n\t * Retrieves the product ID associated with a specific pixel.\n\t *\n\t * @param {string} pixelId - The ID of the pixel to get the product ID for.\n\t * @returns {string|null} - The product ID associated with the given pixel ID,\n\t *                          or null if no product ID is found.\n\t */\n\tpmw.getProductIdForSpecificPixel = (product, pixelName) => {\n\t\treturn String(product.dyn_r_ids[pmwDataLayer.pixels[pixelName].dynamic_remarketing.id_type]);\n\t};\n\n\tpmw.isInWooCommerceSesssion = () => {\n\n\t\tif (pmwDataLayer?.shop?.session_active) return true;\n\n\t\tlet regex           = new RegExp(\"woocommerce_cart_hash\");\n\t\tlet wcSessionCookie = pmw.getCookieThatContainsRegex(regex);\n\n\t\tif (wcSessionCookie) return true;\n\n\t\treturn false;\n\t};\n\n\tpmw.isNotInWooCommerceSesssion = () => {\n\t\treturn !pmw.isInWooCommerceSesssion();\n\t};\n\n\tpmw.makeFullUrl = url => {\n\n\t\t// Trim any leading or trailing whitespace\n\t\turl = url.trim();\n\n\t\t// Check if the URL already contains a protocol\n\t\tif (/^(http:\\/\\/|https:\\/\\/)/.test(url)) {\n\t\t\treturn url;\n\t\t}\n\n\t\t// Remove leading slashes\n\t\turl = url.replace(/^\\/+/, \"\");\n\n\t\t// Add 'https://' as default protocol\n\t\treturn \"https://\" + url;\n\t};\n\n\tpmw.registerShowVariationEventListener = () => {\n\t\tlet previousVariationId = null;\n\n\t\tjQuery(\".single_variation_wrap\").on(\"show_variation\", (event, variation) => {\n\n\t\t\t// Abort if lazy loading is enabled\n\t\t\t// if (pmwDataLayer?.general?.lazy_load_pmw) return;\n\n\t\t\ttry {\n\t\t\t\t// If variations_output is disabled, don't fire view_item events from show_variation\n\t\t\t\t// because the parent product view_item is already triggered on page load\n\t\t\t\tif (!pmwDataLayer?.shop?.variations_output) return;\n\n\t\t\t\tlet productId = pmw.getIdBasedOndVariationsOutputSetting(variation.variation_id);\n\n\t\t\t\tif (!productId) throw Error(\"Wasn't able to retrieve a productId\");\n\n\t\t\t\t// If the variation id is not the same as the previous one, run the function\n\t\t\t\tif (previousVariationId !== variation.variation_id) {\n\t\t\t\t\tpmw.triggerViewItemEventPrep(productId);\n\t\t\t\t\tpreviousVariationId = variation.variation_id;\n\t\t\t\t}\n\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Initializes the command queue for the application to ensure that commands\n\t * are queued and executed in a controlled manner. This function sets up\n\t * the underlying mechanism to manage and process commands effectively.\n\t *\n\t * Typically, the command queue is used by external developers\n\t * who want to make sure that their Pixel Manager API calls safely get executed,\n\t * no matter if the initialization order of the Pixel Manager is shuffled,\n\t * delayed, or lazy loaded.\n\t *\n\t * @since 1.49.0\n\t */\n\tpmw.initializeCommandQueue = () => {\n\n\t\tconst queue = window._pmwq = window._pmwq || [];\n\n\t\tqueue.forEach(function (fn) {\n\t\t\tif (typeof fn === \"function\") {\n\t\t\t\ttry {\n\t\t\t\t\tfn();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tpmw.console.error(\"Error executing queued command:\", e);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Override push to execute commands immediately now that PMW is ready\n\t\tqueue.push = function (fn) {\n\t\t\tif (typeof fn === \"function\") {\n\t\t\t\ttry {\n\t\t\t\t\tfn();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tpmw.console.error(\"Error executing command from queue:\", e);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n\n}(window.pmw = window.pmw || {}, jQuery));\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + {\"194\":\"wc-hooks\",\"264\":\"deprecated-functions\",\"526\":\"pixel-facebook\",\"625\":\"consent-management\",\"671\":\"pixel-google\",\"712\":\"pixel-crazyegg\",\"818\":\"pixel-hotjar\",\"968\":\"consent-api\",\"972\":\"doofinder-listener\"}[chunkId] + \".\" + {\"194\":\"c871cc71\",\"264\":\"08bc16f9\",\"526\":\"1aad8345\",\"625\":\"9d45b6cb\",\"671\":\"87d84819\",\"712\":\"badd0e8f\",\"818\":\"c3ec2dc3\",\"968\":\"c33d5439\",\"972\":\"5dc21f92\"}[chunkId] + \".chunk.min.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkPixel_Manager_for_WooCommerce\"] = self[\"webpackChunkPixel_Manager_for_WooCommerce\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * Run PMW main loader\n */\n\nconst main = async () => {\n\n\trequire(\"./pmw/functions_main\");\n\trequire(\"./version.js\");\n\n\t// Wait until jQuery is loaded\n\tawait pmw.jQueryExists();\n\n\t// Wait until pmwDataLayer is loaded\n\tawait pmw.dataLayerFullyLoaded();\n\n\t/**\n\t * Set webpack public path for chunk loading\n\t * This ensures chunks load correctly even when scripts are combined/moved \n\t * by optimization plugins (SiteGround, Autoptimize, WP Rocket, etc.)\n\t */\n\tif (pmwDataLayer?.general?.chunk_base_path) {\n\t\t// eslint-disable-next-line no-undef, camelcase\n\t\t__webpack_public_path__ = pmwDataLayer.general.chunk_base_path;\n\t}\n\n\t// wait 1000ms\n\t// await new Promise(resolve => setTimeout(resolve, 1000))\n\n\t// Load all essential scripts first\n\trequire(\"./pmw/functions_loader\");\n\t\n\t// Load new event filtering system\n\trequire(\"./pmw/hooks\");\n\trequire(\"./pmw/pixel-registry\");\n\trequire(\"./pmw/event-processor\");\n\n\t// Initialize command queue early so filters can be registered before events fire\n\tpmw.initializeCommandQueue();\n\n\t// Output PMW console message\n\tpmw.pmwConsoleMessage();\n\n\t// Load the consent management module as a chunk\n\tawait pmw.loadConsentModule();\n\tawait pmw.consent.load();\n\n\t// Doesn't work if we listen to pmw:dom:ready because it runs too late\n\t// (at the end of the main.js file)\n\t// TODO: Find out why that order is important and optimize it. It is also difficult to test. In Cypress it works just with \"pmw:dom:ready\"\n\tjQuery(() => {\n\t\trequire(\"./pmw/event_listeners_on_ready\");\n\t});\n\n\t// Load remaining event listeners\n\trequire(\"./pmw/event_listeners\");\n\t\n\t// Load doofinder listener as a chunk\n\timport(/* webpackChunkName: \"doofinder-listener\" */ \"./pmw/listeners/doofinder\");\n\n\tpmw.loadWcHooksFunctions();\n\n\t// Check if domain is excluded from tracking\n\t// If so, return\n\tif (pmw.excludeDomainFromTracking()) return;\n\n\t// Load pixels dynamically based on configuration\n\tconst pixelLoaders = [];\n\n\t// Load free pixels conditionally\n\tif (pmwDataLayer?.pixels?.google) {\n\t\tpixelLoaders.push(\n\t\t\timport(/* webpackChunkName: \"pixel-google\" */ \"./pixels/google/loader\")\n\t\t);\n\t}\n\t\n\tif (pmwDataLayer?.pixels?.facebook) {\n\t\tpixelLoaders.push(\n\t\t\timport(/* webpackChunkName: \"pixel-facebook\" */ \"./pixels/facebook/loader\")\n\t\t);\n\t}\n\t\n\tif (pmwDataLayer?.pixels?.hotjar) {\n\t\tpixelLoaders.push(\n\t\t\timport(/* webpackChunkName: \"pixel-hotjar\" */ \"./pixels/hotjar/loader\")\n\t\t);\n\t}\n\n\tif (pmwDataLayer?.pixels?.crazyegg) {\n\t\tpixelLoaders.push(\n\t\t\timport(/* webpackChunkName: \"pixel-crazyegg\" */ \"./pixels/crazyegg/loader\")\n\t\t);\n\t}\n\n\t// #if process.env.TIER === 'premium'\n// \t/**\n// \t *  Load premium pixels conditionally\n// \t */\n// \tif (pmw.canLoadPremiumFeatures()) {\n// \t\tpixelLoaders.push(\n// \t\t\timport(/* webpackChunkName: \"pmw-premium-events\" */ \"./pmw/event_listeners_premium\")\n// \t\t);\n// \n// \t\tif (pmwDataLayer?.pixels?.contentsquare) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-contentsquare\" */ \"./pixels/contentsquare/loader\")\n// \t\t\t);\n// \t\t}\n// \n// \t\tif (pmwDataLayer?.pixels?.adroll) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-adroll\" */ \"./pixels/adroll/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.linkedin) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-linkedin\" */ \"./pixels/linkedin/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.bing) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-microsoft\" */ \"./pixels/microsoft-ads/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.outbrain) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-outbrain\" */ \"./pixels/outbrain/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.pinterest) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-pinterest\" */ \"./pixels/pinterest/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.snapchat) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-snapchat\" */ \"./pixels/snapchat/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.taboola) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-taboola\" */ \"./pixels/taboola/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.tiktok) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-tiktok\" */ \"./pixels/tiktok/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.twitter) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-twitter\" */ \"./pixels/twitter/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.reddit) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-reddit\" */ \"./pixels/reddit/loader\")\n// \t\t\t);\n// \t\t}\n// \t\t\n// \t\tif (pmwDataLayer?.pixels?.vwo) {\n// \t\t\tpixelLoaders.push(\n// \t\t\t\timport(/* webpackChunkName: \"pixel-vwo\" */ \"./pixels/vwo/loader\")\n// \t\t\t);\n// \t\t}\n// \t}\n\t// #endif\n\n\t// Load all active pixels in parallel\n\tawait Promise.all(pixelLoaders);\n\n\t/** Load the deprecated functions as a chunk (if enabled) */\n\tif (pmwDataLayer?.general?.modules?.load_deprecated_functions !== false) {\n\t\tconst {loadDeprecatedFunctions} = await import(/* webpackChunkName: \"deprecated-functions\" */ \"./pmw/deprecated.mjs\");\n\t\tloadDeprecatedFunctions();\n\t}\n\n\t// Preload pixels\n\tdocument.dispatchEvent(new Event(\"pmw:load-pixels\"));\n\n\t// Trigger pmwLoad event\n\tdocument.dispatchEvent(new Event(\"pmwLoad\"));\n\n\t// Wait until page is loaded\n\tawait pmw.pageLoaded();\n\n\tdocument.dispatchEvent(new Event(\"pmw:ready\"));\n\tpmw.triggerPmwDomReadyEvent();\n\n\t// Check if the library version matches the PMW version that's installed on the server\n\tpmw.checkLibraryVersion();\n};\n\nmain();\n\n\n\n\n\n\n\n\n"],"names":["leafPrototypes","getProto","inProgress","dataWebpackPrefix","removeHtmlTagsAndWhitespace","string","replace","trim","jQuery","on","event","target","value","id","triggerAddShippingInfoEvent","slug","text","length","checkedShippingMethod","find","val","attr","shippingTier","document","trigger","paymentMethodChangeLogged","triggerAddPaymentInfoEvent","checkedPaymentMethod","paymentType","url","URL","currentTarget","productId","pmw","getProductIdByCartItemKeyUrl","removeProductFromCart","e","console","error","checkoutButtonSelectors","prepareSelectors","paymentMethodSelected","fireCheckoutProgress","fireCheckoutOption","initCart","pmwDataLayer","products","productIds","getAddToCartLinkProductIds","getProductsFromBackend","referrer","retrieveData","referrerHostname","hostname","window","location","host","storeData","gclid","getUrlParameter","wbraid","gbraid","fbclid","Math","floor","Date","now","ttclid","scid","epik","pmw_loaded","shop","page_type","product_type","getMainProductIdFromProductPage","product","getProductDataForViewItemEvent","variations_output","order","isOrderIdStored","writeOrderIdToStorage","key","acrRemoveCookie","user","hasLoginEventFired","setLoginEventFired","general","lazy_load_pmw","registerShowVariationEventListener","$variationForm","selectedValues","toArray","every","select","productVariations","data","matchingVariation","variation","Object","entries","attributes","triggerViewItemEventPrep","variation_id","async","log","payload","processEvent","server_2_server","pageview_event_s2s","is_active","pageViewS2SPixels","pixelRegistry","getPixelsWithCapability","s2sData","pixelName","pixels","keys","sendEventPayloadToServer","isWooCommerceActive","startIntersectionObserverToWatch","startProductsMutationObserverToWatch","waitForPixelsAndTriggerPageView","require","loadConsentModule","consentModule","consent","apiModule","api","message","objects","isLoggerEnabled","urlLoggerOff","sessionLoggerEnabled","urlLoggerOn","logger","urlHasParameter","util","ipRange_1","dot","mappedIpv4","colon","doubleColon","getIpv6Segments","ip","isIPv6","Error","test","matches","match","isIPv4","prefix","parts","split","map","x","parseInt","toString","mappedIpv4ToIpv6","_a","beforeChunk","afterChunk","beforeParts","afterParts","missingSegments","Array","concat","createChecker","subnetOrSubnets","isArray","checks_1","subnet","createSegmentChecker","address","segments","some","check","subnetAddress","prefixLengthString","prefixLength","Number","isInteger","subnetSegments","addressSegments","i","bitCount","min","exports","specialNetsCache","default","private","ipv6","localhost","Boolean","reserved","__spreadArrays","jQueryExists","Promise","resolve","waitForjQuery","setTimeout","waitForLibrary","library","timeout","interval","startTime","dataLayerFullyLoaded","checkVar","waitForVar","version","logTimeoutId","then","clearTimeout","wpHooksExists","wp","hooks","loadWcHooksFunctions","filters","addFilter","hookName","namespace","callback","priority","this","push","sort","a","b","applyFilters","args","filteredValue","filter","result","warn","removeFilter","initialLength","f","removeAllFilters","hasFilter","getFilters","IPv4","IPv6","util_1","isInSubnet","subnetsByVersion","reduce","acc","isIP","check4","check6","isIPv4MappedAddress","extractMappedIpv4","enumerable","get","isPrivate","isLocalhost","isReserved","isSpecial","getConsentContext","categories","statistics","marketing","preferences","necessary","visitor_has_chosen","settings","visitorHasChosen","explicit_mode","explicitConsentModeActive","getEventContext","timestamp","href","makeFullUrl","user_agent","navigator","userAgent","user_id","raw","eventName","eventData","event_data","context","activePixels","getActivePixels","adapter","getAdapter","adapt","pixelData","firing","getFiringDecision","dispatchToPixels","dispatchUnifiedEvent","dispatchPublicEvent","active","extractS2SData","serverPixels","getPixelsForServerFiring","firingStatus","dispatchToBrowserPixels","browserPixels","getActiveBrowserOnlyPixels","browserEventName","dispatchToS2SPixels","s2sPixels","getActiveS2SPixels","s2sEventName","publicEventName","shouldFireBrowserPixel","fire_browser","shouldFireServerPixel","fire_server","adapters","registerAdapter","options","pixelCapabilities","defaultMode","supportsS2S","mode","supportsEventDeduplication","isActive","$","undefined","isRange","isV4","isV6","getIpVersion","ipDetectionPromise","ipDetectionResolved","ipServices","fetchWithTimeout","timeoutMs","controller","AbortController","timeoutId","abort","fetch","signal","finally","getGeoInfo","cloudflare","response","ok","status","obj","pair","loc","processRegion","countryCode","service","geojs","json","country_code","region","ipinfo","country","ipapi","consent_management","restricted_regions","includes","isVisitorAllowed","JSON","parse","isBotUserAgent","ip_exclude_list","getIp","isOnIpExclusionList","isValidIpAddress","isPrivateOrReservedIp","privateRanges","range","startsWith","second","getClientIp","cachedIp","ipv6Promise","getIpWithTimeout","anyPromise","ipv6Result","anyResult","allSettled","ipVersion","race","_","reject","catch","maxServicesToCheck","validVersions","join","ipv","getIpFromAnyService","getBrowserGeoFromExternalService","performance","promises","forEach","any","toUpperCase","regionCode","toFixed","getBrowserGeo","geoFromStorage","geoInfo","gepLocationByTimeZone","getBrowserLocationByTimeZone","geoLocation","getLocationByTimeZone","ipServicesFiltered","slice","getIpFromService","timeTaken","serviceResponseData","isVisitorNotAllowed","botPatterns","getBotPatterns","pattern","toLowerCase","customPatterns","user_agent_exclude_patterns","isCidr","ipName","ipExcludeList","timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","ipv4","addToCartSelectors","quantity","dataset","product_id","addProductToCart","indexOf","each","index","element","classes","getPostIdFromString","one","closest","origin","searchParams","has","nextAll","getIdBasedOndVariationsOutputSetting","getProductDetailsFormattedForEvent","isEmail","emailSelected","getProductIdByCartItemElement","getProductQuantityByCartItemElement","cart","getCartItemsFromBackend","getLibraryVersion","checkLibraryVersion","number","VALID_FIRING_MODES","capabilities","capabilityName","pixelsWithCapability","getFiringMode","s2sEnabled","decision","getPixelsForBrowserFiring","v4Seg","v4Str","IPv4Reg","RegExp","v6Seg","IPv6Reg","s","ipv4ToLong","octets","createLongChecker","addressLong","subnetLong","expandIPv6","ipaddr","ipv4Part","ipv4Regexes","ipv6Part","ipv6Regexes","matchCIDR","zoneIndex","module","first","partSize","cidrBits","part","shift","subnetMatch","rangeList","defaultName","k","len","rangeName","rangeSubnets","kind","apply","octet","prototype","toNormalizedString","toByteArray","other","cidrRange","ref","SpecialRanges","unspecified","broadcast","multicast","linkLocal","loopback","carrierGradeNat","toIPv4MappedAddress","prefixLengthFromSubnetMask","cidr","stop","zeros","zerotable","fourOctet","longValue","parser","parseIntAuto","results","reverse","zoneId","l","toRFC5952String","bestMatchIndex","bestMatchLength","regex","exec","substring","bytes","addr","suffix","call","toFixedLengthString","padStart","uniqueLocal","ipv4Mapped","rfc6145","rfc6052","teredo","toIPv4Address","high","low","transitional","colonCount","lastColon","replacement","replacementCount","lastIndexOf","substr","isValid","error1","isValidFourPartDecimal","parseCIDR","maskLength","parsed","defineProperty","subnetMaskFromPrefixLength","filledOctetCount","j","pow","broadcastAddressFromCIDR","ipInterfaceOctets","subnetMaskOctets","networkAddressFromCIDR","fromByteArray","process","commonjsGlobal","normalize","_validate","nh","sections","n","h","ns","hs","_leftPad","abbreviate","zPreviousFlag","zeroStartIndex","zeroLength","zStartIndex","zLength","section","zFlag","splice","d","p","padding","repeat","_hex2bin","hex","_bin2hex","bin","_addr2bin","binAddr","_bin2addr","binPart","hexSection","divideSubnet","mask0","mask1","limit","abbr","ret","binNetPart","binHostPart","numSubnets","binSubnet","hexAddr","binStartAddr","binEndAddr","start","end","size","randomSubnet","random","ptr","mask","err","inRange","check_range","ip6","range_data","parse_addr","parse_range","storeIP","displayIP","pmwRestSettings","isBelowRestErrorThreshold","isRestEndpointAvailable","testEndpoint","root","cookieName","method","cache","keepalive","redirect","responseJson","success","stringify","isPmwRestEndpointAvailable","orderId","orderKey","source","orderIds","storeOrderIdOnServer","order_duplication_prevention","email","quantityToRemove","storeCartData","is_variation","parent_id","selectors","type","Set","doesWooCommerceCartExist","retrieveCartData","saveCartObjectToDataLayer","ajax_url","body","URLSearchParams","action","cart_item_keys","assign","page_id","product_ids","headers","statusText","responseData","cartObject","triggerViewItemEvent","triggerViewItemEventNoProduct","step","checkout_option","triggerViewItemList","viewItemListTriggerTestMode","css","append","view_item_list_trigger","opacity","background_color","getSearchTermFromUrl","search","io","ioTimeouts","observerCallback","observer","entry","elementId","next","isIntersecting","test_mode","unobserve","remove","ioid","detectedProductTemplateClasses","nested","flat","isNestedClass","elem","className","isFlatClass","prev","hasClass","getAllElementsToWatch","getCommonIdentifiersToWatch","listOfClassNames","haveSameNestingDepth","element1","element2","parents","findCommonParentElement","parent","is","node","countOfChildren","getCommonClass","classes1","classes2","pmwProductIds","querySelectorAll","productsNode","firstChildClassAttr","children","firstChildClasses","secondChildClassAttr","commonClass","firstProductTemplateClasses","IntersectionObserver","threshold","observe","productsMutationObserver","childList","characterData","MutationObserver","mutations","mutation","newNodes","addedNodes","hasPmwProductIdElement","siblings","setCookie","cookieValue","expiryDays","setTime","getTime","expires","toUTCString","cookie","getCookie","name","ca","decodeURIComponent","c","charAt","getCookieThatContainsRegex","cookies","deleteCookie","persistent","extension","dataGetter","getPersistentData","getSessionData","dataSetter","setPersistentData","setSessionData","deleteDataKey","localStorage","removeItem","getPersistentDataKey","sessionStorage","getSessionDataKey","defaultStorageKey","storageKeySuffix","getItem","setItem","order_id","orderDetails","order_key","cartItemKey","dyn_r_ids","list_name","brand","category","variant","list_position","position","price","currency","is_variable","parent_id_dyn_r_ids","getClidFromBrowser","clidId","clidCookieId","dclid","getUserAgent","getViewPort","width","max","documentElement","clientWidth","innerWidth","height","clientHeight","innerHeight","consoleLogVersion","loadedScripts","loadScriptAndCacheIt","fallbackUrl","loadScript","scriptUrl","querySelector","add","script","createElement","src","crossOrigin","onload","onerror","head","appendChild","getOrderItemPrice","orderItem","total","total_tax","loginEventFired","pageLoaded","readyState","pageReady","isMiniCartActive","parameter","hashAsync","algo","str","crypto","subtle","digest","TextEncoder","encode","buf","Uint8Array","getCartValue","doesUrlContainPatterns","patterns","excludeDomainFromTracking","exclude_domains","domain","debug","getRandomEventId","pmwConsoleMessage","pro","distro","eligible_for_updates","show","canLoadPremiumFeatures","pmwDomReadyFired","triggerPmwDomReadyEvent","firePmwDomReadyEvent","addEventListener","dispatchEvent","Event","getEmailFromTarget","sendEventPayloadToServerPremium","checkPixelsLoaded","loaded","getProductIdForSpecificPixel","String","dynamic_remarketing","id_type","isInWooCommerceSesssion","session_active","isNotInWooCommerceSesssion","previousVariationId","initializeCommandQueue","queue","_pmwq","fn","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","getPrototypeOf","t","__esModule","create","r","def","current","getOwnPropertyNames","definition","o","chunkId","all","u","g","globalThis","Function","prop","hasOwnProperty","done","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","setAttribute","onScriptComplete","doneFns","parentNode","removeChild","bind","Symbol","toStringTag","importScripts","currentScript","tagName","installedChunks","installedChunkData","promise","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","self","chunk_base_path","__webpack_public_path__","load","pixelLoaders","google","facebook","hotjar","crazyegg","modules","load_deprecated_functions","loadDeprecatedFunctions","main"],"ignoreList":[],"sourceRoot":""}