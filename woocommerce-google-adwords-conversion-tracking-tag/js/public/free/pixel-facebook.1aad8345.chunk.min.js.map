{"version":3,"file":"pixel-facebook.1aad8345.chunk.min.js","mappings":"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","sources":["webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pixels/facebook/event_listeners.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pixels/facebook/functions.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pixels/facebook/adapter.js","webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pixels/facebook/loader.js"],"sourcesContent":["/**\n * Facebook Pixel Event Listeners\n *\n * Uses the unified event system (pmw:*) with firing decisions.\n * Checks payload.firing.facebook.fire_browser before firing the browser pixel.\n *\n * @see https://developers.facebook.com/docs/meta-pixel/reference\n */\n\n// Load pixel event\njQuery(document).on(\"pmw:load-pixels\", () => {\n\n\tif (\n\t\tpmwDataLayer?.pixels?.facebook?.pixel_id\n\t\t&& !pmwDataLayer?.pixels?.facebook?.loaded\n\t\t&& !pmw.doesUrlContainPatterns(pmwDataLayer?.pixels?.facebook?.exclusion_patterns)\n\t) {\n\t\tif (pmw.consent.canPixelBeFired(\"marketing\", \"Facebook\")) pmw.loadFacebookPixel();\n\t}\n});\n\n// PageView event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:page-view\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) {\n\t\t\tpmw.console.log(\"Facebook: No data in payload for page_view event\");\n\t\t\treturn;\n\t\t}\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\t// pmw.console.log(\"Facebook: PageView event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// AddToCart event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:add-to-cart\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) {\n\t\t\tpmw.console.log(\"Facebook: No data in payload for add_to_cart event\");\n\t\t\treturn;\n\t\t}\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: AddToCart event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// InitiateCheckout event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:begin-checkout\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: InitiateCheckout event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// AddPaymentInfo event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:add-payment-info\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(`Facebook Pixel: ${facebookData.event_name} event sent`, facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// AddToWishlist event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:add-to-wishlist\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: AddToWishlist event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// ViewContent event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:view-item\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: ViewContent event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n\n// view search event\n// https://developers.facebook.com/docs/meta-pixel/reference\njQuery(document).on(\"pmw:pixel:search\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: Search event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// load always event\njQuery(document).on(\"pmw:load-always\", () => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\n\t\tpmw.setFbUserData();\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\n// view order received page event\n// https://developers.facebook.com/docs/meta-pixel/reference\n// Note: Server-side transmission is handled via PHP CAPI, this only fires the browser pixel\njQuery(document).on(\"pmw:pixel:purchase\", (event, payload) => {\n\n\ttry {\n\t\tif (pmw.canNotFireFbq()) return;\n\t\tif (!pmw.shouldFireBrowserPixel(payload, \"facebook\")) return;\n\n\t\tconst facebookData = payload.pixels?.facebook;\n\t\tif (!facebookData) return;\n\n\t\tfbq(\"track\", facebookData.event_name, facebookData.custom_data, {\n\t\t\teventID: facebookData.event_id,\n\t\t});\n\t\tpmw.console.log(\"Facebook Pixel: Purchase event sent\", facebookData);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n});\n\ndocument.addEventListener(\"pmw:consent:update\", ({detail}) => {\n\n\tconst consent = detail;\n\n\ttry {\n\t\tif (!pmwDataLayer?.pixels?.facebook?.loaded) return;\n\n\t\tconst consentUpdate = consent.marketing ? \"grant\" : \"revoke\";\n\n\t\tfbq(\"consent\", consentUpdate);\n\t\tpmw.console.log(`Facebook Consent Mode updated: ${consentUpdate}`);\n\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n}, true);\n","/**\n * Add functions for Facebook\n * */\n\n(function (pmw, $, undefined) {\n\n\tlet fbUserData\n\tlet fbpPromise = null\n\n\tpmw.fbeventsJsUrl = () => {\n\n\t\tlet searchParams = new URLSearchParams(window.location.search)\n\n\t\tif (searchParams.has(\"fbevents-version\")) {\n\t\t\treturn `https://connect.facebook.net/en_US/fbevents.js?v=${searchParams.get(\"fbevents-version\")}`\n\t\t}\n\n\t\treturn pmwDataLayer?.pixels?.facebook?.fbevents_js_url\n\t}\n\n\tpmw.loadFacebookPixel = () => {\n\n\t\ttry {\n\n\t\t\t// @formatter:off\n\t\t\t!function(f,b,e,v,n,t,s)\n\t\t\t{if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n\t\t\t\tn.callMethod.apply(n,arguments):n.queue.push(arguments)};\n\t\t\t\tif(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n\t\t\t\tn.queue=[];t=b.createElement(e);t.async=!0;\n\t\t\t\tt.src=v;s=b.getElementsByTagName(e)[0];\n\t\t\t\ts.parentNode.insertBefore(t,s)}(window, document,'script',\n\t\t\t\tpmw.fbeventsJsUrl());\n\t\t\t// @formatter:on\n\n\t\t\t// Add onload handler to cache user data after fbevents.js has loaded and set the _fbp cookie\n\t\t\tlet fbScript = document.querySelector('script[src*=\"fbevents.js\"]')\n\t\t\tif (fbScript) {\n\t\t\t\tfbScript.onload = () => {\n\t\t\t\t\tpmw.setFbUserData()\n\t\t\t\t}\n\t\t\t\tfbScript.onerror = () => {\n\t\t\t\t\tpmw.console.error(\"Facebook Pixel: fbevents.js failed to load\")\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet data = {}\n\n\t\t\t// Add user identifiers to data if advanced matching is enabled\n\t\t\tif (pmw.isFbAdvancedMatchingEnabled()) {\n\t\t\t\tdata = {...pmw.getUserIdentifiersForFb()}\n\t\t\t}\n\n\t\t\t// https://developers.facebook.com/docs/meta-pixel/advanced/#automatic-configuration\n\t\t\t// fbq(\"set\", \"autoConfig\", false, pmwDataLayer.pixels.facebook.pixel_id)\n\n\t\t\t// Initialize the Facebook Pixel and send the first PageView event\n\t\t\tfbq(\"init\", pmwDataLayer.pixels.facebook.pixel_id, data)\n\n\t\t\tif (pmwDataLayer?.pixels?.facebook?.mobile_bridge_app_id) {\n\t\t\t\tfbq(\"set\", \"mobileBridge\", pmwDataLayer.pixels.facebook.pixel_id, pmwDataLayer?.pixels?.facebook?.mobile_bridge_app_id)\n\t\t\t}\n\n\t\t\tpmwDataLayer.pixels.facebook.loaded = true\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e)\n\t\t}\n\t}\n\n\t// https://developers.facebook.com/docs/meta-pixel/advanced/advanced-matching\n\tpmw.getUserIdentifiersForFb = () => {\n\n\t\tlet data = {}\n\n\t\t// external ID\n\t\tif (pmwDataLayer?.user?.id?.raw) data.external_id = pmwDataLayer.user.id.raw\n\t\tif (pmwDataLayer?.order?.user_id) data.external_id = pmwDataLayer.order.user_id\n\n\t\t// email\n\t\tif (pmwDataLayer?.user?.email?.facebook) data.em = pmwDataLayer.user.email.facebook\n\t\tif (pmwDataLayer?.order?.billing_email_hashed) data.em = pmwDataLayer.order.billing_email_hashed\n\n\t\t// first name\n\t\tif (pmwDataLayer?.user?.first_name?.facebook) data.fn = pmwDataLayer.user.first_name.facebook\n\t\tif (pmwDataLayer?.order?.billing_first_name) data.fn = pmwDataLayer.order.billing_first_name.toLowerCase()\n\n\t\t// last name\n\t\tif (pmwDataLayer?.user?.last_name?.facebook) data.ln = pmwDataLayer.user.last_name.facebook\n\t\tif (pmwDataLayer?.order?.billing_last_name) data.ln = pmwDataLayer.order.billing_last_name.toLowerCase()\n\n\t\t// phone\n\t\tif (pmwDataLayer?.user?.phone?.facebook) data.ph = pmwDataLayer.user.phone.facebook\n\t\tif (pmwDataLayer?.order?.billing_phone) data.ph = pmwDataLayer.order.billing_phone.replace(\"+\", \"\")\n\n\t\t// city\n\t\tif (pmwDataLayer?.user?.city?.facebook) data.ct = pmwDataLayer.user.city.facebook\n\t\tif (pmwDataLayer?.order?.billing_city) data.ct = pmwDataLayer.order.billing_city.toLowerCase().replace(/ /g, \"\")\n\n\t\t// state\n\t\tif (pmwDataLayer?.user?.state?.facebook) data.st = pmwDataLayer.user.state.facebook\n\t\tif (pmwDataLayer?.order?.billing_state) data.st = pmwDataLayer.order.billing_state.toLowerCase().replace(/[a-zA-Z]{2}-/, \"\")\n\n\t\t// postcode\n\t\tif (pmwDataLayer?.user?.postcode?.facebook) data.zp = pmwDataLayer.user.postcode.facebook\n\t\tif (pmwDataLayer?.order?.billing_postcode) data.zp = pmwDataLayer.order.billing_postcode\n\n\t\t// country\n\t\tif (pmwDataLayer?.user?.country?.facebook) data.country = pmwDataLayer.user.country.facebook\n\t\tif (pmwDataLayer?.order?.billing_country) data.country = pmwDataLayer.order.billing_country.toLowerCase()\n\n\t\treturn data\n\t}\n\n\tpmw.getFbRandomEventId = () => (Math.random() + 1).toString(36).substring(2)\n\n\tpmw.getFbUserData = () => {\n\n\t\t/**\n\t\t * We need to cache the FB user data for InitiateCheckout\n\t\t * where getting the user data from the browser is too slow\n\t\t * using pmw.getCookie().\n\t\t *\n\t\t * And we need the object merge because the ViewContent hit happens too fast\n\t\t * after adding a variation to the cart because the function to cache\n\t\t * the user data is too slow.\n\t\t *\n\t\t * But we can get the user_data using pmw.getCookie()\n\t\t * because we don't move away from the page and can wait for the browser\n\t\t * to get it.\n\t\t *\n\t\t * Also, the merge ensures that new data will be added to fbUserData if new\n\t\t * data is being added later, like user ID, or fbc.\n\t\t */\n\n\t\tfbUserData = {...fbUserData, ...pmw.getFbUserDataFromBrowser()}\n\n\t\treturn fbUserData\n\t}\n\n\tpmw.isFbAdvancedMatchingEnabled = () => {\n\t\tif (pmwDataLayer?.pixels?.facebook?.advanced_matching) {\n\t\t\treturn true\n\t\t}\n\n\t\treturn false\n\t}\n\n\t/**\n\t * Wait for _fbp cookie to be available (with timeout).\n\t * Used on first pageview when fbevents.js hasn't written the cookie yet.\n\t * This is non-blocking - only the calling async function waits.\n\t *\n\t * @param {number} maxWait - Maximum wait time in ms (default 2000)\n\t * @param {number} interval - Check interval in ms (default 50)\n\t * @returns {Promise<string|null>}\n\t */\n\tpmw.waitForFbp = (maxWait = 2000, interval = 50) => {\n\n\t\t// Check if cookie already exists - return immediately\n\t\tlet existingFbp = pmw.getCookie(\"_fbp\")\n\t\tif (pmw.isValidFbp(existingFbp)) {\n\t\t\treturn Promise.resolve(existingFbp)\n\t\t}\n\n\t\t// Return cached promise if already waiting (prevents multiple pollers)\n\t\tif (fbpPromise) return fbpPromise\n\n\t\tfbpPromise = new Promise((resolve) => {\n\t\t\tlet elapsed = 0\n\n\t\t\tconst check = () => {\n\t\t\t\tlet fbp = pmw.getCookie(\"_fbp\")\n\n\t\t\t\tif (pmw.isValidFbp(fbp)) {\n\t\t\t\t\tpmw.console.log(\"Facebook Pixel: _fbp cookie found after \" + elapsed + \"ms\")\n\t\t\t\t\tfbpPromise = null // Reset for future use\n\t\t\t\t\tresolve(fbp)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\telapsed += interval\n\t\t\t\tif (elapsed >= maxWait) {\n\t\t\t\t\tpmw.console.log(\"Facebook Pixel: Timeout waiting for _fbp cookie after \" + maxWait + \"ms\")\n\t\t\t\t\tfbpPromise = null // Reset for future use\n\t\t\t\t\tresolve(null)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(check, interval)\n\t\t\t}\n\n\t\t\tcheck()\n\t\t})\n\n\t\treturn fbpPromise\n\t}\n\n\t/**\n\t * Set Facebook user data, waiting for _fbp cookie if not yet available.\n\t * This ensures we capture the _fbp value on first pageview.\n\t */\n\tpmw.setFbUserData = async () => {\n\t\tawait pmw.waitForFbp()\n\t\tfbUserData = pmw.getFbUserDataFromBrowser()\n\t}\n\n\tpmw.getFbUserDataFromBrowser = () => {\n\n\t\tlet data = {}\n\n\t\tlet fbp = pmw.getCookie(\"_fbp\")\n\t\tif (pmw.isValidFbp(fbp)) {\n\t\t\tdata.fbp = fbp\n\t\t}\n\n\t\tlet fbc = pmw.getCookie(\"_fbc\") || pmw.retrieveData(\"fbclid\")\n\t\tif (pmw.isValidFbc(fbc)) {\n\t\t\tdata.fbc = fbc\n\t\t}\n\n\t\tif (pmw.isFbAdvancedMatchingEnabled()) {\n\t\t\tif (pmwDataLayer?.user?.email?.facebook) data.em = pmwDataLayer.user.email.facebook\n\t\t\tif (pmwDataLayer?.user?.phone?.facebook) data.ph = pmwDataLayer.user.phone.facebook\n\t\t\tif (pmwDataLayer?.user?.first_name?.facebook) data.fn = pmwDataLayer.user.first_name.facebook\n\t\t\tif (pmwDataLayer?.user?.last_name?.facebook) data.ln = pmwDataLayer.user.last_name.facebook\n\t\t\tif (pmwDataLayer?.user?.city?.facebook) data.ct = pmwDataLayer.user.city.facebook\n\t\t\tif (pmwDataLayer?.user?.state?.facebook) data.st = pmwDataLayer.user.state.facebook\n\t\t\tif (pmwDataLayer?.user?.postcode?.facebook) data.zp = pmwDataLayer.user.postcode.facebook\n\t\t\tif (pmwDataLayer?.user?.country?.facebook) data.country = pmwDataLayer.user.country.facebook\n\t\t\tif (pmwDataLayer?.user?.id?.raw) data.external_id = pmwDataLayer.user.id.raw\n\t\t}\n\n\t\tif (navigator.userAgent) data.client_user_agent = navigator.userAgent\n\n\t\t// Add client IP address to user data (prefer IPv6, fall back to any IP)\n\t\t// Only use validated IPs for CAPI to ensure data quality\n\t\tconst clientIp = pmw.retrieveData(\"client_ip\") || pmw.retrieveData(\"ipv6\") || pmw.retrieveData(\"ip\")\n\t\tif (clientIp && pmw.isValidIpAddress && pmw.isValidIpAddress(clientIp)) {\n\t\t\tdata.client_ip_address = clientIp\n\t\t}\n\n\t\treturn data\n\t}\n\n\tpmw.isFbpSet = () => {\n\t\treturn !!pmw.getCookie(\"_fbp\")\n\t}\n\n\t// https://developers.facebook.com/docs/marketing-api/conversions-api/parameters/fbp-and-fbc/\n\tpmw.isValidFbp = fbp => {\n\n\t\tlet re = new RegExp(/^fb\\.[0-2]\\.\\d{13}\\.\\d{8,20}$/)\n\n\t\treturn re.test(fbp)\n\t}\n\n\t// https://developers.facebook.com/docs/marketing-api/conversions-api/parameters/fbp-and-fbc/\n\tpmw.isValidFbc = fbc => {\n\n\t\tlet re = new RegExp(/^fb\\.[0-2]\\.\\d{13}\\.[\\da-zA-Z_-]{8,}/)\n\n\t\treturn re.test(fbc)\n\t}\n\n\tpmw.fbGetProductDataForCapiEvent = product => {\n\t\treturn {\n\t\t\tcontent_type: \"product\",\n\t\t\tcontent_name: product.name,\n\t\t\tcontent_ids : [\n\t\t\t\tproduct.dyn_r_ids[pmwDataLayer.pixels.facebook.dynamic_remarketing.id_type],\n\t\t\t],\n\t\t\tvalue       : parseFloat(product.quantity * product.price),\n\t\t\tcurrency    : product.currency,\n\t\t}\n\t}\n\n\tpmw.facebookContentIds = () => {\n\t\tlet prodIds = []\n\n\t\tObject.values(pmwDataLayer.order.items).forEach(item => {\n\t\t\tif (pmwDataLayer?.shop?.variations_output && 0 !== item.variation_id) {\n\t\t\t\tprodIds.push(String(pmwDataLayer.products[item.variation_id].dyn_r_ids[pmwDataLayer.pixels.facebook.dynamic_remarketing.id_type]))\n\t\t\t} else {\n\t\t\t\tprodIds.push(String(pmwDataLayer.products[item.id].dyn_r_ids[pmwDataLayer.pixels.facebook.dynamic_remarketing.id_type]))\n\t\t\t}\n\t\t})\n\n\t\treturn prodIds\n\t}\n\n\tpmw.trackCustomFacebookEvent = (eventName, customData = {}) => {\n\t\ttry {\n\t\t\tif (!pmwDataLayer?.pixels?.facebook?.loaded) return\n\n\t\t\tlet eventId = pmw.getFbRandomEventId()\n\n\t\t\tfbq(\"trackCustom\", eventName, customData, {\n\t\t\t\teventID: eventId,\n\t\t\t})\n\n\t\t\tpmw.console.log(\"Facebook Pixel: Custom event sent\", eventName, customData)\n\n\t\t\tlet payload = {\n\t\t\t\tfacebook: {\n\t\t\t\t\tevent_name      : eventName,\n\t\t\t\t\tevent_id        : eventId,\n\t\t\t\t\tuser_data       : pmw.getFbUserData(),\n\t\t\t\t\tevent_source_url: window.location.href,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\t// if customData not empty, add it to the payload\n\t\t\tif (Object.keys(customData).length) {\n\t\t\t\tpayload.facebook.custom_data = customData\n\t\t\t}\n\n\t\t\tpmw.sendEventPayloadToServer(payload)\n\n\t\t} catch (e) {\n\t\t\tconsole.error(e)\n\t\t}\n\t}\n\n\tpmw.fbGetContentIdsFromCart = () => {\n\n\t\tlet content_ids = []\n\n\t\tfor (const key in pmwDataLayer.cart) {\n\t\t\tcontent_ids.push(pmwDataLayer.products[key].dyn_r_ids[pmwDataLayer.pixels.facebook.dynamic_remarketing.id_type])\n\t\t}\n\n\t\treturn content_ids\n\t}\n\n\t/**\n\t * Check if Facebook Pixel is allowed to fire\n\t *\n\t * @returns {boolean}\n\t */\n\tpmw.canFireFbq = () => {\n\n\t\t// If the Facebook Pixel is not loaded, return false\n\t\tif (!pmwDataLayer?.pixels?.facebook?.loaded) return false\n\n\t\t// If the user has not given consent for marketing, return false\n\t\tif (!pmw.consent.categories.get().marketing) return false\n\n\t\treturn true\n\t}\n\n\t/**\n\t * Check if Facebook Pixel is not allowed to fire\n\t *\n\t * @returns {boolean}\n\t */\n\tpmw.canNotFireFbq = () => {\n\t\treturn !pmw.canFireFbq()\n\t}\n\n}(window.pmw = window.pmw || {}, jQuery));\n","/**\n * Facebook Pixel Adapter\n *\n * Adapts standardized event data into Facebook Pixel format.\n * Handles both browser pixel (fbq) and CAPI (server-to-server) data structures.\n *\n * @since 1.51.0\n */\n\n(function (pmw, $, undefined) {\n\n\t/**\n\t * Facebook Pixel Data Adapter\n\t */\n\tconst FacebookAdapter = {\n\n\t\t/**\n\t\t * Main adapt method - routes to specific event adapters\n\t\t *\n\t\t * @param {object} eventData - Standardized event data\n\t\t * @param {string} eventName - Event name (add_to_cart, view_item, etc.)\n\t\t * @param {object} context - Event context (user, session, page data)\n\t\t * @returns {Promise<object|null>} Facebook-formatted data or null if pixel inactive\n\t\t */\n\t\tasync adapt(eventData, eventName, context) {\n\t\t\t// Check if Facebook pixel is configured (has pixel_id)\n\t\t\t// Don't check 'loaded' status - pixel might not be loaded yet when event fires\n\t\t\t// The event listener will check canNotFireFbq() before actually firing\n\t\t\tif (!pmwDataLayer?.pixels?.facebook?.pixel_id) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Map standardized event names to adapter methods\n\t\t\tconst eventMap = {\n\t\t\t\t\"page_view\"       : this.adaptPageView,\n\t\t\t\t\"add_to_cart\"     : this.adaptAddToCart,\n\t\t\t\t\"view_item\"       : this.adaptViewItem,\n\t\t\t\t\"begin_checkout\"  : this.adaptBeginCheckout,\n\t\t\t\t\"add_payment_info\": this.adaptAddPaymentInfo,\n\t\t\t\t\"add_to_wishlist\" : this.adaptAddToWishlist,\n\t\t\t\t\"search\"          : this.adaptSearch,\n\t\t\t\t\"purchase\"        : this.adaptPurchase,\n\t\t\t\t\"login\"           : this.adaptLogin,\n\t\t\t};\n\t\t\tconst adapter  = eventMap[eventName];\n\n\t\t\tif (!adapter) {\n\t\t\t\tpmw.console.log(`No Facebook adapter for event: ${eventName}`);\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\treturn await adapter.call(this, eventData, context);\n\t\t\t} catch (e) {\n\t\t\t\tpmw.console.error(`Facebook adapter error for ${eventName}:`, e);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get base event data structure\n\t\t * Common fields for all Facebook events\n\t\t * Waits for _fbp cookie on first pageview to ensure proper event matching\n\t\t */\n\t\tasync getBaseData(context) {\n\t\t\t// Wait for _fbp cookie (max 2 seconds) - important for first pageview\n\t\t\tawait pmw.waitForFbp();\n\n\t\t\tconst baseData = {\n\t\t\t\tevent_id        : pmw.getFbRandomEventId(),\n\t\t\t\tuser_data       : pmw.getFbUserData(),\n\t\t\t\tevent_source_url: context.url,\n\t\t\t};\n\n\t\t\t// Add referrer if available\n\t\t\tif (context.referrer) {\n\t\t\t\tbaseData.referrer_url = context.referrer;\n\t\t\t}\n\n\t\t\treturn baseData;\n\t\t},\n\n\t\t/**\n\t\t * Adapt PageView event\n\t\t */\n\t\tasync adaptPageView(eventData, context) {\n\t\t\treturn {\n\t\t\t\tevent_name: \"PageView\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: {},\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt AddToCart event\n\t\t */\n\t\tasync adaptAddToCart(eventData, context) {\n\t\t\tconst product = eventData.product;\n\n\t\t\treturn {\n\t\t\t\tevent_name: \"AddToCart\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: pmw.fbGetProductDataForCapiEvent(product),\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt ViewContent (view_item) event\n\t\t */\n\t\tasync adaptViewItem(eventData, context) {\n\t\t\tconst product = eventData.product;\n\n\t\t\tconst data = {\n\t\t\t\tevent_name: \"ViewContent\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: {},\n\t\t\t};\n\n\t\t\t// Add product data if product is provided\n\t\t\tif (product) {\n\t\t\t\tdata.custom_data = pmw.fbGetProductDataForCapiEvent(product);\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\t/**\n\t\t * Adapt InitiateCheckout (begin_checkout) event\n\t\t */\n\t\tasync adaptBeginCheckout(eventData, context) {\n\t\t\tconst data = {\n\t\t\t\tevent_name: \"InitiateCheckout\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: {},\n\t\t\t};\n\n\t\t\t// Add cart data if available\n\t\t\tif (pmwDataLayer?.cart && !jQuery.isEmptyObject(pmwDataLayer.cart)) {\n\t\t\t\tdata.custom_data = {\n\t\t\t\t\tcontent_type: \"product\",\n\t\t\t\t\tcontent_ids : pmw.fbGetContentIdsFromCart(),\n\t\t\t\t\tvalue       : pmw.getCartValue(),\n\t\t\t\t\tcurrency    : pmwDataLayer.shop.currency,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\t/**\n\t\t * Adapt AddPaymentInfo event\n\t\t */\n\t\tasync adaptAddPaymentInfo(eventData, context) {\n\t\t\treturn {\n\t\t\t\tevent_name: \"AddPaymentInfo\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: {},\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt AddToWishlist event\n\t\t */\n\t\tasync adaptAddToWishlist(eventData, context) {\n\t\t\tconst product = eventData.product;\n\n\t\t\treturn {\n\t\t\t\tevent_name: \"AddToWishlist\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: pmw.fbGetProductDataForCapiEvent(product),\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt Search event\n\t\t */\n\t\tasync adaptSearch(eventData, context) {\n\t\t\treturn {\n\t\t\t\tevent_name: \"Search\",\n\t\t\t\t...await this.getBaseData(context),\n\t\t\t\tcustom_data: {\n\t\t\t\t\tsearch_string: pmw.getSearchTermFromUrl(),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt Purchase event\n\t\t */\n\t\tasync adaptPurchase(eventData, context) {\n\t\t\tif (!pmwDataLayer?.order) {\n\t\t\t\tpmw.console.error(\"Order data not available for Facebook Purchase event\");\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst baseData    = await this.getBaseData(context);\n\t\t\t// Use order ID for purchase event to match server-side event ID\n\t\t\tbaseData.event_id = pmwDataLayer.order.id.toString();\n\n\t\t\treturn {\n\t\t\t\tevent_name: \"Purchase\",\n\t\t\t\t...baseData,\n\t\t\t\tcustom_data: {\n\t\t\t\t\tvalue       : pmwDataLayer.order.value.marketing,\n\t\t\t\t\tcurrency    : pmwDataLayer.order.currency,\n\t\t\t\t\tcontent_type: \"product\",\n\t\t\t\t\tcontent_ids : pmw.facebookContentIds(),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Adapt Login event\n\t\t *\n\t\t * Note: Facebook doesn't have a standard Login event in their predefined events.\n\t\t * Return null as this event is not typically tracked via Facebook CAPI.\n\t\t *\n\t\t * @param {object} eventData - Event data\n\t\t * @param {object} context - Event context\n\t\t * @returns {null} Facebook doesn't support login event\n\t\t */\n\t\tasync adaptLogin(eventData, context) {\n\t\t\t// Facebook doesn't have a standard Login event\n\t\t\treturn null;\n\t\t},\n\t};\n\n\t// Register the adapter with S2S capabilities and 'both' firing mode\n\t// 'both' mode: fires browser pixel (fbq) AND sends to CAPI, using event_id for deduplication\n\tpmw.registerAdapter(\"facebook\", FacebookAdapter, {\n\t\tmode                      : \"both\",\n\t\tsupportsS2S               : true,\n\t\tsupportsEventDeduplication: true,\n\t\tsupportsPageViewS2S       : true,\n\t\tisActive                  : () => pmwDataLayer?.pixels?.facebook?.loaded === true,\n\t});\n\n}(window.pmw = window.pmw || {}, jQuery));\n","/**\n * Facebook loader\n */\n\nrequire(\"./adapter\")\nrequire(\"./functions\")\nrequire(\"./event_listeners\")\n\n// #if process.env.TIER === 'premium'\n// if (pmw.canLoadPremiumFeatures()) {\n// \trequire(\"./functions_premium\")\n// \trequire(\"./event_listeners_premium\")\n// }\n// #endif\n\n"],"names":["jQuery","document","on","pmwDataLayer","pixels","facebook","pixel_id","loaded","pmw","doesUrlContainPatterns","exclusion_patterns","consent","canPixelBeFired","loadFacebookPixel","event","payload","canNotFireFbq","shouldFireBrowserPixel","facebookData","console","log","fbq","event_name","custom_data","eventID","event_id","error","setFbUserData","addEventListener","detail","consentUpdate","marketing","fbUserData","fbpPromise","fbeventsJsUrl","searchParams","URLSearchParams","window","location","search","has","get","fbevents_js_url","f","b","e","v","n","callMethod","apply","arguments","queue","push","_fbq","version","t","createElement","async","src","s","getElementsByTagName","parentNode","insertBefore","fbScript","querySelector","onload","onerror","data","isFbAdvancedMatchingEnabled","getUserIdentifiersForFb","mobile_bridge_app_id","user","id","raw","external_id","order","user_id","email","em","billing_email_hashed","first_name","fn","billing_first_name","toLowerCase","last_name","ln","billing_last_name","phone","ph","billing_phone","replace","city","ct","billing_city","state","st","billing_state","postcode","zp","billing_postcode","country","billing_country","getFbRandomEventId","Math","random","toString","substring","getFbUserData","getFbUserDataFromBrowser","advanced_matching","waitForFbp","maxWait","interval","existingFbp","getCookie","isValidFbp","Promise","resolve","elapsed","check","fbp","setTimeout","fbc","retrieveData","isValidFbc","navigator","userAgent","client_user_agent","clientIp","isValidIpAddress","client_ip_address","isFbpSet","RegExp","test","fbGetProductDataForCapiEvent","product","content_type","content_name","name","content_ids","dyn_r_ids","dynamic_remarketing","id_type","value","parseFloat","quantity","price","currency","facebookContentIds","prodIds","Object","values","items","forEach","item","shop","variations_output","variation_id","String","products","trackCustomFacebookEvent","eventName","customData","eventId","user_data","event_source_url","href","keys","length","sendEventPayloadToServer","fbGetContentIdsFromCart","key","cart","canFireFbq","categories","FacebookAdapter","adapt","eventData","context","adapter","this","adaptPageView","adaptAddToCart","adaptViewItem","adaptBeginCheckout","adaptAddPaymentInfo","adaptAddToWishlist","adaptSearch","adaptPurchase","adaptLogin","call","getBaseData","baseData","url","referrer","referrer_url","isEmptyObject","getCartValue","search_string","getSearchTermFromUrl","registerAdapter","mode","supportsS2S","supportsEventDeduplication","supportsPageViewS2S","isActive","require"],"ignoreList":[],"sourceRoot":""}