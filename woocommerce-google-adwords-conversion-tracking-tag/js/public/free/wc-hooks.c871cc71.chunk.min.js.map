{"version":3,"file":"wc-hooks.c871cc71.chunk.min.js","mappings":";uHA8BAA,GAAGC,MAAMC,UACR,iDACA,gCACAC,IAKCC,IAAIC,iBAAiBF,EAAKG,QAAQC,GAAI,KAOxCP,GAAGC,MAAMC,UACR,0DACA,gCACAC,IAGKA,EAAKK,SAAWL,EAAKG,QAAQE,UAChCJ,IAAIC,iBAAiBF,EAAKG,QAAQC,GAAIJ,EAAKK,SAAWL,EAAKG,QAAQE,UAGhEL,EAAKK,SAAWL,EAAKG,QAAQE,UAChCJ,IAAIK,sBAAsBN,EAAKG,QAAQC,GAAIJ,EAAKG,QAAQE,SAAWL,EAAKK,YAQ3ER,GAAGC,MAAMC,UACR,oDACA,gCACAC,IAECC,IAAIK,sBAAsBN,EAAKG,QAAQC,GAAIJ,EAAKK,YA+BlD,MAAME,EARN,SAAkBC,EAAMC,GACvB,IAAIC,EACJ,OAAO,YAAaC,GACnBC,aAAaF,GACbA,EAAUG,WAAW,IAAML,EAAKM,MAAMC,KAAMJ,GAAOF,EACpD,CACD,CAE6BO,CAAUhB,IAIjCA,EAAKiB,UAAUC,iBAFG,CAAC,aAAc,YAAa,YAAa,OAAQ,WAAY,WAE3BC,MAAMC,GAASpB,EAAKiB,UAAUC,gBAAgBE,KAGvGC,OAAOC,UAAUC,QAAQ,wBAAyBvB,IAChD,KAGHH,GAAGC,MAAMC,UACR,iEACA,gCACAC,IACCO,EAAqBP,KASvBH,GAAGC,MAAMC,UACR,sEACA,gCACAC,IAGC,IAAIwB,EAAU,CAACC,YAAa,CAACC,KAAM1B,EAAK2B,QAExCN,OAAOC,UAAUC,QAAQ,uBAAwBC,KAoBnD3B,GAAGC,MAAMC,UACR,mDACA,gCACA,KAECsB,OAAOC,UAAUC,QAAQ,kBAAmB,CAAC,I","sources":["webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/wc_hooks.js"],"sourcesContent":["/**\n * https://github.com/woocommerce/woocommerce-blocks/blob/trunk/src/BlockTypes/AbstractProductGrid.php#L108\n * https://github.com/woocommerce/woocommerce-blocks/issues/3483\n * https://github.com/woocommerce/woocommerce-blocks/issues/1714\n *\n * https://github.com/woocommerce/woocommerce-blocks/blob/trunk/docs/third-party-developers/extensibility/hooks/actions.md#woocommerce_add_to_cart\n *\n * https://github.com/woocommerce/woocommerce-blocks/blob/trunk/docs/internal-developers/blocks/feature-flags-and-experimental-interfaces.md\n * https://github.com/woocommerce/woocommerce-blocks/blob/trunk/docs/internal-developers/blocks/feature-flags-and-experimental-interfaces.md#usages-of-experimental-prefix\n *\n * experimental__woocommerce_blocks-product-list-render\n *\n * https://github.com/woocommerce/woocommerce-blocks/blob/a1a6eb2b574b7d39d19d67bafb747d38017289da/docs/internal-developers/blocks/feature-flags-and-experimental-interfaces.md/#usages-of-experimental-prefix\n */\n\n// TODO experimental__woocommerce_blocks-checkout-set-email-address\n// TODO experimental__woocommerce_blocks-product-view-link > selectItem\n// TODO maybe experimental__woocommerce_blocks-product-list-render, when product list is rendered send some list event\n// TODO maybe experimental__woocommerce_blocks-product-search, if the current event trigger doesn't work\n// TODO experimental__woocommerce_blocks-product-render > viewItem\n// TODO various events during entering checkout details, such as email, address, etc.\n// TODO find a way to keep view_item_list events working with the mutation observer\n\n// import {createHooks, addAction, doAction} from \"@wordpress/hooks\"\n// console.log(wp.hooks)\n// console.log(wp.hooks.applyFilters(\"ndx_change_string\", \"\"))\n\n/**\n * Add-to-cart button\n */\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-cart-add-item\",\n\t\"pixel-manager-for-woocommerce\",\n\tdata => {\n\t\t// console.log(\"experimental__woocommerce_blocks-cart-add-item\", data)\n\n\t\t// Works on the all product page\n\t\t// TODO make it work with variable quantities on product page\n\t\tpmw.addProductToCart(data.product.id, 1);\n\t},\n);\n\n/**\n * Change cart quantity\n */\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-cart-set-item-quantity\",\n\t\"pixel-manager-for-woocommerce\",\n\tdata => {\n\t\t// console.log(\"experimental__woocommerce_blocks-cart-set-item-quantity\", data)\n\n\t\tif (data.quantity > data.product.quantity) {\n\t\t\tpmw.addProductToCart(data.product.id, data.quantity - data.product.quantity);\n\t\t}\n\n\t\tif (data.quantity < data.product.quantity) {\n\t\t\tpmw.removeProductFromCart(data.product.id, data.product.quantity - data.quantity);\n\t\t}\n\t},\n);\n\n/**\n * Remove from cart\n */\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-cart-remove-item\",\n\t\"pixel-manager-for-woocommerce\",\n\tdata => {\n\t\t// console.log(\"experimental__woocommerce_blocks-cart-remove-item\", data)\n\t\tpmw.removeProductFromCart(data.product.id, data.quantity);\n\t},\n);\n\n/**\n * Start checkout\n */\n\n// wp.hooks.addAction(\n// \t\"experimental__woocommerce_blocks-checkout-render-checkout-form\",\n// \t\"pixel-manager-for-woocommerce\",\n// \tdata => {\n// \t\tconsole.log(\"experimental__woocommerce_blocks-checkout-render-checkout-form\", data)\n// \t\tjQuery(document).trigger(\"pmw:begin-checkout\")\n// \t},\n// )\n\n/**\n * Add shipping data\n *\n * @since 1.44.2\n */\n// Debounce function\nfunction debounce(func, wait) {\n\tlet timeout;\n\treturn function (...args) {\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(() => func.apply(this, args), wait);\n\t};\n}\n\nconst checkMandatoryFields = debounce((data) => {\n\n\tlet mandatory_fields = [\"first_name\", \"last_name\", \"address_1\", \"city\", \"postcode\", \"country\"];\n\n\tif (!data.storeCart.shippingAddress || !mandatory_fields.every(field => data.storeCart.shippingAddress[field])) return;\n\n\t// console.log(\"experimental__woocommerce_blocks-checkout-set-shipping-address\", data);\n\tjQuery(document).trigger(\"pmw:add-shipping-info\", data);\n}, 2000);\n\n// Example usage\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-checkout-set-shipping-address\",\n\t\"pixel-manager-for-woocommerce\",\n\tdata => {\n\t\tcheckMandatoryFields(data);\n\t},\n);\n\n/**\n * Add payment method\n *\n * @since 1.44.2\n */\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-checkout-set-active-payment-method\",\n\t\"pixel-manager-for-woocommerce\",\n\tdata => {\n\t\t// console.log(\"experimental__woocommerce_blocks-checkout-set-active-payment-method\", data);\n\n\t\tlet payload = {paymentType: {text: data.value}};\n\n\t\tjQuery(document).trigger(\"pmw:add-payment-info\", payload);\n\t},\n);\n\n\n// wp.hooks.addAction(\n// \t\"experimental__woocommerce_blocks-checkout-set-selected-shipping-rate\",\n// \t\"pixel-manager-for-woocommerce\",\n// \tdata => {\n// \t\tconsole.log(\"experimental__woocommerce_blocks-checkout-set-selected-shipping-rate\", data);\n//\n// \t\tlet payload = {shippingMethod: {text: data.value}};\n//\n// \t\tjQuery(document).trigger(\"pmw:add-shipping-info\", payload);\n// \t},\n// );\n\n/**\n * Checkout form submit\n */\nwp.hooks.addAction(\n\t\"experimental__woocommerce_blocks-checkout-submit\",\n\t\"pixel-manager-for-woocommerce\",\n\t() => {\n\t\t// console.log(\"experimental__woocommerce_blocks-checkout-submit\")\n\t\tjQuery(document).trigger(\"pmw:place-order\", {});\n\t},\n);\n\n\n/**\n * Only outputs an object with products. No other data or actions.\n */\n// wp.hooks.addAction(\n// \t\"experimental__woocommerce_blocks-product-list-render\",\n// \t\"pixel-manager-for-woocommerce\",\n// \t(value) => {\n//\n// \t\tif (value.products.length > 0) {\n// \t\t\tconsole.log(\"hello world 1\")\n// \t\t\tconsole.log(value)\n//\n// \t\t\tjQuery(\".add_to_cart_button\").on(\"click\", function (event) {\n//\n// \t\t\t\tconsole.log(jQuery(event.target.parentElement.parentElement))\n//\n// \t\t\t\t// console.log(\"hello world 5\");\n// \t\t\t\t//\n// \t\t\t\t// console.log(jQuery(this.parentElement.parentElement));\n// \t\t\t\t//\n// \t\t\t\t// console.log(\"hello world 6\");\n// \t\t\t\t//\n// \t\t\t\t// // element is part of a React component.\n// \t\t\t\t// // Get the parent element.\n// \t\t\t\t// const pe = event.target.parentElement.parentElement\n// \t\t\t\t// console.log(jQuery(pe)._reactInternalFiber.key)\n// \t\t\t\t//\n// \t\t\t\t// // pe is a react component. Get the key of that component.\n// \t\t\t\t// const key = pe.getAttribute(\"data-key\")\n// \t\t\t\t// console.log(key)\n//\n//\n// \t\t\t\t// console.log(element.currentTarget.dataset.key)\n// \t\t\t})\n// \t\t}\n// \t\treturn value\n// \t},\n// )\n\n// jQuery(document).on(\"pmw:ready\", () => {\n// \tjQuery(\".add_to_cart_button\").on(\"click\", function (element) {\n//\n// \t\tconsole.log(\"hello world 3\")\n// \t\t// element is part of a React component.\n// \t\t// Get the key of that component.\n// \t\tconsole.log(element.currentTarget.dataset.key)\n// \t})\n// })\n\n// wp.hooks.addAction(\n// \t'woocommerce_add_to_cart',\n// \t'pixel-manager-for-woocommerce',\n// \t( cart_item_key, product_id, quantity, variation_id, variation, cart_item_data ) => {\n// \t\tconsole.log( cart_item_key, product_id, quantity, variation_id, variation, cart_item_data );\n// \t},\n// \t()=>{\n// \t\tconsole.log(\"hello world 2\")\n// \t}\n// )\n\n/**\n * Product Search\n *\n * TODO: Make sure that it doesn't duplicate the event\n */\n// wp.hooks.addAction(\n// \t\"experimental__woocommerce_blocks-product-search\",\n// \t\"pixel-manager-for-woocommerce\",\n// \tdata => {\n// \t\t// console.log(\"experimental__woocommerce_blocks-product-search\", data)\n// \t\tjQuery(document).trigger(\"pmw:search\", data.searchTerm)\n// \t},\n// )\n"],"names":["wp","hooks","addAction","data","pmw","addProductToCart","product","id","quantity","removeProductFromCart","checkMandatoryFields","func","wait","timeout","args","clearTimeout","setTimeout","apply","this","debounce","storeCart","shippingAddress","every","field","jQuery","document","trigger","payload","paymentType","text","value"],"ignoreList":[],"sourceRoot":""}