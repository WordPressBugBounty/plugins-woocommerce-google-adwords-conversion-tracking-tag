{"version":3,"file":"consent-api.c33d5439.chunk.min.js","mappings":";6RAWO,MAAMA,EAAY,EAAEC,WAAW,MAAQ,CAAC,KAE9C,MAAMC,EAAO,CACZC,YAAa,EACbC,WAAa,EACbC,aAAa,EACbC,WAAa,EACbL,SAAaA,GAGdM,EAAUL,GACVM,IACAC,SAASC,cAAc,IAAIC,YAAY,qBAAsB,CAACC,OAAQV,MAU1DW,EAAY,EAAEZ,WAAW,MAAQ,CAAC,KAE9C,MAAMC,EAAO,CACZC,YAAa,EACbC,WAAa,EACbC,aAAa,EACbC,WAAa,EACbL,SAAaA,GAGdM,EAAUL,GACVO,SAASC,cAAc,IAAIC,YAAY,qBAAsB,CAACC,OAAQV,MAc1DY,EAAoB,EACtBX,aAAaY,IAAIC,QAAQC,WAAWC,MAAMf,WAC1CC,YAAYW,IAAIC,QAAQC,WAAWC,MAAMd,UACzCC,cAAcU,IAAIC,QAAQC,WAAWC,MAAMb,YAC3CC,YAAYS,IAAIC,QAAQC,WAAWC,MAAMZ,UACzCL,WAAW,cAGFkB,IAAfhB,QAA0CgB,IAAdf,QAA2Ce,IAAhBd,QAA2Cc,IAAdb,GACvFc,QAAQC,IAAI,wHAGb,IAAInB,EAAO,CACVC,aACAC,YACAC,cACAC,YACAL,YAGDM,EAAUL,GACVM,IACAC,SAASC,cAAc,IAAIC,YAAY,qBAAsB,CAACC,OAAQV,MAkCjEM,EAAqB,KAC1BC,SAASC,cAAc,IAAIY,MAAM,qBAU5Bf,EAAaL,IAClBa,IAAIC,QAAQC,WAAWM,IAAIrB,GA3BH,GAAEC,aAAYC,YAAWC,cAAaC,YAAWL,WAAW,SAEpF,MACMC,EAAO,CAACC,aAAYC,YAAWC,cAAaC,aAIjC,OAAbL,EAKJc,IAAIS,UAAU,qBAAsBC,KAAKC,UAAUxB,GAAOD,GAJzDc,IAAIY,UANQ,qBAMOzB,GAAM,IAoB1B0B,CAAiB1B,GACjBa,IAAIK,QAAQC,IAAI,wBAAyBnB,IAU7B2B,EAAgDC,IAE5D,GAAsB,YAAlBA,EAAW,GAAkB,OACjC,GAAsB,WAAlBA,EAAW,GAAiB,OAChC,GAA8B,QAA1BA,EAAW,IAAIC,OAAkB,OAErChB,IAAIK,QAAQC,IAAI,kCAAmCS,GAEnD,IAAIE,EAAejB,IAAIC,QAAQC,WAAWC,MAEtChB,EAAO,CACVC,gBAAiDgB,IAApCW,EAAW,GAAGG,kBAAsE,YAApCH,EAAW,GAAGG,kBAAkCD,EAAa7B,WAC1HC,eAA0Ce,IAA7BW,EAAW,GAAGI,WAAwD,YAA7BJ,EAAW,GAAGI,WAA2BF,EAAa5B,UAC5GC,kBAAsDc,IAAxCW,EAAW,GAAGK,sBAA8E,YAAxCL,EAAW,GAAGK,sBAAsCH,EAAa3B,oBACvFc,IAA1CW,EAAW,GAAGM,wBAAkF,YAA1CN,EAAW,GAAGM,wBAAwCJ,EAAa3B,aAC3HC,eAAgDa,IAAnCW,EAAW,GAAGO,iBAAoE,YAAnCP,EAAW,GAAGO,iBAAiCL,EAAa1B,WAGzHC,EAAUL,GACVM,KAGY8B,EAAsBC,GAC3BxB,IAAIC,QAAQC,WAAWC,MAAMqB,E","sources":["webpack://Pixel-Manager-for-WooCommerce/./src/js-src/public/pmw/consent/api.mjs"],"sourcesContent":["/**\n * Pixel Manager Cookie Consent API\n **/\n\n/**\n * Accept consent for all cookies\n *\n * @param duration {number|null}\n * @returns {void}\n * @public\n */\nexport const acceptAll = ({duration = null} = {}) => {\n\n\tconst data = {\n\t\tstatistics : true,\n\t\tmarketing  : true,\n\t\tpreferences: true,\n\t\tnecessary  : true,\n\t\tduration   : duration,\n\t};\n\n\tsaveState(data);\n\tloadApprovedPixels();\n\tdocument.dispatchEvent(new CustomEvent(\"pmw:consent:update\", {detail: data}));\n};\n\n/**\n * Revoke consent for all cookies\n *\n * @param duration {number|null}\n * @returns {void}\n * @public\n */\nexport const revokeAll = ({duration = null} = {}) => {\n\n\tconst data = {\n\t\tstatistics : false,\n\t\tmarketing  : false,\n\t\tpreferences: false,\n\t\tnecessary  : true,\n\t\tduration   : duration,\n\t};\n\n\tsaveState(data);\n\tdocument.dispatchEvent(new CustomEvent(\"pmw:consent:update\", {detail: data}));\n};\n\n/**\n * Accept consent selectively\n *\n * @param statistics\n * @param marketing\n * @param preferences\n * @param necessary\n * @param duration\n * @returns {void}\n * @public\n */\nexport const updateSelectively = ({\n\t\t\t\t\t\t\t\t\t  statistics = pmw.consent.categories.get().statistics,\n\t\t\t\t\t\t\t\t\t  marketing = pmw.consent.categories.get().marketing,\n\t\t\t\t\t\t\t\t\t  preferences = pmw.consent.categories.get().preferences,\n\t\t\t\t\t\t\t\t\t  necessary = pmw.consent.categories.get().necessary,\n\t\t\t\t\t\t\t\t\t  duration = null,\n\t\t\t\t\t\t\t\t  }) => {\n\n\tif (statistics === undefined || marketing === undefined || preferences === undefined || necessary === undefined) {\n\t\tconsole.log(\"pmw.consent.api.updateSelectively: It is recommended to pass all consent types. - statistics, marketing, preferences\");\n\t}\n\n\tlet data = {\n\t\tstatistics,\n\t\tmarketing,\n\t\tpreferences,\n\t\tnecessary,\n\t\tduration,\n\t};\n\n\tsaveState(data);\n\tloadApprovedPixels();\n\tdocument.dispatchEvent(new CustomEvent(\"pmw:consent:update\", {detail: data}));\n};\n\n/**\n * Set a cookie called pmw_cookie_consent with the value of pmw_cookie_consent\n * and set the default expiration date to 1 year from now.\n *\n * @param statistics {boolean}\n * @param marketing {boolean}\n * @param preferences {boolean}\n * @param necessary {boolean}\n * @param duration {number|null}\n *\n * @returns {void}\n * @private\n *\n * TODO: Use the data store\n * TODO: Cleanup\n */\nconst setConsentCookie = ({statistics, marketing, preferences, necessary, duration = null}) => {\n\n\tconst key  = \"pmw_cookie_consent\";\n\tconst data = {statistics, marketing, preferences, necessary};\n\n\t// If no duration is set, use the wpm storage,\n\t// otherwise use pmw.setCookie()\n\tif (duration === null) {\n\t\tpmw.storeData(key, data, true);\n\t\treturn;\n\t}\n\n\tpmw.setCookie(\"pmw_cookie_consent\", JSON.stringify(data), duration);\n};\n\nconst loadApprovedPixels = () => {\n\tdocument.dispatchEvent(new Event(\"pmw:load-pixels\"));\n};\n\n/**\n * Save the consent in the settings and set the cookie\n *\n * @param data\n * @returns {void}\n * @private\n */\nconst saveState = (data) => {\n\tpmw.consent.categories.set(data);\n\tsetConsentCookie(data);\n\tpmw.console.log(\"Updated consent state\", data);\n};\n\n/**\n * Process the consent update from the external source\n *\n * @param attributes\n * @returns {void}\n * @public\n */\nexport const processExternalGcmConsentUpdate_experimental = (attributes) => {\n\n\tif (attributes[0] !== \"consent\") return;\n\tif (attributes[1] !== \"update\") return;\n\tif (attributes[2]?.source === \"pmw\") return;\n\n\tpmw.console.log(\"processExternalGcmConsentUpdate\", attributes);\n\n\tlet previousData = pmw.consent.categories.get();\n\n\tlet data = {\n\t\tstatistics : attributes[2].analytics_storage !== undefined ? attributes[2].analytics_storage === \"granted\" : previousData.statistics,\n\t\tmarketing  : attributes[2].ad_storage !== undefined ? attributes[2].ad_storage === \"granted\" : previousData.marketing,\n\t\tpreferences: (attributes[2].functionality_storage !== undefined ? attributes[2].functionality_storage === \"granted\" : previousData.preferences) ||\n\t\t\t(attributes[2].personalization_storage !== undefined ? attributes[2].personalization_storage === \"granted\" : previousData.preferences),\n\t\tnecessary  : attributes[2].security_storage !== undefined ? attributes[2].security_storage === \"granted\" : previousData.necessary,\n\t};\n\n\tsaveState(data);\n\tloadApprovedPixels();\n};\n\nexport const getConsentStateFor = (category) => {\n\treturn pmw.consent.categories.get()[category];\n};\n\n"],"names":["acceptAll","duration","data","statistics","marketing","preferences","necessary","saveState","loadApprovedPixels","document","dispatchEvent","CustomEvent","detail","revokeAll","updateSelectively","pmw","consent","categories","get","undefined","console","log","Event","set","setCookie","JSON","stringify","storeData","setConsentCookie","processExternalGcmConsentUpdate_experimental","attributes","source","previousData","analytics_storage","ad_storage","functionality_storage","personalization_storage","security_storage","getConsentStateFor","category"],"ignoreList":[],"sourceRoot":""}